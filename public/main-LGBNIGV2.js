var u0=Object.defineProperty,l0=Object.defineProperties;var d0=Object.getOwnPropertyDescriptors;var Pv=Object.getOwnPropertySymbols,h0=Object.getPrototypeOf,f0=Object.prototype.hasOwnProperty,p0=Object.prototype.propertyIsEnumerable,g0=Reflect.get;var Mv=(t,e,n)=>e in t?u0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,F=(t,e)=>{for(var n in e||={})f0.call(e,n)&&Mv(t,n,e[n]);if(Pv)for(var n of Pv(e))p0.call(e,n)&&Mv(t,n,e[n]);return t},Ae=(t,e)=>l0(t,d0(e));var Wn=(t,e,n)=>g0(h0(t),n,e);var T=(t,e,n)=>new Promise((r,i)=>{var s=u=>{try{a(n.next(u))}catch(l){i(l)}},o=u=>{try{a(n.throw(u))}catch(l){i(l)}},a=u=>u.done?r(u.value):Promise.resolve(u.value).then(s,o);a((n=n.apply(t,e)).next())});var kv=null;var Bd=1,Ov=Symbol("SIGNAL");function ge(t){let e=kv;return kv=t,e}var Fv={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function m0(t){if(!(qd(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Bd)){if(!t.producerMustRecompute(t)&&!$d(t)){t.dirty=!1,t.lastCleanEpoch=Bd;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Bd}}function Lv(t){return t&&(t.nextProducerIndex=0),ge(t)}function Vv(t,e){if(ge(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(qd(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Hd(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function $d(t){mc(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(m0(n),r!==n.version))return!0}return!1}function Uv(t){if(mc(t),qd(t))for(let e=0;e<t.producerNode.length;e++)Hd(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Hd(t,e){if(y0(t),mc(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Hd(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];mc(i),i.producerIndexOfThis[r]=e}}function qd(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function mc(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function y0(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function _0(){throw new Error}var v0=_0;function jv(t){v0=t}function H(t){return typeof t=="function"}function Di(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var yc=Di(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function br(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Re=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(H(r))try{r()}catch(s){e=s instanceof yc?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Bv(s)}catch(o){e=e??[],o instanceof yc?e=[...e,...o.errors]:e.push(o)}}if(e)throw new yc(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Bv(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&br(n,e)}remove(e){let{_finalizers:n}=this;n&&br(n,e),e instanceof t&&e._removeParent(this)}};Re.EMPTY=(()=>{let t=new Re;return t.closed=!0,t})();var zd=Re.EMPTY;function _c(t){return t instanceof Re||t&&"closed"in t&&H(t.remove)&&H(t.add)&&H(t.unsubscribe)}function Bv(t){H(t)?t():t.unsubscribe()}var Vt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var bi={setTimeout(t,e,...n){let{delegate:r}=bi;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=bi;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function vc(t){bi.setTimeout(()=>{let{onUnhandledError:e}=Vt;if(e)e(t);else throw t})}function ho(){}var $v=Wd("C",void 0,void 0);function Hv(t){return Wd("E",void 0,t)}function qv(t){return Wd("N",t,void 0)}function Wd(t,e,n){return{kind:t,value:e,error:n}}var Sr=null;function Si(t){if(Vt.useDeprecatedSynchronousErrorHandling){let e=!Sr;if(e&&(Sr={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Sr;if(Sr=null,n)throw r}}else t()}function zv(t){Vt.useDeprecatedSynchronousErrorHandling&&Sr&&(Sr.errorThrown=!0,Sr.error=t)}var Ar=class extends Re{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,_c(e)&&e.add(this)):this.destination=E0}static create(e,n,r){return new Ai(e,n,r)}next(e){this.isStopped?Kd(qv(e),this):this._next(e)}error(e){this.isStopped?Kd(Hv(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Kd($v,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},w0=Function.prototype.bind;function Gd(t,e){return w0.call(t,e)}var Qd=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){wc(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){wc(r)}else wc(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){wc(n)}}},Ai=class extends Ar{constructor(e,n,r){super();let i;if(H(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Vt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Gd(e.next,s),error:e.error&&Gd(e.error,s),complete:e.complete&&Gd(e.complete,s)}):i=e}this.destination=new Qd(i)}};function wc(t){Vt.useDeprecatedSynchronousErrorHandling?zv(t):vc(t)}function I0(t){throw t}function Kd(t,e){let{onStoppedNotification:n}=Vt;n&&bi.setTimeout(()=>n(t,e))}var E0={closed:!0,next:ho,error:I0,complete:ho};var Ri=typeof Symbol=="function"&&Symbol.observable||"@@observable";function mt(t){return t}function Yd(...t){return Jd(t)}function Jd(t){return t.length===0?mt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var le=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=C0(n)?n:new Ai(n,r,i);return Si(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=Wv(r),new r((i,s)=>{let o=new Ai({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Ri](){return this}pipe(...n){return Jd(n)(this)}toPromise(n){return n=Wv(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function Wv(t){var e;return(e=t??Vt.Promise)!==null&&e!==void 0?e:Promise}function T0(t){return t&&H(t.next)&&H(t.error)&&H(t.complete)}function C0(t){return t&&t instanceof Ar||T0(t)&&_c(t)}function Xd(t){return H(t?.lift)}function ne(t){return e=>{if(Xd(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function re(t,e,n,r,i){return new Zd(t,e,n,r,i)}var Zd=class extends Ar{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ni(){return ne((t,e)=>{let n=null;t._refCount++;let r=re(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var xi=class extends le{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Xd(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Re;let n=this.getSubject();e.add(this.source.subscribe(re(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Re.EMPTY)}return e}refCount(){return Ni()(this)}};var Gv=Di(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var lt=(()=>{class t extends le{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Ic(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Gv}next(n){Si(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Si(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Si(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?zd:(this.currentObservers=null,s.push(n),new Re(()=>{this.currentObservers=null,br(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new le;return n.source=this,n}}return t.create=(e,n)=>new Ic(e,n),t})(),Ic=class extends lt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:zd}};var Ke=class extends lt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var eh={now(){return(eh.delegate||Date).now()},delegate:void 0};var Ec=class extends Re{constructor(e,n){super()}schedule(e,n=0){return this}};var fo={setInterval(t,e,...n){let{delegate:r}=fo;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=fo;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Pi=class extends Ec{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return fo.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&fo.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,br(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Mi=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Mi.now=eh.now;var ki=class extends Mi{constructor(e,n=Mi.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var th=new ki(Pi);var Tc=class extends Pi{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var Cc=class extends ki{};var nh=new Cc(Tc);var yt=new le(t=>t.complete());function Kv(t){return t&&H(t.schedule)}function Qv(t){return t[t.length-1]}function Yv(t){return H(Qv(t))?t.pop():void 0}function Gn(t){return Kv(Qv(t))?t.pop():void 0}function rh(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Xv(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(f){try{l(r.next(f))}catch(p){o(p)}}function u(f){try{l(r.throw(f))}catch(p){o(p)}}function l(f){f.done?s(f.value):i(f.value).then(a,u)}l((r=r.apply(t,e||[])).next())})}function Jv(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rr(t){return this instanceof Rr?(this.v=t,this):new Rr(t)}function Zv(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(m){r[m]&&(i[m]=function(D){return new Promise(function(A,R){s.push([m,D,A,R])>1||a(m,D)})})}function a(m,D){try{u(r[m](D))}catch(A){p(s[0][3],A)}}function u(m){m.value instanceof Rr?Promise.resolve(m.value.v).then(l,f):p(s[0][2],m)}function l(m){a("next",m)}function f(m){a("throw",m)}function p(m,D){m(D),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ew(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Jv=="function"?Jv(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,u){o=t[s](o),i(a,u,o.done,o.value)})}}function i(s,o,a,u){Promise.resolve(u).then(function(l){s({value:l,done:a})},o)}}var Dc=t=>t&&typeof t.length=="number"&&typeof t!="function";function bc(t){return H(t?.then)}function Sc(t){return H(t[Ri])}function Ac(t){return Symbol.asyncIterator&&H(t?.[Symbol.asyncIterator])}function Rc(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function D0(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Nc=D0();function xc(t){return H(t?.[Nc])}function Pc(t){return Zv(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Rr(n.read());if(i)return yield Rr(void 0);yield yield Rr(r)}}finally{n.releaseLock()}})}function Mc(t){return H(t?.getReader)}function je(t){if(t instanceof le)return t;if(t!=null){if(Sc(t))return b0(t);if(Dc(t))return S0(t);if(bc(t))return A0(t);if(Ac(t))return tw(t);if(xc(t))return R0(t);if(Mc(t))return N0(t)}throw Rc(t)}function b0(t){return new le(e=>{let n=t[Ri]();if(H(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function S0(t){return new le(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function A0(t){return new le(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,vc)})}function R0(t){return new le(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function tw(t){return new le(e=>{x0(t,e).catch(n=>e.error(n))})}function N0(t){return tw(Pc(t))}function x0(t,e){var n,r,i,s;return Xv(this,void 0,void 0,function*(){try{for(n=ew(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function ht(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Kn(t,e=0){return ne((n,r)=>{n.subscribe(re(r,i=>ht(r,t,()=>r.next(i),e),()=>ht(r,t,()=>r.complete(),e),i=>ht(r,t,()=>r.error(i),e)))})}function Qn(t,e=0){return ne((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function nw(t,e){return je(t).pipe(Qn(e),Kn(e))}function rw(t,e){return je(t).pipe(Qn(e),Kn(e))}function iw(t,e){return new le(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function sw(t,e){return new le(n=>{let r;return ht(n,e,()=>{r=t[Nc](),ht(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>H(r?.return)&&r.return()})}function kc(t,e){if(!t)throw new Error("Iterable cannot be null");return new le(n=>{ht(n,e,()=>{let r=t[Symbol.asyncIterator]();ht(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function ow(t,e){return kc(Pc(t),e)}function aw(t,e){if(t!=null){if(Sc(t))return nw(t,e);if(Dc(t))return iw(t,e);if(bc(t))return rw(t,e);if(Ac(t))return kc(t,e);if(xc(t))return sw(t,e);if(Mc(t))return ow(t,e)}throw Rc(t)}function ke(t,e){return e?aw(t,e):je(t)}function W(...t){let e=Gn(t);return ke(t,e)}function Oi(t,e){let n=H(t)?t:()=>t,r=i=>i.error(n());return new le(e?i=>e.schedule(r,0,i):r)}function ih(t){return!!t&&(t instanceof le||H(t.lift)&&H(t.subscribe))}var En=Di(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function ie(t,e){return ne((n,r)=>{let i=0;n.subscribe(re(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:P0}=Array;function M0(t,e){return P0(e)?t(...e):t(e)}function cw(t){return ie(e=>M0(t,e))}var{isArray:k0}=Array,{getPrototypeOf:O0,prototype:F0,keys:L0}=Object;function uw(t){if(t.length===1){let e=t[0];if(k0(e))return{args:e,keys:null};if(V0(e)){let n=L0(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function V0(t){return t&&typeof t=="object"&&O0(t)===F0}function lw(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Oc(...t){let e=Gn(t),n=Yv(t),{args:r,keys:i}=uw(t);if(r.length===0)return ke([],e);let s=new le(U0(r,e,i?o=>lw(i,o):mt));return n?s.pipe(cw(n)):s}function U0(t,e,n=mt){return r=>{dw(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)dw(e,()=>{let l=ke(t[u],e),f=!1;l.subscribe(re(r,p=>{s[u]=p,f||(f=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function dw(t,e,n){t?ht(n,t,e):e()}function hw(t,e,n,r,i,s,o,a){let u=[],l=0,f=0,p=!1,m=()=>{p&&!u.length&&!l&&e.complete()},D=R=>l<r?A(R):u.push(R),A=R=>{s&&e.next(R),l++;let x=!1;je(n(R,f++)).subscribe(re(e,V=>{i?.(V),s?D(V):e.next(V)},()=>{x=!0},void 0,()=>{if(x)try{for(l--;u.length&&l<r;){let V=u.shift();o?ht(e,o,()=>A(V)):A(V)}m()}catch(V){e.error(V)}}))};return t.subscribe(re(e,D,()=>{p=!0,m()})),()=>{a?.()}}function Oe(t,e,n=1/0){return H(e)?Oe((r,i)=>ie((s,o)=>e(r,s,i,o))(je(t(r,i))),n):(typeof e=="number"&&(n=e),ne((r,i)=>hw(r,i,t,n)))}function sh(t=1/0){return Oe(mt,t)}function fw(){return sh(1)}function Fi(...t){return fw()(ke(t,Gn(t)))}function Fc(t){return new le(e=>{je(t()).subscribe(e)})}function Ut(t,e){return ne((n,r)=>{let i=0;n.subscribe(re(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Yn(t){return ne((e,n)=>{let r=null,i=!1,s;r=e.subscribe(re(n,void 0,void 0,o=>{s=je(t(o,Yn(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function pw(t,e,n,r,i){return(s,o)=>{let a=n,u=e,l=0;s.subscribe(re(o,f=>{let p=l++;u=a?t(u,f,p):(a=!0,f),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function Li(t,e){return H(e)?Oe(t,e,1):Oe(t,1)}function Jn(t){return ne((e,n)=>{let r=!1;e.subscribe(re(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Tn(t){return t<=0?()=>yt:ne((e,n)=>{let r=0;e.subscribe(re(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function oh(t){return ie(()=>t)}function Lc(t=j0){return ne((e,n)=>{let r=!1;e.subscribe(re(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function j0(){return new En}function po(t){return ne((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Yt(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Ut((i,s)=>t(i,s,r)):mt,Tn(1),n?Jn(e):Lc(()=>new En))}function Vi(t){return t<=0?()=>yt:ne((e,n)=>{let r=[];e.subscribe(re(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function ah(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Ut((i,s)=>t(i,s,r)):mt,Vi(1),n?Jn(e):Lc(()=>new En))}function ch(t,e){return ne(pw(t,e,arguments.length>=2,!0))}function uh(...t){let e=Gn(t);return ne((n,r)=>{(e?Fi(t,n,e):Fi(t,n)).subscribe(r)})}function jt(t,e){return ne((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(re(r,u=>{i?.unsubscribe();let l=0,f=s++;je(t(u,f)).subscribe(i=re(r,p=>r.next(e?e(u,p,f,l++):p),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function lh(t){return ne((e,n)=>{je(t).subscribe(re(n,()=>n.complete(),ho)),!n.closed&&e.subscribe(n)})}function Fe(t,e,n){let r=H(t)||e||n?{next:t,error:e,complete:n}:t;return r?ne((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(re(s,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),s.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):mt}var $=class extends Error{constructor(e,n){super(Zh(e,n)),this.code=e}};function Zh(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function su(t){return{toString:t}.toString()}var Vc="__parameters__";function B0(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function $0(t,e,n){return su(()=>{let r=B0(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,l,f){let p=u.hasOwnProperty(Vc)?u[Vc]:Object.defineProperty(u,Vc,{value:[]})[Vc];for(;p.length<=f;)p.push(null);return(p[f]=p[f]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var go=globalThis;function ve(t){for(let e in t)if(t[e]===ve)return e;throw Error("Could not find renamed property on target object.")}function _t(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(_t).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function gw(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var H0=ve({__forward_ref__:ve});function Qw(t){return t.__forward_ref__=Qw,t.toString=function(){return _t(this())},t}function St(t){return Yw(t)?t():t}function Yw(t){return typeof t=="function"&&t.hasOwnProperty(H0)&&t.__forward_ref__===Qw}function z(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ou(t){return mw(t,Xw)||mw(t,Zw)}function Jw(t){return ou(t)!==null}function mw(t,e){return t.hasOwnProperty(e)?t[e]:null}function q0(t){let e=t&&(t[Xw]||t[Zw]);return e||null}function yw(t){return t&&(t.hasOwnProperty(_w)||t.hasOwnProperty(z0))?t[_w]:null}var Xw=ve({\u0275prov:ve}),_w=ve({\u0275inj:ve}),Zw=ve({ngInjectableDef:ve}),z0=ve({ngInjectorDef:ve}),G=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=z({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function eI(t){return t&&!!t.\u0275providers}var W0=ve({\u0275cmp:ve}),G0=ve({\u0275dir:ve}),K0=ve({\u0275pipe:ve}),Q0=ve({\u0275mod:ve}),qc=ve({\u0275fac:ve}),mo=ve({__NG_ELEMENT_ID__:ve}),vw=ve({__NG_ENV_ID__:ve});function Y0(t){return typeof t=="string"?t:t==null?"":String(t)}function J0(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Y0(t)}function X0(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new $(-200,t)}function ef(t,e){throw new $(-201,!1)}var Y=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(Y||{}),Ih;function tI(){return Ih}function bt(t){let e=Ih;return Ih=t,e}function nI(t,e,n){let r=ou(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&Y.Optional)return null;if(e!==void 0)return e;ef(t,"Injector")}var Z0={},yo=Z0,Eh="__NG_DI_FLAG__",zc="ngTempTokenPath",eR="ngTokenPath",tR=/\n/gm,nR="\u0275",ww="__source",$i;function rR(){return $i}function Xn(t){let e=$i;return $i=t,e}function iR(t,e=Y.Default){if($i===void 0)throw new $(-203,!1);return $i===null?nI(t,void 0,e):$i.get(t,e&Y.Optional?null:void 0,e)}function Z(t,e=Y.Default){return(tI()||iR)(St(t),e)}function O(t,e=Y.Default){return Z(t,au(e))}function au(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Th(t){let e=[];for(let n=0;n<t.length;n++){let r=St(t[n]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=Y.Default;for(let o=0;o<r.length;o++){let a=r[o],u=oR(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(Z(i,s))}else e.push(Z(r))}return e}function sR(t,e){return t[Eh]=e,t.prototype[Eh]=e,t}function oR(t){return t[Eh]}function aR(t,e,n,r){let i=t[zc];throw e[ww]&&i.unshift(e[ww]),t.message=cR(`
`+t.message,i,n,r),t[eR]=i,t[zc]=null,t}function cR(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==nR?t.slice(2):t;let i=_t(e);if(Array.isArray(e))i=e.map(_t).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):_t(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(tR,`
  `)}`}var Le=sR($0("Optional"),8);function zi(t,e){let n=t.hasOwnProperty(qc);return n?t[qc]:null}function tf(t,e){t.forEach(n=>Array.isArray(n)?tf(n,e):e(n))}function rI(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Wc(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}var _o={},Wi=[],Gi=new G(""),iI=new G("",-1),sI=new G(""),Gc=class{get(e,n=yo){if(n===yo){let r=new Error(`NullInjectorError: No provider for ${_t(e)}!`);throw r.name="NullInjectorError",r}return n}},oI=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(oI||{}),Zt=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Zt||{}),er=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(er||{});function uR(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Ch(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];dR(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function lR(t){return t===3||t===4||t===6}function dR(t){return t.charCodeAt(0)===64}function nf(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?Iw(t,n,i,null,e[++r]):Iw(t,n,i,null,null))}}return t}function Iw(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var aI="ng-template";function hR(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&uR(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(rf(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function rf(t){return t.type===4&&t.value!==aI}function fR(t,e,n){let r=t.type===4&&!n?aI:t.value;return e===r}function pR(t,e,n){let r=4,i=t.attrs,s=i!==null?yR(i):0,o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!Bt(r)&&!Bt(u))return!1;if(o&&Bt(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!fR(t,u,n)||u===""&&e.length===1){if(Bt(r))return!1;o=!0}}else if(r&8){if(i===null||!hR(t,i,u,n)){if(Bt(r))return!1;o=!0}}else{let l=e[++a],f=gR(u,i,rf(t),n);if(f===-1){if(Bt(r))return!1;o=!0;continue}if(l!==""){let p;if(f>s?p="":p=i[f+1].toLowerCase(),r&2&&l!==p){if(Bt(r))return!1;o=!0}}}}return Bt(r)||o}function Bt(t){return(t&1)===0}function gR(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return _R(e,t)}function mR(t,e,n=!1){for(let r=0;r<e.length;r++)if(pR(t,e[r],n))return!0;return!1}function yR(t){for(let e=0;e<t.length;e++){let n=t[e];if(lR(n))return e}return t.length}function _R(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function Ew(t,e){return t?":not("+e.trim()+")":e}function vR(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Bt(o)&&(e+=Ew(s,i),i=""),r=o,s=s||!Bt(r);n++}return i!==""&&(e+=Ew(s,i)),e}function wR(t){return t.map(vR).join(",")}function IR(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Bt(i))break;i=s}r++}return{attrs:e,classes:n}}function cu(t){return su(()=>{let e=hI(t),n=Ae(F({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===oI.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Zt.Emulated,styles:t.styles||Wi,_:null,schemas:t.schemas||null,tView:null,id:""});fI(n);let r=t.dependencies;return n.directiveDefs=Cw(r,!1),n.pipeDefs=Cw(r,!0),n.id=CR(n),n})}function ER(t){return xr(t)||cI(t)}function TR(t){return t!==null}function Tw(t,e){if(t==null)return _o;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=er.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==er.None?[r,a]:r,e[s]=o):n[s]=r}return n}function sf(t){return su(()=>{let e=hI(t);return fI(e),e})}function xr(t){return t[W0]||null}function cI(t){return t[G0]||null}function uI(t){return t[K0]||null}function lI(t){let e=xr(t)||cI(t)||uI(t);return e!==null?e.standalone:!1}function dI(t,e){let n=t[Q0]||null;if(!n&&e===!0)throw new Error(`Type ${_t(t)} does not have '\u0275mod' property.`);return n}function hI(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||_o,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Wi,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Tw(t.inputs,e),outputs:Tw(t.outputs),debugInfo:null}}function fI(t){t.features?.forEach(e=>e(t))}function Cw(t,e){if(!t)return null;let n=e?uI:ER;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(TR)}function CR(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function xt(t){return{\u0275providers:t}}function DR(...t){return{\u0275providers:pI(!0,t),\u0275fromNgModule:!0}}function pI(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return tf(e,o=>{let a=o;Dh(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&gI(i,s),n}function gI(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];of(i,s=>{e(s,r)})}}function Dh(t,e,n,r){if(t=St(t),!t)return!1;let i=null,s=yw(t),o=!s&&xr(t);if(!s&&!o){let u=t.ngModule;if(s=yw(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of u)Dh(l,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{tf(s.imports,f=>{Dh(f,e,n,r)&&(l||=[],l.push(f))})}finally{}l!==void 0&&gI(l,e)}if(!a){let l=zi(i)||(()=>new i);e({provide:i,useFactory:l,deps:Wi},i),e({provide:sI,useValue:i,multi:!0},i),e({provide:Gi,useValue:()=>Z(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let l=t;of(u,f=>{e(f,l)})}}else return!1;return i!==t&&t.providers!==void 0}function of(t,e){for(let n of t)eI(n)&&(n=n.\u0275providers),Array.isArray(n)?of(n,e):e(n)}var bR=ve({provide:String,useValue:ve});function mI(t){return t!==null&&typeof t=="object"&&bR in t}function SR(t){return!!(t&&t.useExisting)}function AR(t){return!!(t&&t.useFactory)}function bh(t){return typeof t=="function"}var uu=new G(""),Uc={},RR={},dh;function af(){return dh===void 0&&(dh=new Gc),dh}var Rt=class{},vo=class extends Rt{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ah(e,o=>this.processProvider(o)),this.records.set(iI,Ui(void 0,this)),i.has("environment")&&this.records.set(Rt,Ui(void 0,this));let s=this.records.get(uu);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(sI,Wi,Y.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=ge(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ge(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Xn(this),r=bt(void 0),i;try{return e()}finally{Xn(n),bt(r)}}get(e,n=yo,r=Y.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(vw))return e[vw](this);r=au(r);let i,s=Xn(this),o=bt(void 0);try{if(!(r&Y.SkipSelf)){let u=this.records.get(e);if(u===void 0){let l=OR(e)&&ou(e);l&&this.injectableDefInScope(l)?u=Ui(Sh(e),Uc):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&Y.Self?af():this.parent;return n=r&Y.Optional&&n===yo?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[zc]=a[zc]||[]).unshift(_t(e)),s)throw a;return aR(a,e,"R3InjectorError",this.source)}else throw a}finally{bt(o),Xn(s)}}resolveInjectorInitializers(){let e=ge(null),n=Xn(this),r=bt(void 0),i;try{let s=this.get(Gi,Wi,Y.Self);for(let o of s)o()}finally{Xn(n),bt(r),ge(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(_t(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){e=St(e);let n=bh(e)?e:St(e&&e.provide),r=xR(e);if(!bh(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Ui(void 0,Uc,!0),i.factory=()=>Th(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=ge(null);try{return n.value===Uc&&(n.value=RR,n.value=n.factory()),typeof n.value=="object"&&n.value&&kR(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{ge(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=St(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Sh(t){let e=ou(t),n=e!==null?e.factory:zi(t);if(n!==null)return n;if(t instanceof G)throw new $(204,!1);if(t instanceof Function)return NR(t);throw new $(204,!1)}function NR(t){if(t.length>0)throw new $(204,!1);let n=q0(t);return n!==null?()=>n.factory(t):()=>new t}function xR(t){if(mI(t))return Ui(void 0,t.useValue);{let e=PR(t);return Ui(e,Uc)}}function PR(t,e,n){let r;if(bh(t)){let i=St(t);return zi(i)||Sh(i)}else if(mI(t))r=()=>St(t.useValue);else if(AR(t))r=()=>t.useFactory(...Th(t.deps||[]));else if(SR(t))r=()=>Z(St(t.useExisting));else{let i=St(t&&(t.useClass||t.provide));if(MR(t))r=()=>new i(...Th(t.deps));else return zi(i)||Sh(i)}return r}function Ui(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function MR(t){return!!t.deps}function kR(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function OR(t){return typeof t=="function"||typeof t=="object"&&t instanceof G}function Ah(t,e){for(let n of t)Array.isArray(n)?Ah(n,e):n&&eI(n)?Ah(n.\u0275providers,e):e(n)}function Fr(t,e){t instanceof vo&&t.assertNotDestroyed();let n,r=Xn(t),i=bt(void 0);try{return e()}finally{Xn(r),bt(i)}}function FR(){return tI()!==void 0||rR()!=null}function LR(t){return typeof t=="function"}var Sn=0,se=1,q=2,et=3,Ht=4,zt=5,Kc=6,wo=7,Cn=8,Ki=9,en=10,qt=11,Io=12,Dw=13,Ro=14,tn=15,cf=16,ji=17,lu=18,du=19,yI=20,Zn=21,hh=22,Pr=23,Mr=25,_I=1;var kr=7,Qc=8,Yc=9,At=10,uf=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(uf||{});function Hi(t){return Array.isArray(t)&&typeof t[_I]=="object"}function An(t){return Array.isArray(t)&&t[_I]===!0}function vI(t){return(t.flags&4)!==0}function lf(t){return t.componentOffset>-1}function wI(t){return(t.flags&1)===1}function No(t){return!!t.template}function VR(t){return(t[q]&512)!==0}var Rh=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function II(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function hu(){return EI}function EI(t){return t.type.prototype.ngOnChanges&&(t.setInput=jR),UR}hu.ngInherit=!0;function UR(){let t=CI(this),e=t?.current;if(e){let n=t.previous;if(n===_o)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function jR(t,e,n,r,i){let s=this.declaredInputs[r],o=CI(t)||BR(t,{previous:_o,current:null}),a=o.current||(o.current={}),u=o.previous,l=u[s];a[s]=new Rh(l&&l.currentValue,n,u===_o),II(t,e,i,n)}var TI="__ngSimpleChanges__";function CI(t){return t[TI]||null}function BR(t,e){return t[TI]=e}var bw=null;var Jt=function(t,e,n){bw?.(t,e,n)},$R="svg",HR="math",qR=!1;function zR(){return qR}function Dn(t){for(;Array.isArray(t);)t=t[Sn];return t}function nn(t,e){return Dn(e[t.index])}function WR(t,e){return t.data[e]}function Ji(t,e){let n=e[t];return Hi(n)?n:n[Sn]}function df(t){return(t[q]&128)===128}function GR(t){return An(t[et])}function Sw(t,e){return e==null?null:t[e]}function DI(t){t[ji]=0}function KR(t){t[q]&1024||(t[q]|=1024,df(t)&&Eo(t))}function hf(t){return!!(t[q]&9216||t[Pr]?.dirty)}function Nh(t){t[en].changeDetectionScheduler?.notify(1),hf(t)?Eo(t):t[q]&64&&(zR()?(t[q]|=1024,Eo(t)):t[en].changeDetectionScheduler?.notify())}function Eo(t){t[en].changeDetectionScheduler?.notify();let e=To(t);for(;e!==null&&!(e[q]&8192||(e[q]|=8192,!df(e)));)e=To(e)}function bI(t,e){if((t[q]&256)===256)throw new $(911,!1);t[Zn]===null&&(t[Zn]=[]),t[Zn].push(e)}function QR(t,e){if(t[Zn]===null)return;let n=t[Zn].indexOf(e);n!==-1&&t[Zn].splice(n,1)}function To(t){let e=t[et];return An(e)?e[et]:e}var me={lFrame:MI(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function YR(){return me.lFrame.elementDepthCount}function JR(){me.lFrame.elementDepthCount++}function XR(){me.lFrame.elementDepthCount--}function SI(){return me.bindingsEnabled}function ZR(){return me.skipHydrationRootTNode!==null}function eN(t){return me.skipHydrationRootTNode===t}function tN(){me.skipHydrationRootTNode=null}function Nt(){return me.lFrame.lView}function fu(){return me.lFrame.tView}function Rn(){let t=AI();for(;t!==null&&t.type===64;)t=t.parent;return t}function AI(){return me.lFrame.currentTNode}function nN(){let t=me.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function pu(t,e){let n=me.lFrame;n.currentTNode=t,n.isParent=e}function RI(){return me.lFrame.isParent}function rN(){me.lFrame.isParent=!1}function iN(t){return me.lFrame.bindingIndex=t}function sN(){return me.lFrame.inI18n}function oN(t,e){let n=me.lFrame;n.bindingIndex=n.bindingRootIndex=t,xh(e)}function aN(){return me.lFrame.currentDirectiveIndex}function xh(t){me.lFrame.currentDirectiveIndex=t}function NI(t){me.lFrame.currentQueryIndex=t}function cN(t){let e=t[se];return e.type===2?e.declTNode:e.type===1?t[zt]:null}function xI(t,e,n){if(n&Y.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&Y.Host);)if(i=cN(s),i===null||(s=s[Ro],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=me.lFrame=PI();return r.currentTNode=e,r.lView=t,!0}function ff(t){let e=PI(),n=t[se];me.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function PI(){let t=me.lFrame,e=t===null?null:t.child;return e===null?MI(t):e}function MI(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function kI(){let t=me.lFrame;return me.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var OI=kI;function pf(){let t=kI();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function uN(){return me.lFrame.selectedIndex}function Or(t){me.lFrame.selectedIndex=t}function lN(){return me.lFrame.currentNamespace}var FI=!0;function LI(){return FI}function VI(t){FI=t}function dN(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=EI(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function UI(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:f}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),f!=null&&(t.destroyHooks??=[]).push(n,f)}}function jc(t,e,n){jI(t,e,3,n)}function Bc(t,e,n,r){(t[q]&3)===n&&jI(t,e,n,r)}function fh(t,e){let n=t[q];(n&3)===e&&(n&=16383,n+=1,t[q]=n)}function jI(t,e,n,r){let i=r!==void 0?t[ji]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[ji]+=65536),(a<s||s==-1)&&(hN(t,n,e,u),t[ji]=(t[ji]&4294901760)+u+2),u++}function Aw(t,e){Jt(4,t,e);let n=ge(null);try{e.call(t)}finally{ge(n),Jt(5,t,e)}}function hN(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[q]>>14<t[ji]>>16&&(t[q]&3)===e&&(t[q]+=16384,Aw(a,s)):Aw(a,s)}var qi=-1,Co=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function fN(t){return t instanceof Co}function pN(t){return(t.flags&8)!==0}function gN(t){return(t.flags&16)!==0}function BI(t){return t!==qi}function Jc(t){return t&32767}function mN(t){return t>>16}function Xc(t,e){let n=mN(t),r=e;for(;n>0;)r=r[Ro],n--;return r}var Ph=!0;function Rw(t){let e=Ph;return Ph=t,e}var yN=256,$I=yN-1,HI=5,_N=0,Xt={};function vN(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(mo)&&(r=n[mo]),r==null&&(r=n[mo]=_N++);let i=r&$I,s=1<<i;e.data[t+(i>>HI)]|=s}function qI(t,e){let n=zI(t,e);if(n!==-1)return n;let r=e[se];r.firstCreatePass&&(t.injectorIndex=e.length,ph(r.data,t),ph(e,null),ph(r.blueprint,null));let i=gf(t,e),s=t.injectorIndex;if(BI(i)){let o=Jc(i),a=Xc(i,e),u=a[se].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function ph(t,e){t.push(0,0,0,0,0,0,0,0,e)}function zI(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function gf(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=YI(i),r===null)return qi;if(n++,i=i[Ro],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return qi}function wN(t,e,n){vN(t,e,n)}function WI(t,e,n){if(n&Y.Optional||t!==void 0)return t;ef(e,"NodeInjector")}function GI(t,e,n,r){if(n&Y.Optional&&r===void 0&&(r=null),!(n&(Y.Self|Y.Host))){let i=t[Ki],s=bt(void 0);try{return i?i.get(e,r,n&Y.Optional):nI(e,r,n&Y.Optional)}finally{bt(s)}}return WI(r,e,n)}function KI(t,e,n,r=Y.Default,i){if(t!==null){if(e[q]&2048&&!(r&Y.Self)){let o=DN(t,e,n,r,Xt);if(o!==Xt)return o}let s=QI(t,e,n,r,Xt);if(s!==Xt)return s}return GI(e,n,r,i)}function QI(t,e,n,r,i){let s=TN(n);if(typeof s=="function"){if(!xI(e,t,r))return r&Y.Host?WI(i,n,r):GI(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&Y.Optional))ef(n);else return o}finally{OI()}}else if(typeof s=="number"){let o=null,a=zI(t,e),u=qi,l=r&Y.Host?e[tn][zt]:null;for((a===-1||r&Y.SkipSelf)&&(u=a===-1?gf(t,e):e[a+8],u===qi||!xw(r,!1)?a=-1:(o=e[se],a=Jc(u),e=Xc(u,e)));a!==-1;){let f=e[se];if(Nw(s,a,f.data)){let p=IN(a,e,n,o,r,l);if(p!==Xt)return p}u=e[a+8],u!==qi&&xw(r,e[se].data[a+8]===l)&&Nw(s,a,e)?(o=f,a=Jc(u),e=Xc(u,e)):a=-1}}return i}function IN(t,e,n,r,i,s){let o=e[se],a=o.data[t+8],u=r==null?lf(a)&&Ph:r!=o&&(a.type&3)!==0,l=i&Y.Host&&s===a,f=EN(a,o,n,u,l);return f!==null?Do(e,o,f,a):Xt}function EN(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,l=t.directiveEnd,f=s>>20,p=r?a:a+f,m=i?a+f:l;for(let D=p;D<m;D++){let A=o[D];if(D<u&&n===A||D>=u&&A.type===n)return D}if(i){let D=o[u];if(D&&No(D)&&D.type===n)return u}return null}function Do(t,e,n,r){let i=t[n],s=e.data;if(fN(i)){let o=i;o.resolving&&X0(J0(s[n]));let a=Rw(o.canSeeViewProviders);o.resolving=!0;let u,l=o.injectImpl?bt(o.injectImpl):null,f=xI(t,r,Y.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&dN(n,s[n],e)}finally{l!==null&&bt(l),Rw(a),o.resolving=!1,OI()}}return i}function TN(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(mo)?t[mo]:void 0;return typeof e=="number"?e>=0?e&$I:CN:e}function Nw(t,e,n){let r=1<<t;return!!(n[e+(t>>HI)]&r)}function xw(t,e){return!(t&Y.Self)&&!(t&Y.Host&&e)}var Nr=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return KI(this._tNode,this._lView,e,au(r),n)}};function CN(){return new Nr(Rn(),Nt())}function mf(t){return su(()=>{let e=t.prototype.constructor,n=e[qc]||Mh(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[qc]||Mh(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Mh(t){return Yw(t)?()=>{let e=Mh(St(t));return e&&e()}:zi(t)}function DN(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[q]&2048&&!(o[q]&512);){let a=QI(s,o,n,r|Y.Self,Xt);if(a!==Xt)return a;let u=s.parent;if(!u){let l=o[yI];if(l){let f=l.get(n,Xt,r);if(f!==Xt)return f}u=YI(o),o=o[Ro]}s=u}return i}function YI(t){let e=t[se],n=e.type;return n===2?e.declTNode:n===1?t[zt]:null}function Pw(t,e=null,n=null,r){let i=JI(t,e,n,r);return i.resolveInjectorInitializers(),i}function JI(t,e=null,n=null,r,i=new Set){let s=[n||Wi,DR(t)];return r=r||(typeof t=="object"?void 0:_t(t)),new vo(s,e||af(),r||null,i)}var vt=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return Pw({name:""},i,r,"");{let s=r.name??"";return Pw({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=yo,e.NULL=new Gc,e.\u0275prov=z({token:e,providedIn:"any",factory:()=>Z(iI)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var bN="ngOriginalError";function gh(t){return t[bN]}var bn=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&gh(e);for(;n&&gh(n);)n=gh(n);return n||null}},XI=new G("",{providedIn:"root",factory:()=>O(bn).handleError.bind(void 0)}),ZI=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=SN,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),kh=class extends ZI{constructor(e){super(),this._lView=e}onDestroy(e){return bI(this._lView,e),()=>QR(this._lView,e)}};function SN(){return new kh(Nt())}function AN(){return yf(Rn(),Nt())}function yf(t,e){return new gu(nn(t,e))}var gu=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=AN;let t=e;return t})();var Oh=class extends lt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,FR()&&(this.destroyRef=O(ZI,{optional:!0})??void 0)}emit(e){let n=ge(null);try{super.next(e)}finally{ge(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=mh(s),i&&(i=mh(i)),o&&(o=mh(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Re&&e.add(a),a}};function mh(t){return e=>{setTimeout(t,void 0,e)}}var $t=Oh;function eE(t){return(t.flags&128)===128}var tE=new Map,RN=0;function NN(){return RN++}function xN(t){tE.set(t[du],t)}function PN(t){tE.delete(t[du])}var Mw="__ngContext__";function Qi(t,e){Hi(e)?(t[Mw]=e[du],xN(e)):t[Mw]=e}function nE(t){return iE(t[Io])}function rE(t){return iE(t[Ht])}function iE(t){for(;t!==null&&!An(t);)t=t[Ht];return t}var Fh;function sE(t){Fh=t}function MN(){if(Fh!==void 0)return Fh;if(typeof document<"u")return document;throw new $(210,!1)}var _f=new G("",{providedIn:"root",factory:()=>kN}),kN="ng",vf=new G(""),rr=new G("",{providedIn:"platform",factory:()=>"unknown"});var wf=new G("",{providedIn:"root",factory:()=>MN().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var ON="h",FN="b";var LN=()=>null;function If(t,e,n=!1){return LN(t,e,n)}var oE=!1,VN=new G("",{providedIn:"root",factory:()=>oE});function aE(t){return t instanceof Function?t():t}var Lr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Lr||{}),UN;function Ef(t,e){return UN(t,e)}function Bi(t,e,n,r,i){if(r!=null){let s,o=!1;An(r)?s=r:Hi(r)&&(o=!0,r=r[Sn]);let a=Dn(r);t===0&&n!==null?i==null?hE(e,n,a):Zc(e,n,a,i||null,!0):t===1&&n!==null?Zc(e,n,a,i||null,!0):t===2?tx(e,a,o):t===3&&e.destroyNode(a),s!=null&&rx(e,t,s,n,i)}}function jN(t,e){return t.createText(e)}function cE(t,e,n){return t.createElement(e,n)}function BN(t,e){uE(t,e),e[Sn]=null,e[zt]=null}function $N(t,e,n,r,i,s){r[Sn]=i,r[zt]=e,mu(t,r,n,1,i,s)}function uE(t,e){e[en].changeDetectionScheduler?.notify(1),mu(t,e,e[qt],2,null,null)}function HN(t){let e=t[Io];if(!e)return yh(t[se],t);for(;e;){let n=null;if(Hi(e))n=e[Io];else{let r=e[At];r&&(n=r)}if(!n){for(;e&&!e[Ht]&&e!==t;)Hi(e)&&yh(e[se],e),e=e[et];e===null&&(e=t),Hi(e)&&yh(e[se],e),n=e&&e[Ht]}e=n}}function qN(t,e,n,r){let i=At+r,s=n.length;r>0&&(n[i-1][Ht]=e),r<s-At?(e[Ht]=n[i],rI(n,At+r,e)):(n.push(e),e[Ht]=null),e[et]=n;let o=e[cf];o!==null&&n!==o&&zN(o,e);let a=e[lu];a!==null&&a.insertView(t),Nh(e),e[q]|=128}function zN(t,e){let n=t[Yc],i=e[et][et][tn];e[tn]!==i&&(t[q]|=uf.HasTransplantedViews),n===null?t[Yc]=[e]:n.push(e)}function lE(t,e){let n=t[Yc],r=n.indexOf(e);n.splice(r,1)}function Lh(t,e){if(t.length<=At)return;let n=At+e,r=t[n];if(r){let i=r[cf];i!==null&&i!==t&&lE(i,r),e>0&&(t[n-1][Ht]=r[Ht]);let s=Wc(t,At+e);BN(r[se],r);let o=s[lu];o!==null&&o.detachView(s[se]),r[et]=null,r[Ht]=null,r[q]&=-129}return r}function dE(t,e){if(!(e[q]&256)){let n=e[qt];n.destroyNode&&mu(t,e,n,3,null,null),HN(e)}}function yh(t,e){if(e[q]&256)return;let n=ge(null);try{e[q]&=-129,e[q]|=256,e[Pr]&&Uv(e[Pr]),GN(t,e),WN(t,e),e[se].type===1&&e[qt].destroy();let r=e[cf];if(r!==null&&An(e[et])){r!==e[et]&&lE(r,e);let i=e[lu];i!==null&&i.detachView(t)}PN(e)}finally{ge(n)}}function WN(t,e){let n=t.cleanup,r=e[wo];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[wo]=null);let i=e[Zn];if(i!==null){e[Zn]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function GN(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Co)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];Jt(4,a,u);try{u.call(a)}finally{Jt(5,a,u)}}else{Jt(4,i,s);try{s.call(i)}finally{Jt(5,i,s)}}}}}function KN(t,e,n){return QN(t,e.parent,n)}function QN(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Sn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===Zt.None||s===Zt.Emulated)return null}return nn(r,n)}}function Zc(t,e,n,r,i){t.insertBefore(e,n,r,i)}function hE(t,e,n){t.appendChild(e,n)}function kw(t,e,n,r,i){r!==null?Zc(t,e,n,r,i):hE(t,e,n)}function YN(t,e,n,r){t.removeChild(e,n,r)}function Tf(t,e){return t.parentNode(e)}function JN(t,e){return t.nextSibling(e)}function XN(t,e,n){return ex(t,e,n)}function ZN(t,e,n){return t.type&40?nn(t,n):null}var ex=ZN,Ow;function fE(t,e,n,r){let i=KN(t,r,e),s=e[qt],o=r.parent||e[zt],a=XN(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)kw(s,i,n[u],a,!1);else kw(s,i,n,a,!1);Ow!==void 0&&Ow(s,r,e,n,i)}function $c(t,e){if(e!==null){let n=e.type;if(n&3)return nn(e,t);if(n&4)return Vh(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return $c(t,r);{let i=t[e.index];return An(i)?Vh(-1,i):Dn(i)}}else{if(n&32)return Ef(e,t)()||Dn(t[e.index]);{let r=pE(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=To(t[tn]);return $c(i,r)}else return $c(t,e.next)}}}return null}function pE(t,e){if(e!==null){let r=t[tn][zt],i=e.projection;return r.projection[i]}return null}function Vh(t,e){let n=At+t+1;if(n<e.length){let r=e[n],i=r[se].firstChild;if(i!==null)return $c(r,i)}return e[kr]}function tx(t,e,n){let r=Tf(t,e);r&&YN(t,r,e,n)}function Cf(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&Qi(Dn(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)Cf(t,e,n.child,r,i,s,!1),Bi(e,t,i,a,s);else if(u&32){let l=Ef(n,r),f;for(;f=l();)Bi(e,t,i,f,s);Bi(e,t,i,a,s)}else u&16?nx(t,e,r,n,i,s):Bi(e,t,i,a,s);n=o?n.projectionNext:n.next}}function mu(t,e,n,r,i,s){Cf(n,r,t.firstChild,e,i,s,!1)}function nx(t,e,n,r,i,s){let o=n[tn],u=o[zt].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let f=u[l];Bi(e,t,i,f,s)}else{let l=u,f=o[et];eE(r)&&(l.flags|=128),Cf(t,e,l,f,i,s,!0)}}function rx(t,e,n,r,i){let s=n[kr],o=Dn(n);s!==o&&Bi(e,t,r,s,i);for(let a=At;a<n.length;a++){let u=n[a];mu(u[se],u,t,e,r,s)}}function ix(t,e,n){t.setAttribute(e,"style",n)}function gE(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function mE(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&Ch(t,e,r),i!==null&&gE(t,e,i),s!==null&&ix(t,e,s)}var yE={};function sx(t,e,n,r){if(!r)if((e[q]&3)===3){let s=t.preOrderCheckHooks;s!==null&&jc(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Bc(e,s,0,n)}Or(n)}function xo(t,e=Y.Default){let n=Nt();if(n===null)return Z(t,e);let r=Rn();return KI(r,n,St(t),e)}function _E(t,e,n,r,i,s){let o=ge(null);try{let a=null;i&er.SignalBased&&(a=e[r][Ov]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&er.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):II(e,a,r,s)}finally{ge(o)}}function ox(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Or(~i);else{let s=i,o=n[++r],a=n[++r];oN(o,s);let u=e[s];a(2,u)}}}finally{Or(-1)}}function Df(t,e,n,r,i,s,o,a,u,l,f){let p=e.blueprint.slice();return p[Sn]=i,p[q]=r|4|128|8|64,(l!==null||t&&t[q]&2048)&&(p[q]|=2048),DI(p),p[et]=p[Ro]=t,p[Cn]=n,p[en]=o||t&&t[en],p[qt]=a||t&&t[qt],p[Ki]=u||t&&t[Ki]||null,p[zt]=s,p[du]=NN(),p[Kc]=f,p[yI]=l,p[tn]=e.type==2?t[tn]:p,p}function bf(t,e,n,r,i){let s=t.data[e];if(s===null)s=ax(t,e,n,r,i),sN()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=nN();s.injectorIndex=o===null?-1:o.injectorIndex}return pu(s,!0),s}function ax(t,e,n,r,i){let s=AI(),o=RI(),a=o?s:s&&s.parent,u=t.data[e]=px(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function vE(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function wE(t,e,n,r,i){let s=uN(),o=r&2;try{Or(-1),o&&e.length>Mr&&sx(t,e,Mr,!1),Jt(o?2:0,i),n(r,i)}finally{Or(s),Jt(o?3:1,i)}}function IE(t,e,n){if(vI(e)){let r=ge(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let u=n[o];a.contentQueries(1,u,o)}}}finally{ge(r)}}}function cx(t,e,n){SI()&&(vx(t,e,n,nn(n,e)),(n.flags&64)===64&&DE(t,e,n))}function ux(t,e,n=nn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function EE(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=TE(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function TE(t,e,n,r,i,s,o,a,u,l,f){let p=Mr+r,m=p+i,D=lx(p,m),A=typeof l=="function"?l():l;return D[se]={type:t,blueprint:D,template:n,queries:null,viewQuery:a,declTNode:e,data:D.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:A,incompleteFirstPass:!1,ssrId:f}}function lx(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:yE);return n}function dx(t,e,n,r){let s=r.get(VN,oE)||n===Zt.ShadowDom,o=t.selectRootElement(e,s);return hx(o),o}function hx(t){fx(t)}var fx=()=>null;function px(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return ZR()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Fw(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=er.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}t===0?Lw(r,n,l,a,u):Lw(r,n,l,a)}return r}function Lw(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function gx(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,l=null;for(let f=r;f<i;f++){let p=s[f],m=n?n.get(p):null,D=m?m.inputs:null,A=m?m.outputs:null;u=Fw(0,p.inputs,f,u,D),l=Fw(1,p.outputs,f,l,A);let R=u!==null&&o!==null&&!rf(e)?Ax(u,f,o):null;a.push(R)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}function mx(t,e,n,r){if(SI()){let i=r===null?null:{"":-1},s=Ix(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&CE(t,e,n,o,i,a),i&&Ex(n,r,i)}n.mergedAttrs=nf(n.mergedAttrs,n.attrs)}function CE(t,e,n,r,i,s){for(let l=0;l<r.length;l++)wN(qI(n,e),t,r[l].type);Cx(n,t.data.length,r.length);for(let l=0;l<r.length;l++){let f=r[l];f.providersResolver&&f.providersResolver(f)}let o=!1,a=!1,u=vE(t,e,r.length,null);for(let l=0;l<r.length;l++){let f=r[l];n.mergedAttrs=nf(n.mergedAttrs,f.hostAttrs),Dx(t,n,e,u,f),Tx(u,f,i),f.contentQueries!==null&&(n.flags|=4),(f.hostBindings!==null||f.hostAttrs!==null||f.hostVars!==0)&&(n.flags|=64);let p=f.type.prototype;!o&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}gx(t,n,s)}function yx(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;_x(o)!=a&&o.push(a),o.push(n,r,s)}}function _x(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function vx(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;lf(n)&&bx(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||qI(n,e),Qi(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],l=Do(e,t,a,n);if(Qi(l,e),o!==null&&Sx(e,a-i,l,u,n,o),No(u)){let f=Ji(n.index,e);f[Cn]=Do(e,t,a,n)}}}function DE(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=aN();try{Or(s);for(let a=r;a<i;a++){let u=t.data[a],l=e[a];xh(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&wx(u,l)}}finally{Or(-1),xh(o)}}function wx(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function Ix(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(mR(e,o.selectors,!1))if(r||(r=[]),No(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;Uh(t,e,u)}else r.unshift(o),Uh(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Uh(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function Ex(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}}function Tx(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;No(e)&&(n[""]=t)}}function Cx(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Dx(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=zi(i.type,!0)),o=new Co(s,No(i),xo);t.blueprint[r]=o,n[r]=o,yx(t,e,r,vE(t,n,i.hostVars,yE),i)}function bx(t,e,n){let r=nn(e,t),i=EE(n),s=t[en].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=Sf(t,Df(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function Sx(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],l=o[a++],f=o[a++],p=o[a++];_E(r,n,u,l,f,p)}}function Ax(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function Rx(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function bE(t,e){let n=t.contentQueries;if(n!==null){let r=ge(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];NI(s),a.contentQueries(2,e[o],o)}}}finally{ge(r)}}}function Sf(t,e){return t[Io]?t[Dw][Ht]=e:t[Io]=e,t[Dw]=e,e}function jh(t,e,n){NI(0);let r=ge(null);try{e(t,n)}finally{ge(r)}}function Nx(t){return t[wo]||(t[wo]=[])}function xx(t){return t.cleanup||(t.cleanup=[])}function SE(t,e){let n=t[Ki],r=n?n.get(bn,null):null;r&&r.handleError(e)}function AE(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],l=e[o],f=t.data[o];_E(f,l,r,a,u,i)}}function Px(t,e){let n=Ji(e,t),r=n[se];Mx(r,n);let i=n[Sn];i!==null&&n[Kc]===null&&(n[Kc]=If(i,n[Ki])),RE(r,n,n[Cn])}function Mx(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function RE(t,e,n){ff(e);try{let r=t.viewQuery;r!==null&&jh(1,r,n);let i=t.template;i!==null&&wE(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[lu]?.finishViewCreation(t),t.staticContentQueries&&bE(t,e),t.staticViewQueries&&jh(2,t.viewQuery,n);let s=t.components;s!==null&&kx(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[q]&=-5,pf()}}function kx(t,e){for(let n=0;n<e.length;n++)Px(t,e[n])}function Vw(t,e){return!e||e.firstChild===null||eE(t)}function Ox(t,e,n,r=!0){let i=e[se];if(qN(i,e,t,n),r){let o=Vh(n,t),a=e[qt],u=Tf(a,t[kr]);u!==null&&$N(i,t[zt],a,e,u,o)}let s=e[Kc];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function eu(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(Dn(s)),An(s)&&Fx(s,r);let o=n.type;if(o&8)eu(t,e,n.child,r);else if(o&32){let a=Ef(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=pE(e,n);if(Array.isArray(a))r.push(...a);else{let u=To(e[tn]);eu(u[se],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function Fx(t,e){for(let n=At;n<t.length;n++){let r=t[n],i=r[se].firstChild;i!==null&&eu(r[se],r,i,e)}t[kr]!==t[Sn]&&e.push(t[kr])}var NE=[];function Lx(t){return t[Pr]??Vx(t)}function Vx(t){let e=NE.pop()??Object.create(jx);return e.lView=t,e}function Ux(t){t.lView[Pr]!==t&&(t.lView=null,NE.push(t))}var jx=Ae(F({},Fv),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Eo(t.lView)},consumerOnSignalRead(){this.lView[Pr]=this}}),xE=100;function PE(t,e=!0,n=0){let r=t[en],i=r.rendererFactory,s=!1;s||i.begin?.();try{Bx(t,n)}catch(o){throw e&&SE(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function Bx(t,e){Bh(t,e);let n=0;for(;hf(t);){if(n===xE)throw new $(103,!1);n++,Bh(t,1)}}function $x(t,e,n,r){let i=e[q];if((i&256)===256)return;let s=!1;!s&&e[en].inlineEffectRunner?.flush(),ff(e);let o=null,a=null;!s&&Hx(t)&&(a=Lx(e),o=Lv(a));try{DI(e),iN(t.bindingStartIndex),n!==null&&wE(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let p=t.preOrderCheckHooks;p!==null&&jc(e,p,null)}else{let p=t.preOrderHooks;p!==null&&Bc(e,p,0,null),fh(e,0)}if(qx(e),ME(e,0),t.contentQueries!==null&&bE(t,e),!s)if(u){let p=t.contentCheckHooks;p!==null&&jc(e,p)}else{let p=t.contentHooks;p!==null&&Bc(e,p,1),fh(e,1)}ox(t,e);let l=t.components;l!==null&&OE(e,l,0);let f=t.viewQuery;if(f!==null&&jh(2,f,r),!s)if(u){let p=t.viewCheckHooks;p!==null&&jc(e,p)}else{let p=t.viewHooks;p!==null&&Bc(e,p,2),fh(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[hh]){for(let p of e[hh])p();e[hh]=null}s||(e[q]&=-73)}catch(u){throw Eo(e),u}finally{a!==null&&(Vv(a,o),Ux(a)),pf()}}function Hx(t){return t.type!==2}function ME(t,e){for(let n=nE(t);n!==null;n=rE(n))for(let r=At;r<n.length;r++){let i=n[r];kE(i,e)}}function qx(t){for(let e=nE(t);e!==null;e=rE(e)){if(!(e[q]&uf.HasTransplantedViews))continue;let n=e[Yc];for(let r=0;r<n.length;r++){let i=n[r],s=i[et];KR(i)}}}function zx(t,e,n){let r=Ji(e,t);kE(r,n)}function kE(t,e){df(t)&&Bh(t,e)}function Bh(t,e){let r=t[se],i=t[q],s=t[Pr],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&$d(s)),s&&(s.dirty=!1),t[q]&=-9217,o)$x(r,t,r.template,t[Cn]);else if(i&8192){ME(t,1);let a=r.components;a!==null&&OE(t,a,1)}}function OE(t,e,n){for(let r=0;r<e.length;r++)zx(t,e[r],n)}function Af(t){for(t[en].changeDetectionScheduler?.notify();t;){t[q]|=64;let e=To(t);if(VR(t)&&!e)return t;t=e}return null}var Yi=class{get rootNodes(){let e=this._lView,n=e[se];return eu(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Cn]}set context(e){this._lView[Cn]=e}get destroyed(){return(this._lView[q]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[et];if(An(e)){let n=e[Qc],r=n?n.indexOf(this):-1;r>-1&&(Lh(e,r),Wc(n,r))}this._attachedToViewContainer=!1}dE(this._lView[se],this._lView)}onDestroy(e){bI(this._lView,e)}markForCheck(){Af(this._cdRefInjectingView||this._lView)}detach(){this._lView[q]&=-129}reattach(){Nh(this._lView),this._lView[q]|=128}detectChanges(){this._lView[q]|=1024,PE(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,uE(this._lView[se],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e,Nh(this._lView)}};var _G=new RegExp(`^(\\d+)*(${FN}|${ON})*(.*)`);var Wx=()=>null;function Uw(t,e){return Wx(t,e)}var $h=class{},Hh=class{},tu=class{};function Gx(t){let e=Error(`No component factory found for ${_t(t)}.`);return e[Kx]=t,e}var Kx="ngComponent";var qh=class{resolveComponentFactory(e){throw Gx(e)}},yu=(()=>{let e=class e{};e.NULL=new qh;let t=e;return t})(),bo=class{};var Qx=(()=>{let e=class e{};e.\u0275prov=z({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),_h={};var jw=new Set;function FE(t){jw.has(t)||(jw.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function Bw(...t){}function Yx(){let t=typeof go.requestAnimationFrame=="function",e=go[t?"requestAnimationFrame":"setTimeout"],n=go[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var fe=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new $t(!1),this.onMicrotaskEmpty=new $t(!1),this.onStable=new $t(!1),this.onError=new $t(!1),typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=Yx().nativeRequestAnimationFrame,Zx(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new $(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,Jx,Bw,Bw);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},Jx={};function Rf(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Xx(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(go,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,zh(t),t.isCheckStableRunning=!0,Rf(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),zh(t))}function Zx(t){let e=()=>{Xx(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(eP(a))return n.invokeTask(i,s,o,a);try{return $w(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),Hw(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return $w(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),Hw(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,zh(t),Rf(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function zh(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function $w(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Hw(t){t._nesting--,Rf(t)}function eP(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var LE=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=z({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function Wh(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=gw(i,a);else if(s==2){let u=a,l=e[++o];r=gw(r,u+": "+l+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var nu=class extends yu{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=xr(e);return new So(n,this.ngModule)}};function qw(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function tP(t){let e=t.toLowerCase();return e==="svg"?$R:e==="math"?HR:null}var Gh=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=au(r);let i=this.injector.get(e,_h,r);return i!==_h||n===_h?i:this.parentInjector.get(e,n,r)}},So=class extends tu{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=qw(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return qw(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=wR(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=ge(null);try{i=i||this.ngModule;let o=i instanceof Rt?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Gh(e,o):e,u=a.get(bo,null);if(u===null)throw new $(407,!1);let l=a.get(Qx,null),f=a.get(LE,null),p=a.get($h,null),m={rendererFactory:u,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:f,changeDetectionScheduler:p},D=u.createRenderer(null,this.componentDef),A=this.componentDef.selectors[0][0]||"div",R=r?dx(D,r,this.componentDef.encapsulation,a):cE(D,A,tP(A)),x=512;this.componentDef.signals?x|=4096:this.componentDef.onPush||(x|=16);let V=null;R!==null&&(V=If(R,a,!0));let K=TE(0,null,null,1,0,null,null,null,null,null,null),B=Df(null,K,null,x,null,null,m,D,a,null,V);ff(B);let de,We;try{let he=this.componentDef,I,y=null;he.findHostDirectiveDefs?(I=[],y=new Map,he.findHostDirectiveDefs(he,I,y),I.push(he)):I=[he];let _=nP(B,R),w=rP(_,R,he,I,B,m,D);We=WR(K,Mr),R&&oP(D,he,R,r),n!==void 0&&aP(We,this.ngContentSelectors,n),de=sP(w,he,I,y,B,[cP]),RE(K,B,null)}finally{pf()}return new Kh(this.componentType,de,yf(We,B),B,We)}finally{ge(s)}}},Kh=class extends Hh{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Yi(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;AE(s[se],s,i,e,n),this.previousInputValues.set(e,n);let o=Ji(this._tNode.index,s);Af(o)}}get injector(){return new Nr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function nP(t,e){let n=t[se],r=Mr;return t[r]=e,bf(n,r,2,"#host",null)}function rP(t,e,n,r,i,s,o){let a=i[se];iP(r,t,e,o);let u=null;e!==null&&(u=If(e,i[Ki]));let l=s.rendererFactory.createRenderer(e,n),f=16;n.signals?f=4096:n.onPush&&(f=64);let p=Df(i,EE(n),null,f,i[t.index],t,s,l,null,null,u);return a.firstCreatePass&&Uh(a,t,r.length-1),Sf(i,p),i[t.index]=p}function iP(t,e,n,r){for(let i of t)e.mergedAttrs=nf(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Wh(e,e.mergedAttrs,!0),n!==null&&mE(r,n,e))}function sP(t,e,n,r,i,s){let o=Rn(),a=i[se],u=nn(o,i);CE(a,i,o,n,null,r);for(let f=0;f<n.length;f++){let p=o.directiveStart+f,m=Do(i,a,p,o);Qi(m,i)}DE(a,i,o),u&&Qi(u,i);let l=Do(i,a,o.directiveStart+o.componentOffset,o);if(t[Cn]=i[Cn]=l,s!==null)for(let f of s)f(l,e);return IE(a,o,i),l}function oP(t,e,n,r){if(r)Ch(t,n,["ng-version","17.3.10"]);else{let{attrs:i,classes:s}=IR(e.selectors[0]);i&&Ch(t,n,i),s&&s.length>0&&gE(t,n,s.join(" "))}}function aP(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function cP(){let t=Rn();UI(Nt()[se],t)}var _u=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=uP;let t=e;return t})();function uP(){let t=Rn();return dP(t,Nt())}var lP=_u,VE=class extends lP{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return yf(this._hostTNode,this._hostLView)}get injector(){return new Nr(this._hostTNode,this._hostLView)}get parentInjector(){let e=gf(this._hostTNode,this._hostLView);if(BI(e)){let n=Xc(e,this._hostLView),r=Jc(e),i=n[se].data[r+8];return new Nr(i,n)}else return new Nr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=zw(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-At}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Uw(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,Vw(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!LR(e),a;if(o)a=n;else{let A=n||{};a=A.index,r=A.injector,i=A.projectableNodes,s=A.environmentInjector||A.ngModuleRef}let u=o?e:new So(xr(e)),l=r||this.parentInjector;if(!s&&u.ngModule==null){let R=(o?l:this.parentInjector).get(Rt,null);R&&(s=R)}let f=xr(u.componentType??{}),p=Uw(this._lContainer,f?.id??null),m=p?.firstChild??null,D=u.create(l,i,m,s);return this.insertImpl(D.hostView,a,Vw(this._hostTNode,p)),D}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(GR(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[et],l=new VE(u,u[zt],u[et]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return Ox(o,i,s,r),e.attachToViewContainerRef(),rI(vh(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=zw(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Lh(this._lContainer,n);r&&(Wc(vh(this._lContainer),n),dE(r[se],r))}detach(e){let n=this._adjustIndex(e,-1),r=Lh(this._lContainer,n);return r&&Wc(vh(this._lContainer),n)!=null?new Yi(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function zw(t){return t[Qc]}function vh(t){return t[Qc]||(t[Qc]=[])}function dP(t,e){let n,r=e[t.index];return An(r)?n=r:(n=Rx(r,e,null,t),e[t.index]=n,Sf(e,n)),fP(n,e,t,r),new VE(n,t,e)}function hP(t,e){let n=t[qt],r=n.createComment(""),i=nn(e,t),s=Tf(n,i);return Zc(n,s,r,JN(n,i),!1),r}var fP=pP;function pP(t,e,n,r){if(t[kr])return;let i;n.type&8?i=Dn(r):i=hP(e,n),t[kr]=i}var tr=class{},Ao=class{};var Qh=class extends tr{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new nu(this);let i=dI(e);this._bootstrapComponents=aE(i.bootstrap),this._r3Injector=JI(e,n,[{provide:tr,useValue:this},{provide:yu,useValue:this.componentFactoryResolver},...r],_t(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Yh=class extends Ao{constructor(e){super(),this.moduleType=e}create(e){return new Qh(this.moduleType,e,[])}};var ru=class extends tr{constructor(e){super(),this.componentFactoryResolver=new nu(this),this.instance=null;let n=new vo([...e.providers,{provide:tr,useValue:this},{provide:yu,useValue:this.componentFactoryResolver}],e.parent||af(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Nf(t,e,n=null){return new ru({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var vu=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Ke(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function gP(t){return(t.flags&32)===32}function Ww(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";AE(t,n,s[o],o,r)}function mP(t,e,n,r,i,s){let o=e.consts,a=Sw(o,i),u=bf(e,t,2,r,a);return mx(e,n,u,Sw(o,s)),u.attrs!==null&&Wh(u,u.attrs,!1),u.mergedAttrs!==null&&Wh(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function Po(t,e,n,r){let i=Nt(),s=fu(),o=Mr+t,a=i[qt],u=s.firstCreatePass?mP(o,s,i,e,n,r):s.data[o],l=yP(s,i,u,a,e,t);i[o]=l;let f=wI(u);return pu(u,!0),mE(a,l,u),!gP(u)&&LI()&&fE(s,i,l,u),YR()===0&&Qi(l,i),JR(),f&&(cx(s,i,u),IE(s,u,i)),r!==null&&ux(i,u),Po}function Mo(){let t=Rn();RI()?rN():(t=t.parent,pu(t,!1));let e=t;eN(e)&&tN(),XR();let n=fu();return n.firstCreatePass&&(UI(n,t),vI(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&pN(e)&&Ww(n,e,Nt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&gN(e)&&Ww(n,e,Nt(),e.stylesWithoutHost,!1),Mo}function xf(t,e,n,r){return Po(t,e,n,r),Mo(),xf}var yP=(t,e,n,r,i,s)=>(VI(!0),cE(r,i,lN()));var iu="en-US";var _P=iu;function vP(t){typeof t=="string"&&(_P=t.toLowerCase().replace(/_/g,"-"))}function wu(t,e,n,r){let i=Nt(),s=fu(),o=Rn();return IP(s,i,i[qt],o,t,e,r),wu}function wP(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[wo],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function IP(t,e,n,r,i,s,o){let a=wI(r),l=t.firstCreatePass&&xx(t),f=e[Cn],p=Nx(e),m=!0;if(r.type&3||o){let R=nn(r,e),x=o?o(R):R,V=p.length,K=o?de=>o(Dn(de[r.index])):r.index,B=null;if(!o&&a&&(B=wP(t,e,i,r.index)),B!==null){let de=B.__ngLastListenerFn__||B;de.__ngNextListenerFn__=s,B.__ngLastListenerFn__=s,m=!1}else{s=Kw(r,e,f,s,!1);let de=n.listen(x,i,s);p.push(s,de),l&&l.push(i,K,V,V+1)}}else s=Kw(r,e,f,s,!1);let D=r.outputs,A;if(m&&D!==null&&(A=D[i])){let R=A.length;if(R)for(let x=0;x<R;x+=2){let V=A[x],K=A[x+1],We=e[V][K].subscribe(s),he=p.length;p.push(s,We),l&&l.push(i,r.index,he,-(he+1))}}}function Gw(t,e,n,r){let i=ge(null);try{return Jt(6,e,n),n(r)!==!1}catch(s){return SE(t,s),!1}finally{Jt(7,e,n),ge(i)}}function Kw(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Ji(t.index,e):e;Af(a);let u=Gw(e,n,r,o),l=s.__ngNextListenerFn__;for(;l;)u=Gw(e,n,l,o)&&u,l=l.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function Pf(t,e=""){let n=Nt(),r=fu(),i=t+Mr,s=r.firstCreatePass?bf(r,i,1,e,null):r.data[i],o=EP(r,n,s,e,t);n[i]=o,LI()&&fE(r,n,o,s),pu(s,!1)}var EP=(t,e,n,r,i)=>(VI(!0),jN(e[qt],r));var TP=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=pI(!1,r.type),s=i.length>0?Nf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=z({token:e,providedIn:"environment",factory:()=>new e(Z(Rt))});let t=e;return t})();function Iu(t){FE("NgStandalone"),t.getStandaloneInjector=e=>e.get(TP).getOrCreateStandaloneInjector(t)}var nr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},UE=new nr("17.3.10"),Eu=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var jE=new G("");function ko(t){return!!t&&typeof t.then=="function"}function BE(t){return!!t&&typeof t.subscribe=="function"}var $E=new G(""),HE=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=O($E,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(ko(o))r.push(o);else if(BE(o)){let a=new Promise((u,l)=>{o.subscribe({complete:u,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Mf=new G("");function CP(){jv(()=>{throw new $(600,!1)})}function DP(t){return t.isBoundToModule}function bP(t,e,n){try{let r=n();return ko(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var Oo=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=O(XI),this.afterRenderEffectManager=O(LE),this.externalTestViews=new Set,this.beforeRender=new lt,this.afterTick=new lt,this.componentTypes=[],this.components=[],this.isStable=O(vu).hasPendingTasks.pipe(ie(r=>!r)),this._injector=O(Rt)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof tu;if(!this._injector.get(HE).done){let D=!s&&lI(r),A=!1;throw new $(405,A)}let a;s?a=r:a=this._injector.get(yu).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=DP(a)?void 0:this._injector.get(tr),l=i||a.selector,f=a.create(vt.NULL,[],l,u),p=f.location.nativeElement,m=f.injector.get(jE,null);return m?.registerApplication(p),f.onDestroy(()=>{this.detachView(f.hostView),wh(this.components,f),m?.unregisterApplication(p)}),this._loadComponent(f),f}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new $(101,!1);let i=ge(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,ge(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===xE)throw new $(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:u}of this._views)SP(a,o,u)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Jh(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Jh(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;wh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(Mf,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>wh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new $(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function wh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function SP(t,e,n){!e&&!Jh(t)||AP(t,n,e)}function Jh(t){return hf(t)}function AP(t,e,n){let r;n?(r=0,t[q]|=1024):t[q]&64?r=0:r=1,PE(t,e,r)}var Xh=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},kf=(()=>{let e=class e{compileModuleSync(r){return new Yh(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=dI(r),o=aE(s.declarations).reduce((a,u)=>{let l=xr(u);return l&&a.push(new So(l)),a},[]);return new Xh(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var RP=(()=>{let e=class e{constructor(){this.zone=O(fe),this.applicationRef=O(Oo)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function NP(t){return[{provide:fe,useFactory:t},{provide:Gi,multi:!0,useFactory:()=>{let e=O(RP,{optional:!0});return()=>e.initialize()}},{provide:Gi,multi:!0,useFactory:()=>{let e=O(kP);return()=>{e.initialize()}}},{provide:XI,useFactory:xP}]}function xP(){let t=O(fe),e=O(bn);return n=>t.runOutsideAngular(()=>e.handleError(n))}function PP(t){let e=NP(()=>new fe(MP(t)));return xt([[],e])}function MP(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var kP=(()=>{let e=class e{constructor(){this.subscription=new Re,this.initialized=!1,this.zone=O(fe),this.pendingTasks=O(vu)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{fe.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{fe.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function OP(){return typeof $localize<"u"&&$localize.locale||iu}var Of=new G("",{providedIn:"root",factory:()=>O(Of,Y.Optional|Y.SkipSelf)||OP()});var qE=new G("");var Hc=null;function FP(t=[],e){return vt.create({name:e,providers:[{provide:uu,useValue:"platform"},{provide:qE,useValue:new Set([()=>Hc=null])},...t]})}function LP(t=[]){if(Hc)return Hc;let e=FP(t);return Hc=e,CP(),VP(e),e}function VP(t){t.get(vf,null)?.forEach(n=>n())}var Fo=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=UP;let t=e;return t})();function UP(t){return jP(Rn(),Nt(),(t&16)===16)}function jP(t,e,n){if(lf(t)&&!n){let r=Ji(t.index,e);return new Yi(r,r)}else if(t.type&47){let r=e[tn];return new Yi(r,e)}return null}function zE(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,i=LP(r),s=[PP(),...n||[]],a=new ru({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,u=a.get(fe);return u.run(()=>{a.resolveInjectorInitializers();let l=a.get(bn,null),f;u.runOutsideAngular(()=>{f=u.onError.subscribe({next:D=>{l.handleError(D)}})});let p=()=>a.destroy(),m=i.get(qE);return m.add(p),a.onDestroy(()=>{f.unsubscribe(),m.delete(p)}),bP(l,u,()=>{let D=a.get(HE);return D.runInitializers(),D.donePromise.then(()=>{let A=a.get(Of,iu);vP(A||iu);let R=a.get(Oo);return e!==void 0&&R.bootstrap(e),R})})})}catch(e){return Promise.reject(e)}}var JE=null;function Xi(){return JE}function XE(t){JE??=t}var Tu=class{};var Pt=new G(""),ZE=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>O(zP),providedIn:"platform"});let t=e;return t})();var zP=(()=>{let e=class e extends ZE{constructor(){super(),this._doc=O(Pt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Xi().getBaseHref(this._doc)}onPopState(r){let i=Xi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=Xi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function eT(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function WE(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Vr(t){return t&&t[0]!=="?"?"?"+t:t}var Du=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>O(tT),providedIn:"root"});let t=e;return t})(),WP=new G(""),tT=(()=>{let e=class e extends Du{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??O(Pt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return eT(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Vr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Vr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Vr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(Z(ZE),Z(WP,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Vo=(()=>{let e=class e{constructor(r){this._subject=new $t,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=QP(WE(GE(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Vr(i))}normalize(r){return e.stripTrailingSlash(KP(this._basePath,GE(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Vr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Vr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Vr,e.joinWithSlash=eT,e.stripTrailingSlash=WE,e.\u0275fac=function(i){return new(i||e)(Z(Du))},e.\u0275prov=z({token:e,factory:()=>GP(),providedIn:"root"});let t=e;return t})();function GP(){return new Vo(Z(Du))}function KP(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function GE(t){return t.replace(/\/index.html$/,"")}function QP(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function nT(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var rT="browser",YP="server";function Ff(t){return t===YP}var Cu=class{};var Uf=class extends Tu{constructor(){super(...arguments),this.supportsDOMEvents=!0}},jf=class t extends Uf{static makeCurrent(){XE(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=JP();return n==null?null:XP(n)}resetBaseElement(){Uo=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return nT(document.cookie,e)}},Uo=null;function JP(){return Uo=Uo||document.querySelector("base"),Uo?Uo.getAttribute("href"):null}function XP(t){return new URL(t,document.baseURI).pathname}var ZP=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),Bf=new G(""),aT=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(Z(Bf),Z(fe))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),bu=class{constructor(e){this._doc=e}},Lf="ng-app-id",cT=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ff(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Lf}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Lf),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Lf,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(Z(Pt),Z(_f),Z(wf,8),Z(rr))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),Vf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Hf=/%COMP%/g,uT="%COMP%",eM=`_nghost-${uT}`,tM=`_ngcontent-${uT}`,nM=!0,rM=new G("",{providedIn:"root",factory:()=>nM});function iM(t){return tM.replace(Hf,t)}function sM(t){return eM.replace(Hf,t)}function lT(t,e){return e.map(n=>n.replace(Hf,t))}var iT=(()=>{let e=class e{constructor(r,i,s,o,a,u,l,f=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=Ff(u),this.defaultRenderer=new jo(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Zt.ShadowDom&&(i=Ae(F({},i),{encapsulation:Zt.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Su?s.applyToHost(r):s instanceof Bo&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case Zt.Emulated:o=new Su(l,f,i,this.appId,p,a,u,m);break;case Zt.ShadowDom:return new $f(l,f,r,i,a,u,this.nonce,m);default:o=new Bo(l,f,i,p,a,u,m);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(Z(aT),Z(cT),Z(_f),Z(rM),Z(Pt),Z(rr),Z(fe),Z(wf))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),jo=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Vf[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(sT(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(sT(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Vf[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Vf[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Lr.DashCase|Lr.Important)?e.style.setProperty(n,r,i&Lr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Lr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=Xi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function sT(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var $f=class extends jo{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=lT(i.id,i.styles);for(let f of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=f,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Bo=class extends jo{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?lT(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Su=class extends Bo{constructor(e,n,r,i,s,o,a,u){let l=i+"-"+r.id;super(e,n,r,s,o,a,u,l),this.contentAttr=iM(l),this.hostAttr=sM(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},oM=(()=>{let e=class e extends bu{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(Z(Pt))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})(),oT=["alt","control","meta","shift"],aM={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},cM={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},uM=(()=>{let e=class e extends bu{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Xi().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),oT.forEach(f=>{let p=i.indexOf(f);p>-1&&(i.splice(p,1),a+=f+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=aM[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),oT.forEach(a=>{if(a!==s){let u=cM[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(Z(Pt))},e.\u0275prov=z({token:e,factory:e.\u0275fac});let t=e;return t})();function dT(t,e){return zE(F({rootComponent:t},lM(e)))}function lM(t){return{appProviders:[...gM,...t?.providers??[]],platformProviders:pM}}function dM(){jf.makeCurrent()}function hM(){return new bn}function fM(){return sE(document),document}var pM=[{provide:rr,useValue:rT},{provide:vf,useValue:dM,multi:!0},{provide:Pt,useFactory:fM,deps:[]}];var gM=[{provide:uu,useValue:"root"},{provide:bn,useFactory:hM,deps:[]},{provide:Bf,useClass:oM,multi:!0,deps:[Pt,fe,rr]},{provide:Bf,useClass:uM,multi:!0,deps:[Pt]},iT,cT,aT,{provide:bo,useExisting:iT},{provide:Cu,useClass:ZP,deps:[]},[]];var hT=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(Z(Pt))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Q="primary",na=Symbol("RouteTitle"),Kf=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function rs(t){return new Kf(t)}function yM(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function _M(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!rn(t[n],e[n]))return!1;return!0}function rn(t,e){let n=t?Qf(t):void 0,r=e?Qf(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!_T(t[i],e[i]))return!1;return!0}function Qf(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function _T(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function vT(t){return t.length>0?t[t.length-1]:null}function or(t){return ih(t)?t:ko(t)?ke(Promise.resolve(t)):W(t)}var vM={exact:IT,subset:ET},wT={exact:wM,subset:IM,ignored:()=>!0};function fT(t,e,n){return vM[n.paths](t.root,e.root,n.matrixParams)&&wT[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function wM(t,e){return rn(t,e)}function IT(t,e,n){if(!jr(t.segments,e.segments)||!Nu(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!IT(t.children[r],e.children[r],n))return!1;return!0}function IM(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>_T(t[n],e[n]))}function ET(t,e,n){return TT(t,e,e.segments,n)}function TT(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!jr(i,n)||e.hasChildren()||!Nu(i,n,r))}else if(t.segments.length===n.length){if(!jr(t.segments,n)||!Nu(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!ET(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!jr(t.segments,i)||!Nu(t.segments,i,r)||!t.children[Q]?!1:TT(t.children[Q],e,s,r)}}function Nu(t,e,n){return e.every((r,i)=>wT[n](t[i].parameters,r.parameters))}var ir=class{constructor(e=new pe([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=rs(this.queryParams),this._queryParamMap}toString(){return CM.serialize(this)}},pe=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return xu(this)}},Ur=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=rs(this.parameters),this._parameterMap}toString(){return DT(this)}};function EM(t,e){return jr(t,e)&&t.every((n,r)=>rn(n.parameters,e[r].parameters))}function jr(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function TM(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===Q&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==Q&&(n=n.concat(e(i,r)))}),n}var Ip=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>new Mu,providedIn:"root"});let t=e;return t})(),Mu=class{parse(e){let n=new Jf(e);return new ir(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${$o(e.root,!0)}`,r=SM(e.queryParams),i=typeof e.fragment=="string"?`#${DM(e.fragment)}`:"";return`${n}${r}${i}`}},CM=new Mu;function xu(t){return t.segments.map(e=>DT(e)).join("/")}function $o(t,e){if(!t.hasChildren())return xu(t);if(e){let n=t.children[Q]?$o(t.children[Q],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==Q&&r.push(`${i}:${$o(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=TM(t,(r,i)=>i===Q?[$o(t.children[Q],!1)]:[`${i}:${$o(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[Q]!=null?`${xu(t)}/${n[0]}`:`${xu(t)}/(${n.join("//")})`}}function CT(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Au(t){return CT(t).replace(/%3B/gi,";")}function DM(t){return encodeURI(t)}function Yf(t){return CT(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Pu(t){return decodeURIComponent(t)}function pT(t){return Pu(t.replace(/\+/g,"%20"))}function DT(t){return`${Yf(t.path)}${bM(t.parameters)}`}function bM(t){return Object.entries(t).map(([e,n])=>`;${Yf(e)}=${Yf(n)}`).join("")}function SM(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Au(n)}=${Au(i)}`).join("&"):`${Au(n)}=${Au(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var AM=/^[^\/()?;#]+/;function qf(t){let e=t.match(AM);return e?e[0]:""}var RM=/^[^\/()?;=#]+/;function NM(t){let e=t.match(RM);return e?e[0]:""}var xM=/^[^=?&#]+/;function PM(t){let e=t.match(xM);return e?e[0]:""}var MM=/^[^&#]+/;function kM(t){let e=t.match(MM);return e?e[0]:""}var Jf=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new pe([],{}):new pe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[Q]=new pe(e,n)),r}parseSegment(){let e=qf(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new Ur(Pu(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=NM(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=qf(this.remaining);i&&(r=i,this.capture(r))}e[Pu(n)]=Pu(r)}parseQueryParam(e){let n=PM(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=kM(this.remaining);o&&(r=o,this.capture(r))}let i=pT(n),s=pT(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=qf(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Q);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[Q]:new pe([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function bT(t){return t.segments.length>0?new pe([],{[Q]:t}):t}function ST(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=ST(i);if(r===Q&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new pe(t.segments,e);return OM(n)}function OM(t){if(t.numberOfChildren===1&&t.children[Q]){let e=t.children[Q];return new pe(t.segments.concat(e.segments),e.children)}return t}function is(t){return t instanceof ir}function FM(t,e,n=null,r=null){let i=AT(t);return RT(i,e,n,r)}function AT(t){let e;function n(s){let o={};for(let u of s.children){let l=n(u);o[u.outlet]=l}let a=new pe(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=bT(r);return e??i}function RT(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return zf(i,i,i,n,r);let s=LM(e);if(s.toRoot())return zf(i,i,new pe([],{}),n,r);let o=VM(s,i,t),a=o.processChildren?zo(o.segmentGroup,o.index,s.commands):xT(o.segmentGroup,o.index,s.commands);return zf(i,o.segmentGroup,a,n,r)}function ku(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Ko(t){return typeof t=="object"&&t!=null&&t.outlets}function zf(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,l])=>{s[u]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`});let o;t===e?o=n:o=NT(t,e,n);let a=bT(ST(o));return new ir(a,s,i)}function NT(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=NT(s,e,n)}),new pe(t.segments,r)}var Ou=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&ku(r[0]))throw new $(4003,!1);let i=r.find(Ko);if(i&&i!==vT(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function LM(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Ou(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,l])=>{a[u]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Ou(n,e,r)}var ts=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function VM(t,e,n){if(t.isAbsolute)return new ts(e,!0,0);if(!n)return new ts(e,!1,NaN);if(n.parent===null)return new ts(n,!0,0);let r=ku(t.commands[0])?0:1,i=n.segments.length-1+r;return UM(n,i,t.numberOfDoubleDots)}function UM(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new ts(r,!1,i-s)}function jM(t){return Ko(t[0])?t[0].outlets:{[Q]:t}}function xT(t,e,n){if(t??=new pe([],{}),t.segments.length===0&&t.hasChildren())return zo(t,e,n);let r=BM(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new pe(t.segments.slice(0,r.pathIndex),{});return s.children[Q]=new pe(t.segments.slice(r.pathIndex),t.children),zo(s,0,i)}else return r.match&&i.length===0?new pe(t.segments,{}):r.match&&!t.hasChildren()?Xf(t,e,n):r.match?zo(t,0,i):Xf(t,e,n)}function zo(t,e,n){if(n.length===0)return new pe(t.segments,{});{let r=jM(n),i={};if(Object.keys(r).some(s=>s!==Q)&&t.children[Q]&&t.numberOfChildren===1&&t.children[Q].segments.length===0){let s=zo(t.children[Q],e,n);return new pe(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=xT(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new pe(t.segments,i)}}function BM(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Ko(a))break;let u=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&l&&typeof l=="object"&&l.outlets===void 0){if(!mT(u,l,o))return s;r+=2}else{if(!mT(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Xf(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Ko(s)){let u=$M(s.outlets);return new pe(r,u)}if(i===0&&ku(n[0])){let u=t.segments[e];r.push(new Ur(u.path,gT(n[0]))),i++;continue}let o=Ko(s)?s.outlets[Q]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&ku(a)?(r.push(new Ur(o,gT(a))),i+=2):(r.push(new Ur(o,{})),i++)}return new pe(r,{})}function $M(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Xf(new pe([],{}),0,r))}),e}function gT(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function mT(t,e,n){return t==n.path&&rn(e,n.parameters)}var Wo="imperative",Qe=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Qe||{}),Mt=class{constructor(e,n){this.id=e,this.url=n}},Qo=class extends Mt{constructor(e,n,r="imperative",i=null){super(e,n),this.type=Qe.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Br=class extends Mt{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=Qe.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},It=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(It||{}),Zf=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Zf||{}),sr=class extends Mt{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Qe.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},$r=class extends Mt{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Qe.NavigationSkipped}},Yo=class extends Mt{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=Qe.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Fu=class extends Mt{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Qe.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ep=class extends Mt{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Qe.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},tp=class extends Mt{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Qe.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},np=class extends Mt{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Qe.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},rp=class extends Mt{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Qe.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ip=class{constructor(e){this.route=e,this.type=Qe.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},sp=class{constructor(e){this.route=e,this.type=Qe.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},op=class{constructor(e){this.snapshot=e,this.type=Qe.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ap=class{constructor(e){this.snapshot=e,this.type=Qe.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},cp=class{constructor(e){this.snapshot=e,this.type=Qe.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},up=class{constructor(e){this.snapshot=e,this.type=Qe.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Jo=class{},Xo=class{constructor(e){this.url=e}};var lp=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new $u,this.attachRef=null}},$u=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new lp,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Lu=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=dp(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=dp(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=hp(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return hp(e,this._root).map(n=>n.value)}};function dp(t,e){if(t===e.value)return e;for(let n of e.children){let r=dp(t,n);if(r)return r}return null}function hp(t,e){if(t===e.value)return[e];for(let n of e.children){let r=hp(t,n);if(r.length)return r.unshift(e),r}return[]}var wt=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function es(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Vu=class extends Lu{constructor(e,n){super(e),this.snapshot=n,Tp(this,e)}toString(){return this.snapshot.toString()}};function PT(t){let e=HM(t),n=new Ke([new Ur("",{})]),r=new Ke({}),i=new Ke({}),s=new Ke({}),o=new Ke(""),a=new ss(n,r,s,o,i,Q,t,e.root);return a.snapshot=e.root,new Vu(new wt(a,[]),e)}function HM(t){let e={},n={},r={},i="",s=new Zo([],e,r,i,n,Q,t,null,{});return new Uu("",new wt(s,[]))}var ss=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(ie(l=>l[na]))??W(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ie(e=>rs(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ie(e=>rs(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ep(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:F(F({},e.params),t.params),data:F(F({},e.data),t.data),resolve:F(F(F(F({},t.data),e.data),i?.data),t._resolvedData)}:r={params:F({},t.params),data:F({},t.data),resolve:F(F({},t.data),t._resolvedData??{})},i&&kT(i)&&(r.resolve[na]=i.title),r}var Zo=class{get title(){return this.data?.[na]}constructor(e,n,r,i,s,o,a,u,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=rs(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=rs(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Uu=class extends Lu{constructor(e,n){super(n),this.url=e,Tp(this,n)}toString(){return MT(this._root)}};function Tp(t,e){e.value._routerState=t,e.children.forEach(n=>Tp(t,n))}function MT(t){let e=t.children.length>0?` { ${t.children.map(MT).join(", ")} } `:"";return`${t.value}${e}`}function Wf(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,rn(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),rn(e.params,n.params)||t.paramsSubject.next(n.params),_M(e.url,n.url)||t.urlSubject.next(n.url),rn(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function fp(t,e){let n=rn(t.params,e.params)&&EM(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||fp(t.parent,e.parent))}function kT(t){return typeof t.title=="string"||t.title===null}var qM=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Q,this.activateEvents=new $t,this.deactivateEvents=new $t,this.attachEvents=new $t,this.detachEvents=new $t,this.parentContexts=O($u),this.location=O(_u),this.changeDetector=O(Fo),this.environmentInjector=O(Rt),this.inputBinder=O(Cp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,l=new pp(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=sf({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[hu]});let t=e;return t})(),pp=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===ss?this.route:e===$u?this.childContexts:this.parent.get(e,n)}},Cp=new G("");function zM(t,e,n){let r=ea(t,e._root,n?n._root:void 0);return new Vu(r,e)}function ea(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=WM(t,e,n);return new wt(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>ea(t,a)),o}}let r=GM(e.value),i=e.children.map(s=>ea(t,s));return new wt(r,i)}}function WM(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return ea(t,r,i);return ea(t,r)})}function GM(t){return new ss(new Ke(t.url),new Ke(t.params),new Ke(t.queryParams),new Ke(t.fragment),new Ke(t.data),t.outlet,t.component,t)}var OT="ngNavigationCancelingError";function FT(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=is(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=LT(!1,It.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function LT(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[OT]=!0,n.cancellationCode=e,n}function KM(t){return VT(t)&&is(t.url)}function VT(t){return!!t&&t[OT]}var QM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=cu({type:e,selectors:[["ng-component"]],standalone:!0,features:[Iu],decls:1,vars:0,template:function(i,s){i&1&&xf(0,"router-outlet")},dependencies:[qM],encapsulation:2});let t=e;return t})();function YM(t,e){return t.providers&&!t._injector&&(t._injector=Nf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Dp(t){let e=t.children&&t.children.map(Dp),n=e?Ae(F({},t),{children:e}):F({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==Q&&(n.component=QM),n}function sn(t){return t.outlet||Q}function JM(t,e){let n=t.filter(r=>sn(r)===e);return n.push(...t.filter(r=>sn(r)!==e)),n}function ra(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var XM=(t,e,n,r)=>ie(i=>(new gp(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),gp=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Wf(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=es(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=es(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=es(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=es(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new up(s.value.snapshot))}),e.children.length&&this.forwardEvent(new ap(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Wf(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Wf(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=ra(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},ju=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ns=class{constructor(e,n){this.component=e,this.route=n}};function ZM(t,e,n){let r=t._root,i=e?e._root:null;return Ho(r,i,n,[r.value])}function ek(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function as(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!Jw(t)?t:e.get(t):r}function Ho(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=es(e);return t.children.forEach(o=>{tk(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Go(a,n.getContext(o),i)),i}function tk(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=nk(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new ju(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Ho(t,e,a?a.children:null,r,i):Ho(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ns(a.outlet.component,o))}else o&&Go(e,a,i),i.canActivateChecks.push(new ju(r)),s.component?Ho(t,null,a?a.children:null,r,i):Ho(t,null,n,r,i);return i}function nk(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!jr(t.url,e.url);case"pathParamsOrQueryParamsChange":return!jr(t.url,e.url)||!rn(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!fp(t,e)||!rn(t.queryParams,e.queryParams);case"paramsChange":default:return!fp(t,e)}}function Go(t,e,n){let r=es(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Go(o,e.children.getContext(s),n):Go(o,null,n):Go(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ns(e.outlet.component,i)):n.canDeactivateChecks.push(new ns(null,i)):n.canDeactivateChecks.push(new ns(null,i))}function ia(t){return typeof t=="function"}function rk(t){return typeof t=="boolean"}function ik(t){return t&&ia(t.canLoad)}function sk(t){return t&&ia(t.canActivate)}function ok(t){return t&&ia(t.canActivateChild)}function ak(t){return t&&ia(t.canDeactivate)}function ck(t){return t&&ia(t.canMatch)}function UT(t){return t instanceof En||t?.name==="EmptyError"}var Ru=Symbol("INITIAL_VALUE");function os(){return jt(t=>Oc(t.map(e=>e.pipe(Tn(1),uh(Ru)))).pipe(ie(e=>{for(let n of e)if(n!==!0){if(n===Ru)return Ru;if(n===!1||n instanceof ir)return n}return!0}),Ut(e=>e!==Ru),Tn(1)))}function uk(t,e){return Oe(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?W(Ae(F({},n),{guardsResult:!0})):lk(o,r,i,t).pipe(Oe(a=>a&&rk(a)?dk(r,s,t,e):W(a)),ie(a=>Ae(F({},n),{guardsResult:a})))})}function lk(t,e,n,r){return ke(t).pipe(Oe(i=>mk(i.component,i.route,n,e,r)),Yt(i=>i!==!0,!0))}function dk(t,e,n,r){return ke(e).pipe(Li(i=>Fi(fk(i.route.parent,r),hk(i.route,r),gk(t,i.path,n),pk(t,i.route,n))),Yt(i=>i!==!0,!0))}function hk(t,e){return t!==null&&e&&e(new cp(t)),W(!0)}function fk(t,e){return t!==null&&e&&e(new op(t)),W(!0)}function pk(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return W(!0);let i=r.map(s=>Fc(()=>{let o=ra(e)??n,a=as(s,o),u=sk(a)?a.canActivate(e,t):Fr(o,()=>a(e,t));return or(u).pipe(Yt())}));return W(i).pipe(os())}function gk(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>ek(o)).filter(o=>o!==null).map(o=>Fc(()=>{let a=o.guards.map(u=>{let l=ra(o.node)??n,f=as(u,l),p=ok(f)?f.canActivateChild(r,t):Fr(l,()=>f(r,t));return or(p).pipe(Yt())});return W(a).pipe(os())}));return W(s).pipe(os())}function mk(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return W(!0);let o=s.map(a=>{let u=ra(e)??i,l=as(a,u),f=ak(l)?l.canDeactivate(t,e,n,r):Fr(u,()=>l(t,e,n,r));return or(f).pipe(Yt())});return W(o).pipe(os())}function yk(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return W(!0);let s=i.map(o=>{let a=as(o,t),u=ik(a)?a.canLoad(e,n):Fr(t,()=>a(e,n));return or(u)});return W(s).pipe(os(),jT(r))}function jT(t){return Yd(Fe(e=>{if(is(e))throw FT(t,e)}),ie(e=>e===!0))}function _k(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return W(!0);let s=i.map(o=>{let a=as(o,t),u=ck(a)?a.canMatch(e,n):Fr(t,()=>a(e,n));return or(u)});return W(s).pipe(os(),jT(r))}var ta=class{constructor(e){this.segmentGroup=e||null}},Bu=class extends Error{constructor(e){super(),this.urlTree=e}};function Zi(t){return Oi(new ta(t))}function vk(t){return Oi(new $(4e3,!1))}function wk(t){return Oi(LT(!1,It.GuardRejected))}var mp=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return W(r);if(i.numberOfChildren>1||!i.children[Q])return vk(e.redirectTo);i=i.children[Q]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Bu(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new ir(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new pe(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},yp={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ik(t,e,n,r,i){let s=bp(t,e,n);return s.matched?(r=YM(e,r),_k(r,e,n,i).pipe(ie(o=>o===!0?s:F({},yp)))):W(s)}function bp(t,e,n){if(e.path==="**")return Ek(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?F({},yp):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||yM)(n,t,e);if(!i)return F({},yp);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?F(F({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function Ek(t){return{matched:!0,parameters:t.length>0?vT(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function yT(t,e,n,r){return n.length>0&&Dk(t,n,r)?{segmentGroup:new pe(e,Ck(r,new pe(n,t.children))),slicedSegments:[]}:n.length===0&&bk(t,n,r)?{segmentGroup:new pe(t.segments,Tk(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new pe(t.segments,t.children),slicedSegments:n}}function Tk(t,e,n,r){let i={};for(let s of n)if(Hu(t,e,s)&&!r[sn(s)]){let o=new pe([],{});i[sn(s)]=o}return F(F({},r),i)}function Ck(t,e){let n={};n[Q]=e;for(let r of t)if(r.path===""&&sn(r)!==Q){let i=new pe([],{});n[sn(r)]=i}return n}function Dk(t,e,n){return n.some(r=>Hu(t,e,r)&&sn(r)!==Q)}function bk(t,e,n){return n.some(r=>Hu(t,e,r))}function Hu(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function Sk(t,e,n,r){return sn(t)!==r&&(r===Q||!Hu(e,n,t))?!1:bp(e,t,n).matched}function Ak(t,e,n){return e.length===0&&!t.children[n]}var _p=class{};function Rk(t,e,n,r,i,s,o="emptyOnly"){return new vp(t,e,n,r,i,o,s).recognize()}var Nk=31,vp=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new mp(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}recognize(){let e=yT(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ie(n=>{let r=new Zo([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,{},Q,this.rootComponentType,null,{}),i=new wt(r,n),s=new Uu("",i),o=FM(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,Q).pipe(Yn(r=>{if(r instanceof Bu)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ta?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=Ep(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(ie(s=>s instanceof wt?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ke(i).pipe(Li(s=>{let o=r.children[s],a=JM(n,s);return this.processSegmentGroup(e,a,o,s)}),ch((s,o)=>(s.push(...o),s)),Jn(null),ah(),Oe(s=>{if(s===null)return Zi(r);let o=BT(s);return xk(o),W(o)}))}processSegment(e,n,r,i,s,o){return ke(n).pipe(Li(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Yn(u=>{if(u instanceof ta)return W(null);throw u}))),Yt(a=>!!a),Yn(a=>{if(UT(a))return Ak(r,i,s)?W(new _p):Zi(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return Sk(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Zi(i):Zi(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:l,remainingSegments:f}=bp(n,i,s);if(!a)return Zi(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Nk&&(this.allowRedirects=!1));let p=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,p).pipe(Oe(m=>this.processSegment(e,r,n,m.concat(f),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=Ik(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(jt(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(jt(({routes:u})=>{let l=r._loadedInjector??e,{consumedSegments:f,remainingSegments:p,parameters:m}=a,D=new Zo(f,m,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Mk(r),sn(r),r.component??r._loadedComponent??null,r,kk(r)),{segmentGroup:A,slicedSegments:R}=yT(n,f,p,u);if(R.length===0&&A.hasChildren())return this.processChildren(l,u,A).pipe(ie(V=>V===null?null:new wt(D,V)));if(u.length===0&&R.length===0)return W(new wt(D,[]));let x=sn(r)===s;return this.processSegment(l,u,A,R,x?Q:s,!0).pipe(ie(V=>new wt(D,V instanceof wt?[V]:[])))}))):Zi(n)))}getChildConfig(e,n,r){return n.children?W({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?W({routes:n._loadedRoutes,injector:n._loadedInjector}):yk(e,n,r,this.urlSerializer).pipe(Oe(i=>i?this.configLoader.loadChildren(e,n).pipe(Fe(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):wk(n))):W({routes:[],injector:e})}};function xk(t){t.sort((e,n)=>e.value.outlet===Q?-1:n.value.outlet===Q?1:e.value.outlet.localeCompare(n.value.outlet))}function Pk(t){let e=t.value.routeConfig;return e&&e.path===""}function BT(t){let e=[],n=new Set;for(let r of t){if(!Pk(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=BT(r.children);e.push(new wt(r.value,i))}return e.filter(r=>!n.has(r))}function Mk(t){return t.data||{}}function kk(t){return t.resolve||{}}function Ok(t,e,n,r,i,s){return Oe(o=>Rk(t,e,n,r,o.extractedUrl,i,s).pipe(ie(({state:a,tree:u})=>Ae(F({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function Fk(t,e){return Oe(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return W(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let l of $T(u))o.add(l);let a=0;return ke(o).pipe(Li(u=>s.has(u)?Lk(u,r,t,e):(u.data=Ep(u,u.parent,t).resolve,W(void 0))),Fe(()=>a++),Vi(1),Oe(u=>a===o.size?W(n):yt))})}function $T(t){let e=t.children.map(n=>$T(n)).flat();return[t,...e]}function Lk(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!kT(i)&&(s[na]=i.title),Vk(s,t,e,r).pipe(ie(o=>(t._resolvedData=o,t.data=Ep(t,t.parent,n).resolve,null)))}function Vk(t,e,n,r){let i=Qf(t);if(i.length===0)return W({});let s={};return ke(i).pipe(Oe(o=>Uk(t[o],e,n,r).pipe(Yt(),Fe(a=>{s[o]=a}))),Vi(1),oh(s),Yn(o=>UT(o)?yt:Oi(o)))}function Uk(t,e,n,r){let i=ra(e)??r,s=as(t,i),o=s.resolve?s.resolve(e,n):Fr(i,()=>s(e,n));return or(o)}function Gf(t){return jt(e=>{let n=t(e);return n?ke(n).pipe(ie(()=>e)):W(e)})}var HT=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===Q);return i}getResolvedTitleForRoute(r){return r.data[na]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>O(jk),providedIn:"root"});let t=e;return t})(),jk=(()=>{let e=class e extends HT{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(Z(hT))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Sp=new G("",{providedIn:"root",factory:()=>({})}),Ap=new G(""),Bk=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=O(kf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return W(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=or(r.loadComponent()).pipe(ie(qT),Fe(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),po(()=>{this.componentLoaders.delete(r)})),s=new xi(i,()=>new lt).pipe(Ni());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return W({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=$k(i,this.compiler,r,this.onLoadEndListener).pipe(po(()=>{this.childrenLoaders.delete(i)})),a=new xi(o,()=>new lt).pipe(Ni());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function $k(t,e,n,r){return or(t.loadChildren()).pipe(ie(qT),Oe(i=>i instanceof Ao||Array.isArray(i)?W(i):ke(e.compileModuleAsync(i))),ie(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Ap,[],{optional:!0,self:!0}).flat()),{routes:o.map(Dp),injector:s}}))}function Hk(t){return t&&typeof t=="object"&&"default"in t}function qT(t){return Hk(t)?t.default:t}var Rp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>O(qk),providedIn:"root"});let t=e;return t})(),qk=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),zk=new G("");var Wk=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new lt,this.transitionAbortSubject=new lt,this.configLoader=O(Bk),this.environmentInjector=O(Rt),this.urlSerializer=O(Ip),this.rootContexts=O($u),this.location=O(Vo),this.inputBindingEnabled=O(Cp,{optional:!0})!==null,this.titleStrategy=O(HT),this.options=O(Sp,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=O(Rp),this.createViewTransition=O(zk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>W(void 0),this.rootComponentType=null;let r=s=>this.events.next(new ip(s)),i=s=>this.events.next(new sp(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Ae(F(F({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Ke({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Wo,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ut(o=>o.id!==0),ie(o=>Ae(F({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),jt(o=>{let a=!1,u=!1;return W(o).pipe(jt(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",It.SupersededByNewNavigation),yt;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Ae(F({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let f=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!f&&p!=="reload"){let m="";return this.events.next(new $r(l.id,this.urlSerializer.serialize(l.rawUrl),m,Zf.IgnoredSameUrlNavigation)),l.resolve(null),yt}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return W(l).pipe(jt(m=>{let D=this.transitions?.getValue();return this.events.next(new Qo(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),D!==this.transitions?.getValue()?yt:Promise.resolve(m)}),Ok(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Fe(m=>{o.targetSnapshot=m.targetSnapshot,o.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=Ae(F({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let D=new Fu(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(D)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:D,source:A,restoredState:R,extras:x}=l,V=new Qo(m,this.urlSerializer.serialize(D),A,R);this.events.next(V);let K=PT(this.rootComponentType).snapshot;return this.currentTransition=o=Ae(F({},l),{targetSnapshot:K,urlAfterRedirects:D,extras:Ae(F({},x),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=D,W(o)}else{let m="";return this.events.next(new $r(l.id,this.urlSerializer.serialize(l.extractedUrl),m,Zf.IgnoredByUrlHandlingStrategy)),l.resolve(null),yt}}),Fe(l=>{let f=new ep(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(f)}),ie(l=>(this.currentTransition=o=Ae(F({},l),{guards:ZM(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),uk(this.environmentInjector,l=>this.events.next(l)),Fe(l=>{if(o.guardsResult=l.guardsResult,is(l.guardsResult))throw FT(this.urlSerializer,l.guardsResult);let f=new tp(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(f)}),Ut(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",It.GuardRejected),!1)),Gf(l=>{if(l.guards.canActivateChecks.length)return W(l).pipe(Fe(f=>{let p=new np(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(p)}),jt(f=>{let p=!1;return W(f).pipe(Fk(this.paramsInheritanceStrategy,this.environmentInjector),Fe({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(f,"",It.NoDataFromResolver)}}))}),Fe(f=>{let p=new rp(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(p)}))}),Gf(l=>{let f=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(Fe(D=>{p.component=D}),ie(()=>{})));for(let D of p.children)m.push(...f(D));return m};return Oc(f(l.targetSnapshot.root)).pipe(Jn(null),Tn(1))}),Gf(()=>this.afterPreactivation()),jt(()=>{let{currentSnapshot:l,targetSnapshot:f}=o,p=this.createViewTransition?.(this.environmentInjector,l.root,f.root);return p?ke(p).pipe(ie(()=>o)):W(o)}),ie(l=>{let f=zM(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=Ae(F({},l),{targetRouterState:f}),this.currentNavigation.targetRouterState=f,o}),Fe(()=>{this.events.next(new Jo)}),XM(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Tn(1),Fe({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Br(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),lh(this.transitionAbortSubject.pipe(Fe(l=>{throw l}))),po(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",It.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Yn(l=>{if(u=!0,VT(l))this.events.next(new sr(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),KM(l)?this.events.next(new Xo(l.url)):o.resolve(!1);else{this.events.next(new Yo(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(f){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(f)}}return yt}))}))}cancelNavigationTransition(r,i,s){let o=new sr(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Gk(t){return t!==Wo}var Kk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>O(Qk),providedIn:"root"});let t=e;return t})(),wp=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},Qk=(()=>{let e=class e extends wp{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=mf(e)))(s||e)}})(),e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),zT=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:()=>O(Yk),providedIn:"root"});let t=e;return t})(),Yk=(()=>{let e=class e extends zT{constructor(){super(...arguments),this.location=O(Vo),this.urlSerializer=O(Ip),this.options=O(Sp,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=O(Rp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ir,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=PT(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Qo)this.stateMemento=this.createStateMemento();else if(r instanceof $r)this.rawUrlTree=i.initialUrl;else if(r instanceof Fu){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Jo?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof sr&&(r.code===It.GuardRejected||r.code===It.NoDataFromResolver)?this.restoreHistory(i):r instanceof Yo?this.restoreHistory(i,!0):r instanceof Br&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=F(F({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=F(F({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=mf(e)))(s||e)}})(),e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),qo=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(qo||{});function Jk(t,e){t.events.pipe(Ut(n=>n instanceof Br||n instanceof sr||n instanceof Yo||n instanceof $r),ie(n=>n instanceof Br||n instanceof $r?qo.COMPLETE:(n instanceof sr?n.code===It.Redirect||n.code===It.SupersededByNewNavigation:!1)?qo.REDIRECTING:qo.FAILED),Ut(n=>n!==qo.REDIRECTING),Tn(1)).subscribe(()=>{e()})}function Xk(t){throw t}var Zk={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},eO={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},WT=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=O(Eu),this.stateManager=O(zT),this.options=O(Sp,{optional:!0})||{},this.pendingTasks=O(vu),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=O(Wk),this.urlSerializer=O(Ip),this.location=O(Vo),this.urlHandlingStrategy=O(Rp),this._events=new lt,this.errorHandler=this.options.errorHandler||Xk,this.navigated=!1,this.routeReuseStrategy=O(Kk),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=O(Ap,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!O(Cp,{optional:!0}),this.eventsSubscription=new Re,this.isNgZoneEnabled=O(fe)instanceof fe&&fe.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof sr&&i.code!==It.Redirect&&i.code!==It.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Br)this.navigated=!0;else if(i instanceof Xo){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||Gk(s.source)};this.scheduleNavigation(a,Wo,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}nO(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Wo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=F({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Dp),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:a,p=null;switch(u){case"merge":p=F(F({},this.currentUrlTree.queryParams),o);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=o||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let D=s?s.snapshot:this.routerState.snapshot.root;m=AT(D)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),m=this.currentUrlTree.root}return RT(m,r,p,f??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=is(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Wo,null,i)}navigate(r,i={skipLocationChange:!1}){return tO(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=F({},Zk):i===!1?s=F({},eO):s=i,is(r))return fT(this.currentUrlTree,r,s);let o=this.parseUrl(r);return fT(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,l,f;a?(u=a.resolve,l=a.reject,f=a.promise):f=new Promise((m,D)=>{u=m,l=D});let p=this.pendingTasks.add();return Jk(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function tO(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new $(4008,!1)}function nO(t){return!(t instanceof Jo)&&!(t instanceof Xo)}var rO=new G("");function GT(t,...e){return xt([{provide:Ap,multi:!0,useValue:t},[],{provide:ss,useFactory:iO,deps:[WT]},{provide:Mf,multi:!0,useFactory:sO},e.map(n=>n.\u0275providers)])}function iO(t){return t.routerState.root}function sO(){let t=O(vt);return e=>{let n=t.get(Oo);if(e!==n.components[0])return;let r=t.get(WT),i=t.get(oO);t.get(aO)===1&&r.initialNavigation(),t.get(cO,null,Y.Optional)?.setUpPreloading(),t.get(rO,null,Y.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var oO=new G("",{factory:()=>new lt}),aO=new G("",{providedIn:"root",factory:()=>1});var cO=new G("");var KT=[];var xp={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var k=function(t,e){if(!t)throw qr(e)},qr=function(t){return new Error("Firebase Database ("+xp.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};var YT=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},uO=function(t){let e=[],n=0,r=0;for(;n<t.length;){let i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[n++],o=t[n++],a=t[n++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},zu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){let s=t[i],o=i+1<t.length,a=o?t[i+1]:0,u=i+2<t.length,l=u?t[i+2]:0,f=s>>2,p=(s&3)<<4|a>>4,m=(a&15)<<2|l>>6,D=l&63;u||(D=64,o||(m=64)),r.push(n[f],n[p],n[m],n[D])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(YT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):uO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){let s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;let l=i<t.length?n[t.charAt(i)]:64;++i;let p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||l==null||p==null)throw new Pp;let m=s<<2|a>>4;if(r.push(m),l!==64){let D=a<<4&240|l>>2;if(r.push(D),p!==64){let A=l<<6&192|p;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Pp=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},kp=function(t){let e=YT(t);return zu.encodeByteArray(e,!0)},sa=function(t){return kp(t).replace(/\./g,"")},oa=function(t){try{return zu.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function JT(t){return XT(void 0,t)}function XT(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(let n in e)!e.hasOwnProperty(n)||!lO(n)||(t[n]=XT(t[n],e[n]));return t}function lO(t){return t!=="__proto__"}function dO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var hO=()=>dO().__FIREBASE_DEFAULTS__,fO=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},pO=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&oa(t[1]);return e&&JSON.parse(e)},Wu=()=>{try{return hO()||fO()||pO()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Op=t=>{var e,n;return(n=(e=Wu())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Gu=t=>{let e=Op(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Fp=()=>{var t;return(t=Wu())===null||t===void 0?void 0:t.config},Lp=t=>{var e;return(e=Wu())===null||e===void 0?void 0:e[`_${t}`]};var Hr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function Ku(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[sa(JSON.stringify(n)),sa(JSON.stringify(o)),""].join(".")}function Ve(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aa(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ve())}function gO(){var t;let e=(t=Wu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ZT(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Qu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eC(){let t=Ve();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function on(){return xp.NODE_CLIENT===!0||xp.NODE_ADMIN===!0}function tC(){return!gO()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vp(){try{return typeof indexedDB=="object"}catch{return!1}}function nC(){return new Promise((t,e)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var mO="FirebaseError",Et=class t extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=mO,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nn.prototype.create)}},Nn=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){let r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?yO(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Et(i,a,r)}};function yO(t,e){return t.replace(_O,(n,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var _O=/\{\$([^}]+)}/g;function cs(t){return JSON.parse(t)}function Be(t){return JSON.stringify(t)}var rC=function(t){let e={},n={},r={},i="";try{let s=t.split(".");e=cs(oa(s[0])||""),n=cs(oa(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}};var iC=function(t){let e=rC(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},sC=function(t){let e=rC(t).claims;return typeof e=="object"&&e.admin===!0};function an(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function zr(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function ca(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ua(t,e,n){let r={};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function Wr(t,e){if(t===e)return!0;let n=Object.keys(t),r=Object.keys(e);for(let i of n){if(!r.includes(i))return!1;let s=t[i],o=e[i];if(QT(s)&&QT(o)){if(!Wr(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!n.includes(i))return!1;return!0}function QT(t){return t!==null&&typeof t=="object"}function Gr(t){let e=[];for(let[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}var qu=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);let r=this.W_;if(typeof e=="string")for(let p=0;p<16;p++)r[p]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let p=0;p<16;p++)r[p]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let p=16;p<80;p++){let m=r[p-3]^r[p-8]^r[p-14]^r[p-16];r[p]=(m<<1|m>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],u=this.chain_[4],l,f;for(let p=0;p<80;p++){p<40?p<20?(l=a^s&(o^a),f=1518500249):(l=s^o^a,f=1859775393):p<60?(l=s&o|a&(s|o),f=2400959708):(l=s^o^a,f=3395469782);let m=(i<<5|i>>>27)+l+u+f+r[p]&4294967295;u=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=m}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);let r=n-this.blockSize,i=0,s=this.buf_,o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){let e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}};function oC(t,e){let n=new Mp(t,e);return n.subscribe.bind(n)}var Mp=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");vO(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Np),i.error===void 0&&(i.error=Np),i.complete===void 0&&(i.complete=Np);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function vO(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Np(){}function aC(t,e){return`${t} failed: ${e} argument `}var cC=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){let s=i-55296;r++,k(r<t.length,"Surrogate pair missing trail surrogate.");let o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},la=function(t){let e=0;for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};var e9=4*60*60*1e3;function tt(t){return t&&t._delegate?t._delegate:t}var ft=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Kr="[DEFAULT]";var Yu=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let r=new Hr;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(IO(e))try{this.getOrInitializeService({instanceIdentifier:Kr})}catch{}for(let[n,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Kr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return T(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Kr){return this.instances.has(e)}getOptions(e=Kr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;let i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let r=this.onInitCallbacks.get(n);if(r)for(let i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wO(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kr){return this.component?this.component.multipleInstances?e:Kr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function wO(t){return t===Kr?void 0:t}function IO(t){return t.instantiationMode==="EAGER"}var da=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new Yu(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var EO=[],J=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(J||{}),TO={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},CO=J.INFO,DO={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},bO=(t,e,...n)=>{if(e<t.logLevel)return;let r=new Date().toISOString(),i=DO[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},cn=class{constructor(e){this.name=e,this._logLevel=CO,this._logHandler=bO,this._userLogHandler=null,EO.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in J))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?TO[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...e),this._logHandler(this,J.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...e),this._logHandler(this,J.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,J.INFO,...e),this._logHandler(this,J.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,J.WARN,...e),this._logHandler(this,J.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...e),this._logHandler(this,J.ERROR,...e)}};var SO=(t,e)=>e.some(n=>t instanceof n),uC,lC;function AO(){return uC||(uC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RO(){return lC||(lC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var dC=new WeakMap,jp=new WeakMap,hC=new WeakMap,Up=new WeakMap,$p=new WeakMap;function NO(t){let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(un(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&dC.set(n,t)}).catch(()=>{}),$p.set(e,t),e}function xO(t){if(jp.has(t))return;let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});jp.set(t,e)}var Bp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return jp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||hC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return un(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fC(t){Bp=t(Bp)}function PO(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let r=t.call(Ju(this),e,...n);return hC.set(r,e.sort?e.sort():[e]),un(r)}:RO().includes(t)?function(...e){return t.apply(Ju(this),e),un(dC.get(this))}:function(...e){return un(t.apply(Ju(this),e))}}function MO(t){return typeof t=="function"?PO(t):(t instanceof IDBTransaction&&xO(t),SO(t,AO())?new Proxy(t,Bp):t)}function un(t){if(t instanceof IDBRequest)return NO(t);if(Up.has(t))return Up.get(t);let e=MO(t);return e!==t&&(Up.set(t,e),$p.set(e,t)),e}var Ju=t=>$p.get(t);function gC(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(t,e),a=un(o);return r&&o.addEventListener("upgradeneeded",u=>{r(un(o.result),u.oldVersion,u.newVersion,un(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),a.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var kO=["get","getKey","getAll","getAllKeys","count"],OO=["put","add","delete","clear"],Hp=new Map;function pC(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Hp.get(e))return Hp.get(e);let n=e.replace(/FromIndex$/,""),r=e!==n,i=OO.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||kO.includes(n)))return;let s=function(o,...a){return T(this,null,function*(){let u=this.transaction(o,i?"readwrite":"readonly"),l=u.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[n](...a),i&&u.done]))[0]})};return Hp.set(e,s),s}fC(t=>Ae(F({},t),{get:(e,n,r)=>pC(e,n)||t.get(e,n,r),has:(e,n)=>!!pC(e,n)||t.has(e,n)}));var zp=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(FO(n)){let r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function FO(t){let e=t.getComponent();return e?.type==="VERSION"}var Wp="@firebase/app",mC="0.10.4";var Qr=new cn("@firebase/app"),LO="@firebase/app-compat",VO="@firebase/analytics-compat",UO="@firebase/analytics",jO="@firebase/app-check-compat",BO="@firebase/app-check",$O="@firebase/auth",HO="@firebase/auth-compat",qO="@firebase/database",zO="@firebase/database-compat",WO="@firebase/functions",GO="@firebase/functions-compat",KO="@firebase/installations",QO="@firebase/installations-compat",YO="@firebase/messaging",JO="@firebase/messaging-compat",XO="@firebase/performance",ZO="@firebase/performance-compat",e1="@firebase/remote-config",t1="@firebase/remote-config-compat",n1="@firebase/storage",r1="@firebase/storage-compat",i1="@firebase/firestore",s1="@firebase/vertexai-preview",o1="@firebase/firestore-compat",a1="firebase",c1="10.12.1";var Gp="[DEFAULT]",u1={[Wp]:"fire-core",[LO]:"fire-core-compat",[UO]:"fire-analytics",[VO]:"fire-analytics-compat",[BO]:"fire-app-check",[jO]:"fire-app-check-compat",[$O]:"fire-auth",[HO]:"fire-auth-compat",[qO]:"fire-rtdb",[zO]:"fire-rtdb-compat",[WO]:"fire-fn",[GO]:"fire-fn-compat",[KO]:"fire-iid",[QO]:"fire-iid-compat",[YO]:"fire-fcm",[JO]:"fire-fcm-compat",[XO]:"fire-perf",[ZO]:"fire-perf-compat",[e1]:"fire-rc",[t1]:"fire-rc-compat",[n1]:"fire-gcs",[r1]:"fire-gcs-compat",[i1]:"fire-fst",[o1]:"fire-fst-compat",[s1]:"fire-vertex","fire-js":"fire-js",[a1]:"fire-js-all"};var ha=new Map,l1=new Map,Kp=new Map;function yC(t,e){try{t.container.addComponent(e)}catch(n){Qr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ln(t){let e=t.name;if(Kp.has(e))return Qr.debug(`There were multiple attempts to register component ${e}.`),!1;Kp.set(e,t);for(let n of ha.values())yC(n,t);for(let n of l1.values())yC(n,t);return!0}function Yr(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function xn(t){return t.settings!==void 0}var d1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ar=new Nn("app","Firebase",d1);var Qp=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ft("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ar.create("app-deleted",{appName:this._name})}};var dn=c1;function Xp(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Gp,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ar.create("bad-app-name",{appName:String(i)});if(n||(n=Fp()),!n)throw ar.create("no-options");let s=ha.get(i);if(s){if(Wr(n,s.options)&&Wr(r,s.config))return s;throw ar.create("duplicate-app",{appName:i})}let o=new da(i);for(let u of Kp.values())o.addComponent(u);let a=new Qp(n,r,o);return ha.set(i,a),a}function cr(t=Gp){let e=ha.get(t);if(!e&&t===Gp&&Fp())return Xp();if(!e)throw ar.create("no-app",{appName:t});return e}function Xu(){return Array.from(ha.values())}function De(t,e,n){var r;let i=(r=u1[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qr.warn(a.join(" "));return}ln(new ft(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var h1="firebase-heartbeat-database",f1=1,fa="firebase-heartbeat-store",qp=null;function IC(){return qp||(qp=gC(h1,f1,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(fa)}catch(n){console.warn(n)}}}}).catch(t=>{throw ar.create("idb-open",{originalErrorMessage:t.message})})),qp}function p1(t){return T(this,null,function*(){try{let n=(yield IC()).transaction(fa),r=yield n.objectStore(fa).get(EC(t));return yield n.done,r}catch(e){if(e instanceof Et)Qr.warn(e.message);else{let n=ar.create("idb-get",{originalErrorMessage:e?.message});Qr.warn(n.message)}}})}function _C(t,e){return T(this,null,function*(){try{let r=(yield IC()).transaction(fa,"readwrite");yield r.objectStore(fa).put(e,EC(t)),yield r.done}catch(n){if(n instanceof Et)Qr.warn(n.message);else{let r=ar.create("idb-set",{originalErrorMessage:n?.message});Qr.warn(r.message)}}})}function EC(t){return`${t.name}!${t.options.appId}`}var g1=1024,m1=30*24*60*60*1e3,Yp=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new Jp(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return T(this,null,function*(){var e,n;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=vC();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=m1}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return T(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=vC(),{heartbeatsToSend:r,unsentEntries:i}=y1(this._heartbeatsCache.heartbeats),s=sa(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function vC(){return new Date().toISOString().substring(0,10)}function y1(t,e=g1){let n=[],r=t.slice();for(let i of t){let s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),wC(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),wC(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var Jp=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return T(this,null,function*(){return Vp()?nC().then(()=>!0).catch(()=>!1):!1})}read(){return T(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield p1(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return T(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return _C(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return T(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return _C(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function wC(t){return sa(JSON.stringify({version:2,heartbeats:t})).length}function _1(t){ln(new ft("platform-logger",e=>new zp(e),"PRIVATE")),ln(new ft("heartbeat",e=>new Yp(e),"PRIVATE")),De(Wp,mC,t),De(Wp,mC,"esm2017"),De("fire-js","")}_1("");var v1="firebase",w1="10.12.1";De(v1,w1,"app");var Pn=new nr("ANGULARFIRE2_VERSION");function ls(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var Xr=(t,e)=>{let n=e?[e]:Xu(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},ur=class{constructor(){return Xr(I1)}},I1="app-check";function us(){}var Zu=class{zone;delegate;constructor(e,n=nh){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Zp=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",us,{},us,us)),n.pipe(Fe({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},lr=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Zu(Zone.current)),this.insideAngular=n.run(()=>new Zu(Zone.current,th)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(Z(fe))};static \u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function el(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function E1(t){return el().ngZone.runOutsideAngular(()=>t())}function Jr(t){return el().ngZone.run(()=>t())}function T1(t){return C1(el())(t)}function C1(t){return function(n){return n=n.lift(new Zp(t.ngZone)),n.pipe(Qn(t.outsideAngular),Kn(t.insideAngular))}}var D1=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Jr(()=>t.apply(void 0,r))},hn=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=Jr(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",us,{},us,us))),r[s]=D1(r[s],n));let i=E1(()=>t.apply(this,r));if(!e)if(i instanceof le){let s=el();return i.pipe(Qn(s.outsideAngular),Kn(s.insideAngular))}else return Jr(()=>i);return i instanceof le?i.pipe(T1):i instanceof Promise?Jr(()=>new Promise((s,o)=>i.then(a=>Jr(()=>s(a)),a=>Jr(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:Jr(()=>i)};var Wt=class{constructor(e){return e}},Mn=class{constructor(){return Xu()}};function b1(t){return t&&t.length===1?t[0]:new Wt(cr())}var eg=new G("angularfire2._apps"),S1={provide:Wt,useFactory:b1,deps:[[new Le,eg]]},A1={provide:Mn,deps:[[new Le,eg]]};function R1(t){return(e,n)=>{let r=n.get(rr);De("angularfire",Pn.full,"core"),De("angularfire",Pn.full,"app"),De("angular",UE.full,r.toString());let i=e.runOutsideAngular(()=>t(n));return new Wt(i)}}function TC(t,...e){return xt([S1,A1,{provide:eg,useFactory:R1(t),multi:!0,deps:[fe,vt,lr,...e]}])}var CC=hn(Xp,!0);function UC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var jC=UC,BC=new Nn("auth","Firebase",UC());var ol=new cn("@firebase/auth");function N1(t,...e){ol.logLevel<=J.WARN&&ol.warn(`Auth (${dn}): ${t}`,...e)}function nl(t,...e){ol.logLevel<=J.ERROR&&ol.error(`Auth (${dn}): ${t}`,...e)}function hr(t,...e){throw wg(t,...e)}function ei(t,...e){return wg(t,...e)}function $C(t,e,n){let r=Object.assign(Object.assign({},jC()),{[e]:n});return new Nn("auth","Firebase",r).create(e,{appName:t.name})}function Zr(t){return $C(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wg(t,...e){if(typeof t!="string"){let n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return BC.create(t,...e)}function j(t,e,...n){if(!t)throw wg(e,...n)}function kn(t){let e="INTERNAL ASSERTION FAILED: "+t;throw nl(e),new Error(e)}function fr(t,e){t||kn(e)}function ig(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function x1(){return DC()==="http:"||DC()==="https:"}function DC(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function P1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(x1()||ZT()||"connection"in navigator)?navigator.onLine:!0}function M1(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var ti=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,fr(n>e,"Short delay should be less than long delay!"),this.isMobile=aa()||Qu()}get(){return P1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Ig(t,e){fr(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var al=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;kn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;kn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;kn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var k1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var O1=new ti(3e4,6e4);function Eg(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function hs(s,o,a,u){return T(this,arguments,function*(t,e,n,r,i={}){return HC(t,i,()=>T(this,null,function*(){let l={},f={};r&&(e==="GET"?f=r:l={body:JSON.stringify(r)});let p=Gr(Object.assign({key:t.config.apiKey},f)).slice(1),m=yield t._getAdditionalHeaders();return m["Content-Type"]="application/json",t.languageCode&&(m["X-Firebase-Locale"]=t.languageCode),al.fetch()(qC(t,t.config.apiHost,n,p),Object.assign({method:e,headers:m,referrerPolicy:"no-referrer"},l))}))})}function HC(t,e,n){return T(this,null,function*(){t._canInitEmulator=!1;let r=Object.assign(Object.assign({},k1),e);try{let i=new sg(t),s=yield Promise.race([n(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw tl(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[u,l]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw tl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw tl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw tl(t,"user-disabled",o);let f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw $C(t,f,l);hr(t,f)}}catch(i){if(i instanceof Et)throw i;hr(t,"network-request-failed",{message:String(i)})}})}function F1(s,o,a,u){return T(this,arguments,function*(t,e,n,r,i={}){let l=yield hs(t,e,n,r,i);return"mfaPendingCredential"in l&&hr(t,"multi-factor-auth-required",{_serverResponse:l}),l})}function qC(t,e,n,r){let i=`${e}${n}?${r}`;return t.config.emulator?Ig(t.config,i):`${t.config.apiScheme}://${i}`}var sg=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(ei(this.auth,"network-request-failed")),O1.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function tl(t,e,n){let r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=ei(t,e,r);return i.customData._tokenResponse=n,i}function L1(t,e){return T(this,null,function*(){return hs(t,"POST","/v1/accounts:delete",e)})}function zC(t,e){return T(this,null,function*(){return hs(t,"POST","/v1/accounts:lookup",e)})}function pa(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Tg(t,e=!1){return T(this,null,function*(){let n=tt(t),r=yield n.getIdToken(e),i=Cg(r);j(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:pa(tg(i.auth_time)),issuedAtTime:pa(tg(i.iat)),expirationTime:pa(tg(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function tg(t){return Number(t)*1e3}function Cg(t){let[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return nl("JWT malformed, contained fewer than 3 sections"),null;try{let i=oa(n);return i?JSON.parse(i):(nl("Failed to decode base64 JWT payload"),null)}catch(i){return nl("Caught error parsing JWT payload as JSON",i?.toString()),null}}function bC(t){let e=Cg(t);return j(e,"internal-error"),j(typeof e.exp<"u","internal-error"),j(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function ma(t,e,n=!1){return T(this,null,function*(){if(n)return e;try{return yield e}catch(r){throw r instanceof Et&&V1(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})}function V1({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var og=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>T(this,null,function*(){yield this.iteration()}),n)}iteration(){return T(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ya=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=pa(this.lastLoginAt),this.creationTime=pa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function cl(t){return T(this,null,function*(){var e;let n=t.auth,r=yield t.getIdToken(),i=yield ma(t,zC(n,{idToken:r}));j(i?.users.length,n,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?WC(s.providerUserInfo):[],a=U1(t.providerData,o),u=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!a?.length,f=u?l:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ya(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,p)})}function Dg(t){return T(this,null,function*(){let e=tt(t);yield cl(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function U1(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function WC(t){return t.map(e=>{var{providerId:n}=e,r=rh(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function j1(t,e){return T(this,null,function*(){let n=yield HC(t,{},()=>T(this,null,function*(){let r=Gr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=qC(t,i,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",al.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function B1(t,e){return T(this,null,function*(){return hs(t,"POST","/v2/accounts:revokeToken",Eg(t,e))})}var ga=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){j(e.idToken,"internal-error"),j(typeof e.idToken<"u","internal-error"),j(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):bC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){j(e.length!==0,"internal-error");let n=bC(e);this.updateTokensAndExpiration(e,null,n)}getToken(e,n=!1){return T(this,null,function*(){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(j(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return T(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield j1(e,n);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){let{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new t;return r&&(j(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(j(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(j(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return kn("not implemented")}};function dr(t,e){j(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var ds=class t{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=rh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new og(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ya(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return T(this,null,function*(){let n=yield ma(this,this.stsTokenManager.getToken(this.auth,e));return j(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return Tg(this,e)}reload(){return Dg(this)}_assign(e){this!==e&&(j(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return T(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&(yield cl(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return T(this,null,function*(){if(xn(this.auth.app))return Promise.reject(Zr(this.auth));let e=yield this.getIdToken();return yield ma(this,L1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,u,l,f;let p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,D=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,A=(o=n.photoURL)!==null&&o!==void 0?o:void 0,R=(a=n.tenantId)!==null&&a!==void 0?a:void 0,x=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,V=(l=n.createdAt)!==null&&l!==void 0?l:void 0,K=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:B,emailVerified:de,isAnonymous:We,providerData:he,stsTokenManager:I}=n;j(B&&I,e,"internal-error");let y=ga.fromJSON(this.name,I);j(typeof B=="string",e,"internal-error"),dr(p,e.name),dr(m,e.name),j(typeof de=="boolean",e,"internal-error"),j(typeof We=="boolean",e,"internal-error"),dr(D,e.name),dr(A,e.name),dr(R,e.name),dr(x,e.name),dr(V,e.name),dr(K,e.name);let _=new t({uid:B,auth:e,email:m,emailVerified:de,displayName:p,isAnonymous:We,photoURL:A,phoneNumber:D,tenantId:R,stsTokenManager:y,createdAt:V,lastLoginAt:K});return he&&Array.isArray(he)&&(_.providerData=he.map(w=>Object.assign({},w))),x&&(_._redirectEventId=x),_}static _fromIdTokenResponse(e,n,r=!1){return T(this,null,function*(){let i=new ga;i.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield cl(s),s})}static _fromGetAccountInfoResponse(e,n,r){return T(this,null,function*(){let i=n.users[0];j(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?WC(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new ga;a.updateFromIdToken(r);let u=new t({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ya(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,l),u})}};var SC=new Map;function On(t){fr(t instanceof Function,"Expected a class definition");let e=SC.get(t);return e?(fr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,SC.set(t,e),e)}var $1=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return T(this,null,function*(){return!0})}_set(n,r){return T(this,null,function*(){this.storage[n]=r})}_get(n){return T(this,null,function*(){let r=this.storage[n];return r===void 0?null:r})}_remove(n){return T(this,null,function*(){delete this.storage[n]})}_addListener(n,r){}_removeListener(n,r){}}return t.type="NONE",t})(),ag=$1;function rl(t,e,n){return`firebase:${t}:${e}:${n}`}var ul=class t{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=rl(this.userKey,i.apiKey,s),this.fullPersistenceKey=rl("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return T(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?ds._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return T(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,r="authUser"){return T(this,null,function*(){if(!n.length)return new t(On(ag),e,r);let i=(yield Promise.all(n.map(l=>T(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||On(ag),o=rl(r,e.config.apiKey,e.name),a=null;for(let l of n)try{let f=yield l._get(o);if(f){let p=ds._fromJSON(e,f);l!==s&&(a=p),s=l;break}}catch{}let u=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new t(s,e,r):(s=u[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(l=>T(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new t(s,e,r))})}};function AC(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(QC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(GC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(JC(e))return"Blackberry";if(XC(e))return"Webos";if(bg(e))return"Safari";if((e.includes("chrome/")||KC(e))&&!e.includes("edge/"))return"Chrome";if(YC(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function GC(t=Ve()){return/firefox\//i.test(t)}function bg(t=Ve()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function KC(t=Ve()){return/crios\//i.test(t)}function QC(t=Ve()){return/iemobile/i.test(t)}function YC(t=Ve()){return/android/i.test(t)}function JC(t=Ve()){return/blackberry/i.test(t)}function XC(t=Ve()){return/webos/i.test(t)}function yl(t=Ve()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function H1(t=Ve()){var e;return yl(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function q1(){return eC()&&document.documentMode===10}function ZC(t=Ve()){return yl(t)||YC(t)||XC(t)||JC(t)||/windows phone/i.test(t)||QC(t)}function z1(){try{return!!(window&&window!==window.top)}catch{return!1}}function eD(t,e=[]){let n;switch(t){case"Browser":n=AC(Ve());break;case"Worker":n=`${AC(Ve())}-${t}`;break;default:n=t}let r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${dn}/${r}`}var cg=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let r=s=>new Promise((o,a)=>{try{let u=e(s);o(u)}catch(u){a(u)}});r.onAbort=n,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return T(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let r of this.queue)yield r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(let i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function W1(n){return T(this,arguments,function*(t,e={}){return hs(t,"GET","/v2/passwordPolicy",Eg(t,e))})}var G1=6,ug=class{constructor(e){var n,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:G1,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;let u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,n){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var lg=class{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ll(this),this.idTokenSubscription=new ll(this),this.beforeStateQueue=new cg(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=On(n)),this._initializationPromise=this.queue(()=>T(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield ul.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return T(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return T(this,null,function*(){try{let n=yield zC(this,{idToken:e}),r=yield ds._fromGetAccountInfoResponse(this,n,e);yield this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return T(this,null,function*(){var n;if(xn(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i?._redirectEventId,u=yield this.tryRedirectSignIn(e);(!o||o===a)&&u?.user&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return j(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return T(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return T(this,null,function*(){try{yield cl(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=M1()}_delete(){return T(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return T(this,null,function*(){if(xn(this.app))return Promise.reject(Zr(this));let n=e?tt(e):null;return n&&j(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return T(this,null,function*(){if(!this._deleted)return e&&j(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>T(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return T(this,null,function*(){return xn(this.app)?Promise.reject(Zr(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return xn(this.app)?Promise.reject(Zr(this)):this.queue(()=>T(this,null,function*(){yield this.assertedPersistence.setPersistence(On(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return T(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return T(this,null,function*(){let e=yield W1(this),n=new ug(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Nn("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},n)}})}revokeAccessToken(e){return T(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),yield B1(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return T(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return T(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&On(e)||this._popupRedirectResolver;j(n,this,"argument-error"),this.redirectPersistenceManager=yield ul.create(this,[On(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return T(this,null,function*(){var n,r;return this._isInitialized&&(yield this.queue(()=>T(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return T(this,null,function*(){if(e===this.currentUser)return this.queue(()=>T(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(j(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let u=e.addObserver(n,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(n);return()=>{o=!0,u()}}}directlySetCurrentUser(e){return T(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=eD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return T(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(n["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n})}_getAppCheckToken(){return T(this,null,function*(){var e;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&N1(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function Sg(t){return tt(t)}var ll=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=oC(n=>this.observer=n)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Ag={loadJS(){return T(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function K1(t){Ag=t}function Q1(t){return Ag.loadJS(t)}function Y1(){return Ag.gapiScript}function tD(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function Rg(t,e){let n=Yr(t,"auth");if(n.isInitialized()){let i=n.getImmediate(),s=n.getOptions();if(Wr(s,e??{}))return i;hr(i,"already-initialized")}return n.initialize({options:e})}function J1(t,e){let n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(On);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function Ng(t,e,n){let r=Sg(t);j(r._canInitEmulator,r,"emulator-config-failed"),j(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!n?.disableWarnings,s=nD(e),{host:o,port:a}=X1(e),u=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||Z1()}function nD(t){let e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function X1(t){let e=nD(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};let r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:RC(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:RC(o)}}}function RC(t){if(!t)return null;let e=Number(t);return isNaN(e)?null:e}function Z1(){function t(){let e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}var dl=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return kn("not implemented")}_getIdTokenResponse(e){return kn("not implemented")}_linkToIdToken(e,n){return kn("not implemented")}_getReauthenticationResolver(e){return kn("not implemented")}};function ng(t,e){return T(this,null,function*(){return F1(t,"POST","/v1/accounts:signInWithIdp",Eg(t,e))})}var hl=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var dg=class extends hl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var _a=class t{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,n,r,i=!1){return T(this,null,function*(){let s=yield ds._fromIdTokenResponse(e,r,i),o=NC(r);return new t({user:s,providerId:o,_tokenResponse:r,operationType:n})})}static _forOperation(e,n,r){return T(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=NC(r);return new t({user:e,providerId:i,_tokenResponse:r,operationType:n})})}};function NC(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}var hg=class t extends Et{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,t.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new t(e,n,r,i)}};function rD(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?hg._fromErrorAndOperation(t,s,e,r):s})}function eF(t,e,n=!1){return T(this,null,function*(){let r=yield ma(t,e._linkToIdToken(t.auth,yield t.getIdToken()),n);return _a._forOperation(t,"link",r)})}function tF(t,e,n=!1){return T(this,null,function*(){let{auth:r}=t;if(xn(r.app))return Promise.reject(Zr(r));let i="reauthenticate";try{let s=yield ma(t,rD(r,i,e,t),n);j(s.idToken,r,"internal-error");let o=Cg(s.idToken);j(o,r,"internal-error");let{sub:a}=o;return j(t.uid===a,r,"user-mismatch"),_a._forOperation(t,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&hr(r,"user-mismatch"),s}})}function nF(t,e,n=!1){return T(this,null,function*(){if(xn(t.app))return Promise.reject(Zr(t));let r="signIn",i=yield rD(t,r,e),s=yield _a._fromIdTokenResponse(t,r,i);return n||(yield t._updateCurrentUser(s.user)),s})}function xg(t,e,n,r){return tt(t).onIdTokenChanged(e,n,r)}function Pg(t,e,n){return tt(t).beforeAuthStateChanged(e,n)}var fl="__sak";var pl=class{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(fl,"1"),this.storage.removeItem(fl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){let n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function rF(){let t=Ve();return bg(t)||yl(t)}var iF=1e3,sF=10,oF=(()=>{class t extends pl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,r)=>this.onStorageEvent(n,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=rF()&&z1(),this.fallbackToPolling=ZC(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&n(r,s,i)}}onStorageEvent(n,r=!1){if(!n.key){this.forAllChangedKeys((a,u,l)=>{this.notifyListeners(a,l)});return}let i=n.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(i);if(n.newValue!==a)n.newValue!==null?this.storage.setItem(i,n.newValue):this.storage.removeItem(i);else if(this.localCache[i]===n.newValue&&!r)return}let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);q1()&&o!==n.newValue&&n.newValue!==n.oldValue?setTimeout(s,sF):s()}notifyListeners(n,r){this.localCache[n]=r;let i=this.listeners[n];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:r,newValue:i}),!0)})},iF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(n,r){return T(this,null,function*(){yield Wn(t.prototype,this,"_set").call(this,n,r),this.localCache[n]=JSON.stringify(r)})}_get(n){return T(this,null,function*(){let r=yield Wn(t.prototype,this,"_get").call(this,n);return this.localCache[n]=JSON.stringify(r),r})}_remove(n){return T(this,null,function*(){yield Wn(t.prototype,this,"_remove").call(this,n),delete this.localCache[n]})}}return t.type="LOCAL",t})(),iD=oF;var aF=(()=>{class t extends pl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,r){}_removeListener(n,r){}}return t.type="SESSION",t})(),Mg=aF;function cF(t){return Promise.all(t.map(e=>T(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(n){return{fulfilled:!1,reason:n}}})))}var uF=(()=>{class t{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){let r=this.receivers.find(s=>s.isListeningto(n));if(r)return r;let i=new t(n);return this.receivers.push(i),i}isListeningto(n){return this.eventTarget===n}handleEvent(n){return T(this,null,function*(){let r=n,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let u=Array.from(a).map(f=>T(this,null,function*(){return f(r.origin,o)})),l=yield cF(u);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(n,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(r)}_unsubscribe(n,r){this.handlersMap[n]&&r&&this.handlersMap[n].delete(r),(!r||this.handlersMap[n].size===0)&&delete this.handlersMap[n],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}t.receivers=[];return t})();function sD(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}var fg=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,n,r=50){return T(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,u)=>{let l=sD("",20);i.port1.start();let f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){let m=p;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function fn(){return window}function lF(t){fn().location.href=t}function oD(){return typeof fn().WorkerGlobalScope<"u"&&typeof fn().importScripts=="function"}function dF(){return T(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function hF(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function fF(){return oD()?self:null}var aD="firebaseLocalStorageDb",pF=1,gl="firebaseLocalStorage",cD="fbase_key",ni=class{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}};function _l(t,e){return t.transaction([gl],e?"readwrite":"readonly").objectStore(gl)}function gF(){let t=indexedDB.deleteDatabase(aD);return new ni(t).toPromise()}function pg(){let t=indexedDB.open(aD,pF);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{let r=t.result;try{r.createObjectStore(gl,{keyPath:cD})}catch(i){n(i)}}),t.addEventListener("success",()=>T(this,null,function*(){let r=t.result;r.objectStoreNames.contains(gl)?e(r):(r.close(),yield gF(),e(yield pg()))}))})}function xC(t,e,n){return T(this,null,function*(){let r=_l(t,!0).put({[cD]:e,value:n});return new ni(r).toPromise()})}function mF(t,e){return T(this,null,function*(){let n=_l(t,!1).get(e),r=yield new ni(n).toPromise();return r===void 0?null:r.value})}function PC(t,e){let n=_l(t,!0).delete(e);return new ni(n).toPromise()}var yF=800,_F=3,vF=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return T(this,null,function*(){return this.db?this.db:(this.db=yield pg(),this.db)})}_withRetries(n){return T(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield n(i)}catch(i){if(r++>_F)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return T(this,null,function*(){return oD()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return T(this,null,function*(){this.receiver=uF._getInstance(fF()),this.receiver._subscribe("keyChanged",(n,r)=>T(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(n,r)=>T(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return T(this,null,function*(){var n,r;if(this.activeServiceWorker=yield dF(),!this.activeServiceWorker)return;this.sender=new fg(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((n=i[0])===null||n===void 0)&&n.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(n){return T(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||hF()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:n},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return T(this,null,function*(){try{if(!indexedDB)return!1;let n=yield pg();return yield xC(n,fl,"1"),yield PC(n,fl),!0}catch{}return!1})}_withPendingWrite(n){return T(this,null,function*(){this.pendingWrites++;try{yield n()}finally{this.pendingWrites--}})}_set(n,r){return T(this,null,function*(){return this._withPendingWrite(()=>T(this,null,function*(){return yield this._withRetries(i=>xC(i,n,r)),this.localCache[n]=r,this.notifyServiceWorker(n)}))})}_get(n){return T(this,null,function*(){let r=yield this._withRetries(i=>mF(i,n));return this.localCache[n]=r,r})}_remove(n){return T(this,null,function*(){return this._withPendingWrite(()=>T(this,null,function*(){return yield this._withRetries(r=>PC(r,n)),delete this.localCache[n],this.notifyServiceWorker(n)}))})}_poll(){return T(this,null,function*(){let n=yield this._withRetries(s=>{let o=_l(s,!1).getAll();return new ni(o).toPromise()});if(!n)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(n.length!==0)for(let{fbase_key:s,value:o}of n)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(n,r){this.localCache[n]=r;let i=this.listeners[n];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>T(this,null,function*(){return this._poll()}),yF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return t.type="LOCAL",t})(),uD=vF;var K9=tD("rcb"),Q9=new ti(3e4,6e4);function wF(t,e){return e?On(e):(j(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}var va=class extends dl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ng(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ng(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ng(e,this._buildIdpRequest())}_buildIdpRequest(e){let n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}};function IF(t){return nF(t.auth,new va(t),t.bypassAuthState)}function EF(t){let{auth:e,user:n}=t;return j(n,e,"internal-error"),tF(n,new va(t),t.bypassAuthState)}function TF(t){return T(this,null,function*(){let{auth:e,user:n}=t;return j(n,e,"internal-error"),eF(n,new va(t),t.bypassAuthState)})}var gg=class{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise((e,n)=>T(this,null,function*(){this.pendingPromise={resolve:e,reject:n};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return T(this,null,function*(){let{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let u={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(u))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return IF;case"linkViaPopup":case"linkViaRedirect":return TF;case"reauthViaPopup":case"reauthViaRedirect":return EF;default:hr(this.auth,"internal-error")}}resolve(e){fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Y9=new ti(2e3,1e4);var CF="pendingRedirect",il=new Map,mg=class t extends gg{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}execute(){return T(this,null,function*(){let e=il.get(this.auth._key());if(!e){try{let r=(yield DF(this.resolver,this.auth))?yield Wn(t.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}il.set(this.auth._key(),e)}return this.bypassAuthState||il.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return T(this,null,function*(){if(e.type==="signInViaRedirect")return Wn(t.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let n=yield this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,Wn(t.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return T(this,null,function*(){})}cleanUp(){}};function DF(t,e){return T(this,null,function*(){let n=AF(e),r=SF(t);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(n))==="true";return yield r._remove(n),i})}function bF(t,e){il.set(t._key(),e)}function SF(t){return On(t._redirectPersistence)}function AF(t){return rl(CF,t.config.apiKey,t.name)}function RF(t,e,n=!1){return T(this,null,function*(){if(xn(t.app))return Promise.reject(Zr(t));let r=Sg(t),i=wF(r,e),o=yield new mg(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var NF=10*60*1e3,yg=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!lD(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(ei(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){let r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=NF&&this.cachedEventUids.clear(),this.cachedEventUids.has(MC(e))}saveEventToCache(e){this.cachedEventUids.add(MC(e)),this.lastProcessedEventTime=Date.now()}};function MC(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lD({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function xF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lD(t);default:return!1}}function PF(n){return T(this,arguments,function*(t,e={}){return hs(t,"GET","/v1/projects",e)})}var MF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,kF=/^https?/;function OF(t){return T(this,null,function*(){if(t.config.emulator)return;let{authorizedDomains:e}=yield PF(t);for(let n of e)try{if(FF(n))return}catch{}hr(t,"unauthorized-domain")})}function FF(t){let e=ig(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){let o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!kF.test(n))return!1;if(MF.test(t))return r===t;let i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var LF=new ti(3e4,6e4);function kC(){let t=fn().___jsl;if(t?.H){for(let e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function VF(t){return new Promise((e,n)=>{var r,i,s;function o(){kC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{kC(),n(ei(t,"network-request-failed"))},timeout:LF.get()})}if(!((i=(r=fn().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=fn().gapi)===null||s===void 0)&&s.load)o();else{let a=tD("iframefcb");return fn()[a]=()=>{gapi.load?o():n(ei(t,"network-request-failed"))},Q1(`${Y1()}?onload=${a}`).catch(u=>n(u))}}).catch(e=>{throw sl=null,e})}var sl=null;function UF(t){return sl=sl||VF(t),sl}var jF=new ti(5e3,15e3),BF="__/auth/iframe",$F="emulator/auth/iframe",HF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function zF(t){let e=t.config;j(e.authDomain,t,"auth-domain-config-required");let n=e.emulator?Ig(e,$F):`https://${t.config.authDomain}/${BF}`,r={apiKey:e.apiKey,appName:t.name,v:dn},i=qF.get(t.config.apiHost);i&&(r.eid=i);let s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Gr(r).slice(1)}`}function WF(t){return T(this,null,function*(){let e=yield UF(t),n=fn().gapi;return j(n,t,"internal-error"),e.open({where:document.body,url:zF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:HF,dontclear:!0},r=>new Promise((i,s)=>T(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=ei(t,"network-request-failed"),a=fn().setTimeout(()=>{s(o)},jF.get());function u(){fn().clearTimeout(a),i(r)}r.ping(u).then(u,()=>{s(o)})})))})}var GF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},KF=500,QF=600,YF="_blank",JF="http://localhost",ml=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function XF(t,e,n,r=KF,i=QF){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",u=Object.assign(Object.assign({},GF),{width:r.toString(),height:i.toString(),top:s,left:o}),l=Ve().toLowerCase();n&&(a=KC(l)?YF:n),GC(l)&&(e=e||JF,u.scrollbars="yes");let f=Object.entries(u).reduce((m,[D,A])=>`${m}${D}=${A},`,"");if(H1(l)&&a!=="_self")return ZF(e||"",a),new ml(null);let p=window.open(e||"",a,f);j(p,t,"popup-blocked");try{p.focus()}catch{}return new ml(p)}function ZF(t,e){let n=document.createElement("a");n.href=t,n.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var eL="__/auth/handler",tL="emulator/auth/handler",nL=encodeURIComponent("fac");function OC(t,e,n,r,i,s){return T(this,null,function*(){j(t.config.authDomain,t,"auth-domain-config-required"),j(t.config.apiKey,t,"invalid-api-key");let o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:dn,eventId:i};if(e instanceof hl){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",ca(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,p]of Object.entries(s||{}))o[f]=p}if(e instanceof dg){let f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);let a=o;for(let f of Object.keys(a))a[f]===void 0&&delete a[f];let u=yield t._getAppCheckToken(),l=u?`#${nL}=${encodeURIComponent(u)}`:"";return`${rL(t)}?${Gr(a).slice(1)}${l}`})}function rL({config:t}){return t.emulator?Ig(t,tL):`https://${t.authDomain}/${eL}`}var rg="webStorageSupport",_g=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Mg,this._completeRedirectFn=RF,this._overrideRedirectResult=bF}_openPopup(e,n,r,i){return T(this,null,function*(){var s;fr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield OC(e,n,r,ig(),i);return XF(e,o,sD())})}_openRedirect(e,n,r,i){return T(this,null,function*(){yield this._originValidation(e);let s=yield OC(e,n,r,ig(),i);return lF(s),new Promise(()=>{})})}_initialize(e){let n=e._key();if(this.eventManagers[n]){let{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(fr(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}initAndGetManager(e){return T(this,null,function*(){let n=yield WF(e),r=new yg(e);return n.register("authEvent",i=>(j(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r})}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(rg,{type:rg},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[rg];o!==void 0&&n(!!o),hr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=OF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ZC()||bg()||yl()}},dD=_g;var FC="@firebase/auth",LC="1.7.3";var vg=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return T(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function iL(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function sL(t){ln(new ft("auth",(e,{options:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;j(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:eD(t)},l=new lg(r,i,s,u);return J1(l,n),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ln(new ft("auth-internal",e=>{let n=Sg(e.getProvider("auth").getImmediate());return(r=>new vg(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),De(FC,LC,iL(t)),De(FC,LC,"esm2017")}var oL=5*60,aL=Lp("authIdTokenMaxAge")||oL,VC=null,cL=t=>e=>T(void 0,null,function*(){let n=e&&(yield e.getIdTokenResult()),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>aL)return;let i=n?.token;VC!==i&&(VC=i,yield fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function kg(t=cr()){let e=Yr(t,"auth");if(e.isInitialized())return e.getImmediate();let n=Rg(t,{popupRedirectResolver:dD,persistence:[uD,iD,Mg]}),r=Lp("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=cL(s.toString());Pg(n,o,()=>o(n.currentUser)),xg(n,a=>o(a))}}let i=Op("auth");return i&&Ng(n,`http://${i}`),n}function uL(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}K1({loadJS(t){return new Promise((e,n)=>{let r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{let s=ei("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",uL().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});sL("Browser");var hD="auth",wa=class{constructor(e){return e}},ri=class{constructor(){return Xr(hD)}};var Og=new G("angularfire2.auth-instances");function rV(t,e){let n=ls(hD,t,e);return n&&new wa(n)}function iV(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new wa(r)}}var sV={provide:ri,deps:[[new Le,Og]]},oV={provide:wa,useFactory:rV,deps:[[new Le,Og],Wt]};function fD(t,...e){return De("angularfire",Pn.full,"auth"),xt([oV,sV,{provide:Og,useFactory:iV(t),multi:!0,deps:[fe,vt,lr,Mn,[new Le,ur],...e]}])}var pD=hn(kg,!0);var gD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mD={};var Fg,yD;(function(){var t;function e(I,y){function _(){}_.prototype=y.prototype,I.D=y.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(w,E,b){for(var v=Array(arguments.length-2),vn=2;vn<arguments.length;vn++)v[vn-2]=arguments[vn];return y.prototype[E].apply(w,v)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,y,_){_||(_=0);var w=Array(16);if(typeof y=="string")for(var E=0;16>E;++E)w[E]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(E=0;16>E;++E)w[E]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=I.g[0],_=I.g[1],E=I.g[2];var b=I.g[3],v=y+(b^_&(E^b))+w[0]+3614090360&4294967295;y=_+(v<<7&4294967295|v>>>25),v=b+(E^y&(_^E))+w[1]+3905402710&4294967295,b=y+(v<<12&4294967295|v>>>20),v=E+(_^b&(y^_))+w[2]+606105819&4294967295,E=b+(v<<17&4294967295|v>>>15),v=_+(y^E&(b^y))+w[3]+3250441966&4294967295,_=E+(v<<22&4294967295|v>>>10),v=y+(b^_&(E^b))+w[4]+4118548399&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(E^y&(_^E))+w[5]+1200080426&4294967295,b=y+(v<<12&4294967295|v>>>20),v=E+(_^b&(y^_))+w[6]+2821735955&4294967295,E=b+(v<<17&4294967295|v>>>15),v=_+(y^E&(b^y))+w[7]+4249261313&4294967295,_=E+(v<<22&4294967295|v>>>10),v=y+(b^_&(E^b))+w[8]+1770035416&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(E^y&(_^E))+w[9]+2336552879&4294967295,b=y+(v<<12&4294967295|v>>>20),v=E+(_^b&(y^_))+w[10]+4294925233&4294967295,E=b+(v<<17&4294967295|v>>>15),v=_+(y^E&(b^y))+w[11]+2304563134&4294967295,_=E+(v<<22&4294967295|v>>>10),v=y+(b^_&(E^b))+w[12]+1804603682&4294967295,y=_+(v<<7&4294967295|v>>>25),v=b+(E^y&(_^E))+w[13]+4254626195&4294967295,b=y+(v<<12&4294967295|v>>>20),v=E+(_^b&(y^_))+w[14]+2792965006&4294967295,E=b+(v<<17&4294967295|v>>>15),v=_+(y^E&(b^y))+w[15]+1236535329&4294967295,_=E+(v<<22&4294967295|v>>>10),v=y+(E^b&(_^E))+w[1]+4129170786&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^E&(y^_))+w[6]+3225465664&4294967295,b=y+(v<<9&4294967295|v>>>23),v=E+(y^_&(b^y))+w[11]+643717713&4294967295,E=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(E^b))+w[0]+3921069994&4294967295,_=E+(v<<20&4294967295|v>>>12),v=y+(E^b&(_^E))+w[5]+3593408605&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^E&(y^_))+w[10]+38016083&4294967295,b=y+(v<<9&4294967295|v>>>23),v=E+(y^_&(b^y))+w[15]+3634488961&4294967295,E=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(E^b))+w[4]+3889429448&4294967295,_=E+(v<<20&4294967295|v>>>12),v=y+(E^b&(_^E))+w[9]+568446438&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^E&(y^_))+w[14]+3275163606&4294967295,b=y+(v<<9&4294967295|v>>>23),v=E+(y^_&(b^y))+w[3]+4107603335&4294967295,E=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(E^b))+w[8]+1163531501&4294967295,_=E+(v<<20&4294967295|v>>>12),v=y+(E^b&(_^E))+w[13]+2850285829&4294967295,y=_+(v<<5&4294967295|v>>>27),v=b+(_^E&(y^_))+w[2]+4243563512&4294967295,b=y+(v<<9&4294967295|v>>>23),v=E+(y^_&(b^y))+w[7]+1735328473&4294967295,E=b+(v<<14&4294967295|v>>>18),v=_+(b^y&(E^b))+w[12]+2368359562&4294967295,_=E+(v<<20&4294967295|v>>>12),v=y+(_^E^b)+w[5]+4294588738&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^E)+w[8]+2272392833&4294967295,b=y+(v<<11&4294967295|v>>>21),v=E+(b^y^_)+w[11]+1839030562&4294967295,E=b+(v<<16&4294967295|v>>>16),v=_+(E^b^y)+w[14]+4259657740&4294967295,_=E+(v<<23&4294967295|v>>>9),v=y+(_^E^b)+w[1]+2763975236&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^E)+w[4]+1272893353&4294967295,b=y+(v<<11&4294967295|v>>>21),v=E+(b^y^_)+w[7]+4139469664&4294967295,E=b+(v<<16&4294967295|v>>>16),v=_+(E^b^y)+w[10]+3200236656&4294967295,_=E+(v<<23&4294967295|v>>>9),v=y+(_^E^b)+w[13]+681279174&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^E)+w[0]+3936430074&4294967295,b=y+(v<<11&4294967295|v>>>21),v=E+(b^y^_)+w[3]+3572445317&4294967295,E=b+(v<<16&4294967295|v>>>16),v=_+(E^b^y)+w[6]+76029189&4294967295,_=E+(v<<23&4294967295|v>>>9),v=y+(_^E^b)+w[9]+3654602809&4294967295,y=_+(v<<4&4294967295|v>>>28),v=b+(y^_^E)+w[12]+3873151461&4294967295,b=y+(v<<11&4294967295|v>>>21),v=E+(b^y^_)+w[15]+530742520&4294967295,E=b+(v<<16&4294967295|v>>>16),v=_+(E^b^y)+w[2]+3299628645&4294967295,_=E+(v<<23&4294967295|v>>>9),v=y+(E^(_|~b))+w[0]+4096336452&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~E))+w[7]+1126891415&4294967295,b=y+(v<<10&4294967295|v>>>22),v=E+(y^(b|~_))+w[14]+2878612391&4294967295,E=b+(v<<15&4294967295|v>>>17),v=_+(b^(E|~y))+w[5]+4237533241&4294967295,_=E+(v<<21&4294967295|v>>>11),v=y+(E^(_|~b))+w[12]+1700485571&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~E))+w[3]+2399980690&4294967295,b=y+(v<<10&4294967295|v>>>22),v=E+(y^(b|~_))+w[10]+4293915773&4294967295,E=b+(v<<15&4294967295|v>>>17),v=_+(b^(E|~y))+w[1]+2240044497&4294967295,_=E+(v<<21&4294967295|v>>>11),v=y+(E^(_|~b))+w[8]+1873313359&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~E))+w[15]+4264355552&4294967295,b=y+(v<<10&4294967295|v>>>22),v=E+(y^(b|~_))+w[6]+2734768916&4294967295,E=b+(v<<15&4294967295|v>>>17),v=_+(b^(E|~y))+w[13]+1309151649&4294967295,_=E+(v<<21&4294967295|v>>>11),v=y+(E^(_|~b))+w[4]+4149444226&4294967295,y=_+(v<<6&4294967295|v>>>26),v=b+(_^(y|~E))+w[11]+3174756917&4294967295,b=y+(v<<10&4294967295|v>>>22),v=E+(y^(b|~_))+w[2]+718787259&4294967295,E=b+(v<<15&4294967295|v>>>17),v=_+(b^(E|~y))+w[9]+3951481745&4294967295,I.g[0]=I.g[0]+y&4294967295,I.g[1]=I.g[1]+(E+(v<<21&4294967295|v>>>11))&4294967295,I.g[2]=I.g[2]+E&4294967295,I.g[3]=I.g[3]+b&4294967295}r.prototype.u=function(I,y){y===void 0&&(y=I.length);for(var _=y-this.blockSize,w=this.B,E=this.h,b=0;b<y;){if(E==0)for(;b<=_;)i(this,I,b),b+=this.blockSize;if(typeof I=="string"){for(;b<y;)if(w[E++]=I.charCodeAt(b++),E==this.blockSize){i(this,w),E=0;break}}else for(;b<y;)if(w[E++]=I[b++],E==this.blockSize){i(this,w),E=0;break}}this.h=E,this.o+=y},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var y=1;y<I.length-8;++y)I[y]=0;var _=8*this.o;for(y=I.length-8;y<I.length;++y)I[y]=_&255,_/=256;for(this.u(I),I=Array(16),y=_=0;4>y;++y)for(var w=0;32>w;w+=8)I[_++]=this.g[y]>>>w&255;return I};function s(I,y){var _=a;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=y(I)}function o(I,y){this.h=y;for(var _=[],w=!0,E=I.length-1;0<=E;E--){var b=I[E]|0;w&&b==y||(_[E]=b,w=!1)}this.g=_}var a={};function u(I){return-128<=I&&128>I?s(I,function(y){return new o([y|0],0>y?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return x(l(-I));for(var y=[],_=1,w=0;I>=_;w++)y[w]=I/_|0,_*=4294967296;return new o(y,0)}function f(I,y){if(I.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(I.charAt(0)=="-")return x(f(I.substring(1),y));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=l(Math.pow(y,8)),w=p,E=0;E<I.length;E+=8){var b=Math.min(8,I.length-E),v=parseInt(I.substring(E,E+b),y);8>b?(b=l(Math.pow(y,b)),w=w.j(b).add(l(v))):(w=w.j(_),w=w.add(l(v)))}return w}var p=u(0),m=u(1),D=u(16777216);t=o.prototype,t.m=function(){if(R(this))return-x(this).m();for(var I=0,y=1,_=0;_<this.g.length;_++){var w=this.i(_);I+=(0<=w?w:4294967296+w)*y,y*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(A(this))return"0";if(R(this))return"-"+x(this).toString(I);for(var y=l(Math.pow(I,6)),_=this,w="";;){var E=de(_,y).g;_=V(_,E.j(y));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=E,A(_))return b+w;for(;6>b.length;)b="0"+b;w=b+w}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function A(I){if(I.h!=0)return!1;for(var y=0;y<I.g.length;y++)if(I.g[y]!=0)return!1;return!0}function R(I){return I.h==-1}t.l=function(I){return I=V(this,I),R(I)?-1:A(I)?0:1};function x(I){for(var y=I.g.length,_=[],w=0;w<y;w++)_[w]=~I.g[w];return new o(_,~I.h).add(m)}t.abs=function(){return R(this)?x(this):this},t.add=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],w=0,E=0;E<=y;E++){var b=w+(this.i(E)&65535)+(I.i(E)&65535),v=(b>>>16)+(this.i(E)>>>16)+(I.i(E)>>>16);w=v>>>16,b&=65535,v&=65535,_[E]=v<<16|b}return new o(_,_[_.length-1]&-2147483648?-1:0)};function V(I,y){return I.add(x(y))}t.j=function(I){if(A(this)||A(I))return p;if(R(this))return R(I)?x(this).j(x(I)):x(x(this).j(I));if(R(I))return x(this.j(x(I)));if(0>this.l(D)&&0>I.l(D))return l(this.m()*I.m());for(var y=this.g.length+I.g.length,_=[],w=0;w<2*y;w++)_[w]=0;for(w=0;w<this.g.length;w++)for(var E=0;E<I.g.length;E++){var b=this.i(w)>>>16,v=this.i(w)&65535,vn=I.i(E)>>>16,Ws=I.i(E)&65535;_[2*w+2*E]+=v*Ws,K(_,2*w+2*E),_[2*w+2*E+1]+=b*Ws,K(_,2*w+2*E+1),_[2*w+2*E+1]+=v*vn,K(_,2*w+2*E+1),_[2*w+2*E+2]+=b*vn,K(_,2*w+2*E+2)}for(w=0;w<y;w++)_[w]=_[2*w+1]<<16|_[2*w];for(w=y;w<2*y;w++)_[w]=0;return new o(_,0)};function K(I,y){for(;(I[y]&65535)!=I[y];)I[y+1]+=I[y]>>>16,I[y]&=65535,y++}function B(I,y){this.g=I,this.h=y}function de(I,y){if(A(y))throw Error("division by zero");if(A(I))return new B(p,p);if(R(I))return y=de(x(I),y),new B(x(y.g),x(y.h));if(R(y))return y=de(I,x(y)),new B(x(y.g),y.h);if(30<I.g.length){if(R(I)||R(y))throw Error("slowDivide_ only works with positive integers.");for(var _=m,w=y;0>=w.l(I);)_=We(_),w=We(w);var E=he(_,1),b=he(w,1);for(w=he(w,2),_=he(_,2);!A(w);){var v=b.add(w);0>=v.l(I)&&(E=E.add(_),b=v),w=he(w,1),_=he(_,1)}return y=V(I,E.j(y)),new B(E,y)}for(E=p;0<=I.l(y);){for(_=Math.max(1,Math.floor(I.m()/y.m())),w=Math.ceil(Math.log(_)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),b=l(_),v=b.j(y);R(v)||0<v.l(I);)_-=w,b=l(_),v=b.j(y);A(b)&&(b=m),E=E.add(b),I=V(I,v)}return new B(E,I)}t.A=function(I){return de(this,I).h},t.and=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],w=0;w<y;w++)_[w]=this.i(w)&I.i(w);return new o(_,this.h&I.h)},t.or=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],w=0;w<y;w++)_[w]=this.i(w)|I.i(w);return new o(_,this.h|I.h)},t.xor=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],w=0;w<y;w++)_[w]=this.i(w)^I.i(w);return new o(_,this.h^I.h)};function We(I){for(var y=I.g.length+1,_=[],w=0;w<y;w++)_[w]=I.i(w)<<1|I.i(w-1)>>>31;return new o(_,I.h)}function he(I,y){var _=y>>5;y%=32;for(var w=I.g.length-_,E=[],b=0;b<w;b++)E[b]=0<y?I.i(b+_)>>>y|I.i(b+_+1)<<32-y:I.i(b+_);return new o(E,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,yD=mD.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=f,Fg=mD.Integer=o}).apply(typeof gD<"u"?gD:typeof self<"u"?self:typeof window<"u"?window:{});var vl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Fn={};var Lg,Vg,fs,Ug,Ia,wl,jg,Bg,$g;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,d,h){return c==Array.prototype||c==Object.prototype||(c[d]=h.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof vl=="object"&&vl];for(var d=0;d<c.length;++d){var h=c[d];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=n(this);function i(c,d){if(d)e:{var h=r;c=c.split(".");for(var g=0;g<c.length-1;g++){var C=c[g];if(!(C in h))break e;h=h[C]}c=c[c.length-1],g=h[c],d=d(g),d!=g&&d!=null&&e(h,c,{configurable:!0,writable:!0,value:d})}}function s(c,d){c instanceof String&&(c+="");var h=0,g=!1,C={next:function(){if(!g&&h<c.length){var S=h++;return{value:d(S,c[S]),done:!1}}return g=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(c){return c||function(){return s(this,function(d,h){return h})}});var o=o||{},a=this||self;function u(c){var d=typeof c;return d=d!="object"?d:c?Array.isArray(c)?"array":d:"null",d=="array"||d=="object"&&typeof c.length=="number"}function l(c){var d=typeof c;return d=="object"&&c!=null||d=="function"}function f(c,d,h){return c.call.apply(c.bind,arguments)}function p(c,d,h){if(!c)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,g),c.apply(d,C)}}return function(){return c.apply(d,arguments)}}function m(c,d,h){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function D(c,d){var h=Array.prototype.slice.call(arguments,1);return function(){var g=h.slice();return g.push.apply(g,arguments),c.apply(this,g)}}function A(c,d){function h(){}h.prototype=d.prototype,c.aa=d.prototype,c.prototype=new h,c.prototype.constructor=c,c.Qb=function(g,C,S){for(var M=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)M[_e-2]=arguments[_e];return d.prototype[C].apply(g,M)}}function R(c){let d=c.length;if(0<d){let h=Array(d);for(let g=0;g<d;g++)h[g]=c[g];return h}return[]}function x(c,d){for(let h=1;h<arguments.length;h++){let g=arguments[h];if(u(g)){let C=c.length||0,S=g.length||0;c.length=C+S;for(let M=0;M<S;M++)c[C+M]=g[M]}else c.push(g)}}class V{constructor(d,h){this.i=d,this.j=h,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function K(c){return/^[\s\xa0]*$/.test(c)}function B(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function de(c){return de[" "](c),c}de[" "]=function(){};var We=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function he(c,d,h){for(let g in c)d.call(h,c[g],g,c)}function I(c,d){for(let h in c)d.call(void 0,c[h],h,c)}function y(c){let d={};for(let h in c)d[h]=c[h];return d}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(c,d){let h,g;for(let C=1;C<arguments.length;C++){g=arguments[C];for(h in g)c[h]=g[h];for(let S=0;S<_.length;S++)h=_[S],Object.prototype.hasOwnProperty.call(g,h)&&(c[h]=g[h])}}function E(c){var d=1;c=c.split(":");let h=[];for(;0<d&&c.length;)h.push(c.shift()),d--;return c.length&&h.push(c.join(":")),h}function b(c){a.setTimeout(()=>{throw c},0)}function v(){var c=md;let d=null;return c.g&&(d=c.g,c.g=c.g.next,c.g||(c.h=null),d.next=null),d}class vn{constructor(){this.h=this.g=null}add(d,h){let g=Ws.get();g.set(d,h),this.h?this.h.next=g:this.g=g,this.h=g}}var Ws=new V(()=>new RA,c=>c.reset());class RA{constructor(){this.next=this.g=this.h=null}set(d,h){this.h=d,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let Gs,Ks=!1,md=new vn,x_=()=>{let c=a.Promise.resolve(void 0);Gs=()=>{c.then(NA)}};var NA=()=>{for(var c;c=v();){try{c.h.call(c.g)}catch(h){b(h)}var d=Ws;d.j(c),100>d.h&&(d.h++,c.next=d.g,d.g=c)}Ks=!1};function $n(){this.s=this.s,this.C=this.C}$n.prototype.s=!1,$n.prototype.ma=function(){this.s||(this.s=!0,this.N())},$n.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ye(c,d){this.type=c,this.g=this.target=d,this.defaultPrevented=!1}Ye.prototype.h=function(){this.defaultPrevented=!0};var xA=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,d=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let h=()=>{};a.addEventListener("test",h,d),a.removeEventListener("test",h,d)}catch{}return c}();function Qs(c,d){if(Ye.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var h=this.type=c.type,g=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=d,d=c.relatedTarget){if(We){e:{try{de(d.nodeName);var C=!0;break e}catch{}C=!1}C||(d=null)}}else h=="mouseover"?d=c.fromElement:h=="mouseout"&&(d=c.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:PA[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Qs.aa.h.call(this)}}A(Qs,Ye);var PA={2:"touch",3:"pen",4:"mouse"};Qs.prototype.h=function(){Qs.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ys="closure_listenable_"+(1e6*Math.random()|0),MA=0;function kA(c,d,h,g,C){this.listener=c,this.proxy=null,this.src=d,this.type=h,this.capture=!!g,this.ha=C,this.key=++MA,this.da=this.fa=!1}function Za(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ec(c){this.src=c,this.g={},this.h=0}ec.prototype.add=function(c,d,h,g,C){var S=c.toString();c=this.g[S],c||(c=this.g[S]=[],this.h++);var M=_d(c,d,g,C);return-1<M?(d=c[M],h||(d.fa=!1)):(d=new kA(d,this.src,S,!!g,C),d.fa=h,c.push(d)),d};function yd(c,d){var h=d.type;if(h in c.g){var g=c.g[h],C=Array.prototype.indexOf.call(g,d,void 0),S;(S=0<=C)&&Array.prototype.splice.call(g,C,1),S&&(Za(d),c.g[h].length==0&&(delete c.g[h],c.h--))}}function _d(c,d,h,g){for(var C=0;C<c.length;++C){var S=c[C];if(!S.da&&S.listener==d&&S.capture==!!h&&S.ha==g)return C}return-1}var vd="closure_lm_"+(1e6*Math.random()|0),wd={};function P_(c,d,h,g,C){if(g&&g.once)return k_(c,d,h,g,C);if(Array.isArray(d)){for(var S=0;S<d.length;S++)P_(c,d[S],h,g,C);return null}return h=Cd(h),c&&c[Ys]?c.K(d,h,l(g)?!!g.capture:!!g,C):M_(c,d,h,!1,g,C)}function M_(c,d,h,g,C,S){if(!d)throw Error("Invalid event type");var M=l(C)?!!C.capture:!!C,_e=Ed(c);if(_e||(c[vd]=_e=new ec(c)),h=_e.add(d,h,g,M,S),h.proxy)return h;if(g=OA(),h.proxy=g,g.src=c,g.listener=h,c.addEventListener)xA||(C=M),C===void 0&&(C=!1),c.addEventListener(d.toString(),g,C);else if(c.attachEvent)c.attachEvent(F_(d.toString()),g);else if(c.addListener&&c.removeListener)c.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return h}function OA(){function c(h){return d.call(c.src,c.listener,h)}let d=FA;return c}function k_(c,d,h,g,C){if(Array.isArray(d)){for(var S=0;S<d.length;S++)k_(c,d[S],h,g,C);return null}return h=Cd(h),c&&c[Ys]?c.L(d,h,l(g)?!!g.capture:!!g,C):M_(c,d,h,!0,g,C)}function O_(c,d,h,g,C){if(Array.isArray(d))for(var S=0;S<d.length;S++)O_(c,d[S],h,g,C);else g=l(g)?!!g.capture:!!g,h=Cd(h),c&&c[Ys]?(c=c.i,d=String(d).toString(),d in c.g&&(S=c.g[d],h=_d(S,h,g,C),-1<h&&(Za(S[h]),Array.prototype.splice.call(S,h,1),S.length==0&&(delete c.g[d],c.h--)))):c&&(c=Ed(c))&&(d=c.g[d.toString()],c=-1,d&&(c=_d(d,h,g,C)),(h=-1<c?d[c]:null)&&Id(h))}function Id(c){if(typeof c!="number"&&c&&!c.da){var d=c.src;if(d&&d[Ys])yd(d.i,c);else{var h=c.type,g=c.proxy;d.removeEventListener?d.removeEventListener(h,g,c.capture):d.detachEvent?d.detachEvent(F_(h),g):d.addListener&&d.removeListener&&d.removeListener(g),(h=Ed(d))?(yd(h,c),h.h==0&&(h.src=null,d[vd]=null)):Za(c)}}}function F_(c){return c in wd?wd[c]:wd[c]="on"+c}function FA(c,d){if(c.da)c=!0;else{d=new Qs(d,this);var h=c.listener,g=c.ha||c.src;c.fa&&Id(c),c=h.call(g,d)}return c}function Ed(c){return c=c[vd],c instanceof ec?c:null}var Td="__closure_events_fn_"+(1e9*Math.random()>>>0);function Cd(c){return typeof c=="function"?c:(c[Td]||(c[Td]=function(d){return c.handleEvent(d)}),c[Td])}function Je(){$n.call(this),this.i=new ec(this),this.M=this,this.F=null}A(Je,$n),Je.prototype[Ys]=!0,Je.prototype.removeEventListener=function(c,d,h,g){O_(this,c,d,h,g)};function ct(c,d){var h,g=c.F;if(g)for(h=[];g;g=g.F)h.push(g);if(c=c.M,g=d.type||d,typeof d=="string")d=new Ye(d,c);else if(d instanceof Ye)d.target=d.target||c;else{var C=d;d=new Ye(g,c),w(d,C)}if(C=!0,h)for(var S=h.length-1;0<=S;S--){var M=d.g=h[S];C=tc(M,g,!0,d)&&C}if(M=d.g=c,C=tc(M,g,!0,d)&&C,C=tc(M,g,!1,d)&&C,h)for(S=0;S<h.length;S++)M=d.g=h[S],C=tc(M,g,!1,d)&&C}Je.prototype.N=function(){if(Je.aa.N.call(this),this.i){var c=this.i,d;for(d in c.g){for(var h=c.g[d],g=0;g<h.length;g++)Za(h[g]);delete c.g[d],c.h--}}this.F=null},Je.prototype.K=function(c,d,h,g){return this.i.add(String(c),d,!1,h,g)},Je.prototype.L=function(c,d,h,g){return this.i.add(String(c),d,!0,h,g)};function tc(c,d,h,g){if(d=c.i.g[String(d)],!d)return!0;d=d.concat();for(var C=!0,S=0;S<d.length;++S){var M=d[S];if(M&&!M.da&&M.capture==h){var _e=M.listener,Ge=M.ha||M.src;M.fa&&yd(c.i,M),C=_e.call(Ge,g)!==!1&&C}}return C&&!g.defaultPrevented}function L_(c,d,h){if(typeof c=="function")h&&(c=m(c,h));else if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(c,d||0)}function V_(c){c.g=L_(()=>{c.g=null,c.i&&(c.i=!1,V_(c))},c.l);let d=c.h;c.h=null,c.m.apply(null,d)}class LA extends $n{constructor(d,h){super(),this.m=d,this.l=h,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:V_(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Js(c){$n.call(this),this.h=c,this.g={}}A(Js,$n);var U_=[];function j_(c){he(c.g,function(d,h){this.g.hasOwnProperty(h)&&Id(d)},c),c.g={}}Js.prototype.N=function(){Js.aa.N.call(this),j_(this)},Js.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Dd=a.JSON.stringify,VA=a.JSON.parse,UA=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function bd(){}bd.prototype.h=null;function B_(c){return c.h||(c.h=c.i())}function $_(){}var Xs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Sd(){Ye.call(this,"d")}A(Sd,Ye);function Ad(){Ye.call(this,"c")}A(Ad,Ye);var Er={},H_=null;function nc(){return H_=H_||new Je}Er.La="serverreachability";function q_(c){Ye.call(this,Er.La,c)}A(q_,Ye);function Zs(c){let d=nc();ct(d,new q_(d))}Er.STAT_EVENT="statevent";function z_(c,d){Ye.call(this,Er.STAT_EVENT,c),this.stat=d}A(z_,Ye);function ut(c){let d=nc();ct(d,new z_(d,c))}Er.Ma="timingevent";function W_(c,d){Ye.call(this,Er.Ma,c),this.size=d}A(W_,Ye);function eo(c,d){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},d)}function to(){this.g=!0}to.prototype.xa=function(){this.g=!1};function jA(c,d,h,g,C,S){c.info(function(){if(c.g)if(S)for(var M="",_e=S.split("&"),Ge=0;Ge<_e.length;Ge++){var ue=_e[Ge].split("=");if(1<ue.length){var Xe=ue[0];ue=ue[1];var Ze=Xe.split("_");M=2<=Ze.length&&Ze[1]=="type"?M+(Xe+"="+ue+"&"):M+(Xe+"=redacted&")}}else M=null;else M=S;return"XMLHTTP REQ ("+g+") [attempt "+C+"]: "+d+`
`+h+`
`+M})}function BA(c,d,h,g,C,S,M){c.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+C+"]: "+d+`
`+h+`
`+S+" "+M})}function Ii(c,d,h,g){c.info(function(){return"XMLHTTP TEXT ("+d+"): "+HA(c,h)+(g?" "+g:"")})}function $A(c,d){c.info(function(){return"TIMEOUT: "+d})}to.prototype.info=function(){};function HA(c,d){if(!c.g)return d;if(!d)return null;try{var h=JSON.parse(d);if(h){for(c=0;c<h.length;c++)if(Array.isArray(h[c])){var g=h[c];if(!(2>g.length)){var C=g[1];if(Array.isArray(C)&&!(1>C.length)){var S=C[0];if(S!="noop"&&S!="stop"&&S!="close")for(var M=1;M<C.length;M++)C[M]=""}}}}return Dd(h)}catch{return d}}var rc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},G_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Rd;function ic(){}A(ic,bd),ic.prototype.g=function(){return new XMLHttpRequest},ic.prototype.i=function(){return{}},Rd=new ic;function Hn(c,d,h,g){this.j=c,this.i=d,this.l=h,this.R=g||1,this.U=new Js(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new K_}function K_(){this.i=null,this.g="",this.h=!1}var Q_={},Nd={};function xd(c,d,h){c.L=1,c.v=cc(wn(d)),c.m=h,c.P=!0,Y_(c,null)}function Y_(c,d){c.F=Date.now(),sc(c),c.A=wn(c.v);var h=c.A,g=c.R;Array.isArray(g)||(g=[String(g)]),lv(h.i,"t",g),c.C=0,h=c.j.J,c.h=new K_,c.g=Av(c.j,h?d:null,!c.m),0<c.O&&(c.M=new LA(m(c.Y,c,c.g),c.O)),d=c.U,h=c.g,g=c.ca;var C="readystatechange";Array.isArray(C)||(C&&(U_[0]=C.toString()),C=U_);for(var S=0;S<C.length;S++){var M=P_(h,C[S],g||d.handleEvent,!1,d.h||d);if(!M)break;d.g[M.key]=M}d=c.H?y(c.H):{},c.m?(c.u||(c.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,d)):(c.u="GET",c.g.ea(c.A,c.u,null,d)),Zs(),jA(c.i,c.u,c.A,c.l,c.R,c.m)}Hn.prototype.ca=function(c){c=c.target;let d=this.M;d&&In(c)==3?d.j():this.Y(c)},Hn.prototype.Y=function(c){try{if(c==this.g)e:{let Ze=In(this.g);var d=this.g.Ba();let Ci=this.g.Z();if(!(3>Ze)&&(Ze!=3||this.g&&(this.h.h||this.g.oa()||yv(this.g)))){this.J||Ze!=4||d==7||(d==8||0>=Ci?Zs(3):Zs(2)),Pd(this);var h=this.g.Z();this.X=h;t:if(J_(this)){var g=yv(this.g);c="";var C=g.length,S=In(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Tr(this),no(this);var M="";break t}this.h.i=new a.TextDecoder}for(d=0;d<C;d++)this.h.h=!0,c+=this.h.i.decode(g[d],{stream:!(S&&d==C-1)});g.length=0,this.h.g+=c,this.C=0,M=this.h.g}else M=this.g.oa();if(this.o=h==200,BA(this.i,this.u,this.A,this.l,this.R,Ze,h),this.o){if(this.T&&!this.K){t:{if(this.g){var _e,Ge=this.g;if((_e=Ge.g?Ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(_e)){var ue=_e;break t}}ue=null}if(h=ue)Ii(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Md(this,h);else{this.o=!1,this.s=3,ut(12),Tr(this),no(this);break e}}if(this.P){h=!0;let Lt;for(;!this.J&&this.C<M.length;)if(Lt=qA(this,M),Lt==Nd){Ze==4&&(this.s=4,ut(14),h=!1),Ii(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==Q_){this.s=4,ut(15),Ii(this.i,this.l,M,"[Invalid Chunk]"),h=!1;break}else Ii(this.i,this.l,Lt,null),Md(this,Lt);if(J_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||M.length!=0||this.h.h||(this.s=1,ut(16),h=!1),this.o=this.o&&h,!h)Ii(this.i,this.l,M,"[Invalid Chunked Response]"),Tr(this),no(this);else if(0<M.length&&!this.W){this.W=!0;var Xe=this.j;Xe.g==this&&Xe.ba&&!Xe.M&&(Xe.j.info("Great, no buffering proxy detected. Bytes received: "+M.length),Ud(Xe),Xe.M=!0,ut(11))}}else Ii(this.i,this.l,M,null),Md(this,M);Ze==4&&Tr(this),this.o&&!this.J&&(Ze==4?Cv(this.j,this):(this.o=!1,sc(this)))}else a0(this.g),h==400&&0<M.indexOf("Unknown SID")?(this.s=3,ut(12)):(this.s=0,ut(13)),Tr(this),no(this)}}}catch{}finally{}};function J_(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function qA(c,d){var h=c.C,g=d.indexOf(`
`,h);return g==-1?Nd:(h=Number(d.substring(h,g)),isNaN(h)?Q_:(g+=1,g+h>d.length?Nd:(d=d.slice(g,g+h),c.C=g+h,d)))}Hn.prototype.cancel=function(){this.J=!0,Tr(this)};function sc(c){c.S=Date.now()+c.I,X_(c,c.I)}function X_(c,d){if(c.B!=null)throw Error("WatchDog timer not null");c.B=eo(m(c.ba,c),d)}function Pd(c){c.B&&(a.clearTimeout(c.B),c.B=null)}Hn.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?($A(this.i,this.A),this.L!=2&&(Zs(),ut(17)),Tr(this),this.s=2,no(this)):X_(this,this.S-c)};function no(c){c.j.G==0||c.J||Cv(c.j,c)}function Tr(c){Pd(c);var d=c.M;d&&typeof d.ma=="function"&&d.ma(),c.M=null,j_(c.U),c.g&&(d=c.g,c.g=null,d.abort(),d.ma())}function Md(c,d){try{var h=c.j;if(h.G!=0&&(h.g==c||kd(h.h,c))){if(!c.K&&kd(h.h,c)&&h.G==3){try{var g=h.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var C=g;if(C[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<c.F)fc(h),dc(h);else break e;Vd(h),ut(18)}}else h.za=C[1],0<h.za-h.T&&37500>C[2]&&h.F&&h.v==0&&!h.C&&(h.C=eo(m(h.Za,h),6e3));if(1>=tv(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else Dr(h,11)}else if((c.K||h.g==c)&&fc(h),!K(d))for(C=h.Da.g.parse(d),d=0;d<C.length;d++){let ue=C[d];if(h.T=ue[0],ue=ue[1],h.G==2)if(ue[0]=="c"){h.K=ue[1],h.ia=ue[2];let Xe=ue[3];Xe!=null&&(h.la=Xe,h.j.info("VER="+h.la));let Ze=ue[4];Ze!=null&&(h.Aa=Ze,h.j.info("SVER="+h.Aa));let Ci=ue[5];Ci!=null&&typeof Ci=="number"&&0<Ci&&(g=1.5*Ci,h.L=g,h.j.info("backChannelRequestTimeoutMs_="+g)),g=h;let Lt=c.g;if(Lt){let gc=Lt.g?Lt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gc){var S=g.h;S.g||gc.indexOf("spdy")==-1&&gc.indexOf("quic")==-1&&gc.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(Od(S,S.h),S.h=null))}if(g.D){let jd=Lt.g?Lt.g.getResponseHeader("X-HTTP-Session-Id"):null;jd&&(g.ya=jd,Ee(g.I,g.D,jd))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-c.F,h.j.info("Handshake RTT: "+h.R+"ms")),g=h;var M=c;if(g.qa=Sv(g,g.J?g.ia:null,g.W),M.K){nv(g.h,M);var _e=M,Ge=g.L;Ge&&(_e.I=Ge),_e.B&&(Pd(_e),sc(_e)),g.g=M}else Ev(g);0<h.i.length&&hc(h)}else ue[0]!="stop"&&ue[0]!="close"||Dr(h,7);else h.G==3&&(ue[0]=="stop"||ue[0]=="close"?ue[0]=="stop"?Dr(h,7):Ld(h):ue[0]!="noop"&&h.l&&h.l.ta(ue),h.v=0)}}Zs(4)}catch{}}var zA=class{constructor(c,d){this.g=c,this.map=d}};function Z_(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ev(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function tv(c){return c.h?1:c.g?c.g.size:0}function kd(c,d){return c.h?c.h==d:c.g?c.g.has(d):!1}function Od(c,d){c.g?c.g.add(d):c.h=d}function nv(c,d){c.h&&c.h==d?c.h=null:c.g&&c.g.has(d)&&c.g.delete(d)}Z_.prototype.cancel=function(){if(this.i=rv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function rv(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let d=c.i;for(let h of c.g.values())d=d.concat(h.D);return d}return R(c.i)}function WA(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var d=[],h=c.length,g=0;g<h;g++)d.push(c[g]);return d}d=[],h=0;for(g in c)d[h++]=c[g];return d}function GA(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var d=[];c=c.length;for(var h=0;h<c;h++)d.push(h);return d}d=[],h=0;for(let g in c)d[h++]=g;return d}}}function iv(c,d){if(c.forEach&&typeof c.forEach=="function")c.forEach(d,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,d,void 0);else for(var h=GA(c),g=WA(c),C=g.length,S=0;S<C;S++)d.call(void 0,g[S],h&&h[S],c)}var sv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function KA(c,d){if(c){c=c.split("&");for(var h=0;h<c.length;h++){var g=c[h].indexOf("="),C=null;if(0<=g){var S=c[h].substring(0,g);C=c[h].substring(g+1)}else S=c[h];d(S,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Cr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Cr){this.h=c.h,oc(this,c.j),this.o=c.o,this.g=c.g,ac(this,c.s),this.l=c.l;var d=c.i,h=new so;h.i=d.i,d.g&&(h.g=new Map(d.g),h.h=d.h),ov(this,h),this.m=c.m}else c&&(d=String(c).match(sv))?(this.h=!1,oc(this,d[1]||"",!0),this.o=ro(d[2]||""),this.g=ro(d[3]||"",!0),ac(this,d[4]),this.l=ro(d[5]||"",!0),ov(this,d[6]||"",!0),this.m=ro(d[7]||"")):(this.h=!1,this.i=new so(null,this.h))}Cr.prototype.toString=function(){var c=[],d=this.j;d&&c.push(io(d,av,!0),":");var h=this.g;return(h||d=="file")&&(c.push("//"),(d=this.o)&&c.push(io(d,av,!0),"@"),c.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&c.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&c.push("/"),c.push(io(h,h.charAt(0)=="/"?JA:YA,!0))),(h=this.i.toString())&&c.push("?",h),(h=this.m)&&c.push("#",io(h,ZA)),c.join("")};function wn(c){return new Cr(c)}function oc(c,d,h){c.j=h?ro(d,!0):d,c.j&&(c.j=c.j.replace(/:$/,""))}function ac(c,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);c.s=d}else c.s=null}function ov(c,d,h){d instanceof so?(c.i=d,e0(c.i,c.h)):(h||(d=io(d,XA)),c.i=new so(d,c.h))}function Ee(c,d,h){c.i.set(d,h)}function cc(c){return Ee(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function ro(c,d){return c?d?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function io(c,d,h){return typeof c=="string"?(c=encodeURI(c).replace(d,QA),h&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function QA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var av=/[#\/\?@]/g,YA=/[#\?:]/g,JA=/[#\?]/g,XA=/[#\?@]/g,ZA=/#/g;function so(c,d){this.h=this.g=null,this.i=c||null,this.j=!!d}function qn(c){c.g||(c.g=new Map,c.h=0,c.i&&KA(c.i,function(d,h){c.add(decodeURIComponent(d.replace(/\+/g," ")),h)}))}t=so.prototype,t.add=function(c,d){qn(this),this.i=null,c=Ei(this,c);var h=this.g.get(c);return h||this.g.set(c,h=[]),h.push(d),this.h+=1,this};function cv(c,d){qn(c),d=Ei(c,d),c.g.has(d)&&(c.i=null,c.h-=c.g.get(d).length,c.g.delete(d))}function uv(c,d){return qn(c),d=Ei(c,d),c.g.has(d)}t.forEach=function(c,d){qn(this),this.g.forEach(function(h,g){h.forEach(function(C){c.call(d,C,g,this)},this)},this)},t.na=function(){qn(this);let c=Array.from(this.g.values()),d=Array.from(this.g.keys()),h=[];for(let g=0;g<d.length;g++){let C=c[g];for(let S=0;S<C.length;S++)h.push(d[g])}return h},t.V=function(c){qn(this);let d=[];if(typeof c=="string")uv(this,c)&&(d=d.concat(this.g.get(Ei(this,c))));else{c=Array.from(this.g.values());for(let h=0;h<c.length;h++)d=d.concat(c[h])}return d},t.set=function(c,d){return qn(this),this.i=null,c=Ei(this,c),uv(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[d]),this.h+=1,this},t.get=function(c,d){return c?(c=this.V(c),0<c.length?String(c[0]):d):d};function lv(c,d,h){cv(c,d),0<h.length&&(c.i=null,c.g.set(Ei(c,d),R(h)),c.h+=h.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],d=Array.from(this.g.keys());for(var h=0;h<d.length;h++){var g=d[h];let S=encodeURIComponent(String(g)),M=this.V(g);for(g=0;g<M.length;g++){var C=S;M[g]!==""&&(C+="="+encodeURIComponent(String(M[g]))),c.push(C)}}return this.i=c.join("&")};function Ei(c,d){return d=String(d),c.j&&(d=d.toLowerCase()),d}function e0(c,d){d&&!c.j&&(qn(c),c.i=null,c.g.forEach(function(h,g){var C=g.toLowerCase();g!=C&&(cv(this,g),lv(this,C,h))},c)),c.j=d}function t0(c,d){let h=new to;if(a.Image){let g=new Image;g.onload=D(zn,h,"TestLoadImage: loaded",!0,d,g),g.onerror=D(zn,h,"TestLoadImage: error",!1,d,g),g.onabort=D(zn,h,"TestLoadImage: abort",!1,d,g),g.ontimeout=D(zn,h,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=c}else d(!1)}function n0(c,d){let h=new to,g=new AbortController,C=setTimeout(()=>{g.abort(),zn(h,"TestPingServer: timeout",!1,d)},1e4);fetch(c,{signal:g.signal}).then(S=>{clearTimeout(C),S.ok?zn(h,"TestPingServer: ok",!0,d):zn(h,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(C),zn(h,"TestPingServer: error",!1,d)})}function zn(c,d,h,g,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),g(h)}catch{}}function r0(){this.g=new UA}function i0(c,d,h){let g=h||"";try{iv(c,function(C,S){let M=C;l(C)&&(M=Dd(C)),d.push(g+S+"="+encodeURIComponent(M))})}catch(C){throw d.push(g+"type="+encodeURIComponent("_badmap")),C}}function oo(c){this.l=c.Ub||null,this.j=c.eb||!1}A(oo,bd),oo.prototype.g=function(){return new uc(this.l,this.j)},oo.prototype.i=function(c){return function(){return c}}({});function uc(c,d){Je.call(this),this.D=c,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(uc,Je),t=uc.prototype,t.open=function(c,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=d,this.readyState=1,co(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(d.body=c),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,co(this)),this.g&&(this.readyState=3,co(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dv(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function dv(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var d=c.value?c.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!c.done}))&&(this.response=this.responseText+=d)}c.done?ao(this):co(this),this.readyState==3&&dv(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,ao(this))},t.Qa=function(c){this.g&&(this.response=c,ao(this))},t.ga=function(){this.g&&ao(this)};function ao(c){c.readyState=4,c.l=null,c.j=null,c.v=null,co(c)}t.setRequestHeader=function(c,d){this.u.append(c,d)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],d=this.h.entries();for(var h=d.next();!h.done;)h=h.value,c.push(h[0]+": "+h[1]),h=d.next();return c.join(`\r
`)};function co(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(uc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function hv(c){let d="";return he(c,function(h,g){d+=g,d+=":",d+=h,d+=`\r
`}),d}function Fd(c,d,h){e:{for(g in h){var g=!1;break e}g=!0}g||(h=hv(h),typeof c=="string"?h!=null&&encodeURIComponent(String(h)):Ee(c,d,h))}function Se(c){Je.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(Se,Je);var s0=/^https?$/i,o0=["POST","PUT"];t=Se.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,d,h,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);d=d?d.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Rd.g(),this.v=this.o?B_(this.o):B_(Rd),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(c),!0),this.B=!1}catch(S){fv(this,S);return}if(c=h||"",h=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var C in g)h.set(C,g[C]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let S of g.keys())h.set(S,g.get(S));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(h.keys()).find(S=>S.toLowerCase()=="content-type"),C=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(o0,d,void 0))||g||C||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,M]of h)this.g.setRequestHeader(S,M);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{mv(this),this.u=!0,this.g.send(c),this.u=!1}catch(S){fv(this,S)}};function fv(c,d){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=d,c.m=5,pv(c),lc(c)}function pv(c){c.A||(c.A=!0,ct(c,"complete"),ct(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,ct(this,"complete"),ct(this,"abort"),lc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),lc(this,!0)),Se.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?gv(this):this.bb())},t.bb=function(){gv(this)};function gv(c){if(c.h&&typeof o<"u"&&(!c.v[1]||In(c)!=4||c.Z()!=2)){if(c.u&&In(c)==4)L_(c.Ea,0,c);else if(ct(c,"readystatechange"),In(c)==4){c.h=!1;try{let M=c.Z();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var h;if(!(h=d)){var g;if(g=M===0){var C=String(c.D).match(sv)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),g=!s0.test(C?C.toLowerCase():"")}h=g}if(h)ct(c,"complete"),ct(c,"success");else{c.m=6;try{var S=2<In(c)?c.g.statusText:""}catch{S=""}c.l=S+" ["+c.Z()+"]",pv(c)}}finally{lc(c)}}}}function lc(c,d){if(c.g){mv(c);let h=c.g,g=c.v[0]?()=>{}:null;c.g=null,c.v=null,d||ct(c,"ready");try{h.onreadystatechange=g}catch{}}}function mv(c){c.I&&(a.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function In(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<In(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var d=this.g.responseText;return c&&d.indexOf(c)==0&&(d=d.substring(c.length)),VA(d)}};function yv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function a0(c){let d={};c=(c.g&&2<=In(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<c.length;g++){if(K(c[g]))continue;var h=E(c[g]);let C=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let S=d[C]||[];d[C]=S,S.push(h)}I(d,function(g){return g.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function uo(c,d,h){return h&&h.internalChannelParams&&h.internalChannelParams[c]||d}function _v(c){this.Aa=0,this.i=[],this.j=new to,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=uo("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=uo("baseRetryDelayMs",5e3,c),this.cb=uo("retryDelaySeedMs",1e4,c),this.Wa=uo("forwardChannelMaxRetries",2,c),this.wa=uo("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Z_(c&&c.concurrentRequestLimit),this.Da=new r0,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=_v.prototype,t.la=8,t.G=1,t.connect=function(c,d,h,g){ut(0),this.W=c,this.H=d||{},h&&g!==void 0&&(this.H.OSID=h,this.H.OAID=g),this.F=this.X,this.I=Sv(this,null,this.W),hc(this)};function Ld(c){if(vv(c),c.G==3){var d=c.U++,h=wn(c.I);if(Ee(h,"SID",c.K),Ee(h,"RID",d),Ee(h,"TYPE","terminate"),lo(c,h),d=new Hn(c,c.j,d),d.L=2,d.v=cc(wn(h)),h=!1,a.navigator&&a.navigator.sendBeacon)try{h=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!h&&a.Image&&(new Image().src=d.v,h=!0),h||(d.g=Av(d.j,null),d.g.ea(d.v)),d.F=Date.now(),sc(d)}bv(c)}function dc(c){c.g&&(Ud(c),c.g.cancel(),c.g=null)}function vv(c){dc(c),c.u&&(a.clearTimeout(c.u),c.u=null),fc(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function hc(c){if(!ev(c.h)&&!c.s){c.s=!0;var d=c.Ga;Gs||x_(),Ks||(Gs(),Ks=!0),md.add(d,c),c.B=0}}function c0(c,d){return tv(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=d.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=eo(m(c.Ga,c,d),Dv(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let C=new Hn(this,this.j,c),S=this.o;if(this.S&&(S?(S=y(S),w(S,this.S)):S=this.S),this.m!==null||this.O||(C.H=S,S=null),this.P)e:{for(var d=0,h=0;h<this.i.length;h++){t:{var g=this.i[h];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=h;break e}if(d===4096||h===this.i.length-1){d=h+1;break e}}d=1e3}else d=1e3;d=Iv(this,C,d),h=wn(this.I),Ee(h,"RID",c),Ee(h,"CVER",22),this.D&&Ee(h,"X-HTTP-Session-Id",this.D),lo(this,h),S&&(this.O?d="headers="+encodeURIComponent(String(hv(S)))+"&"+d:this.m&&Fd(h,this.m,S)),Od(this.h,C),this.Ua&&Ee(h,"TYPE","init"),this.P?(Ee(h,"$req",d),Ee(h,"SID","null"),C.T=!0,xd(C,h,null)):xd(C,h,d),this.G=2}}else this.G==3&&(c?wv(this,c):this.i.length==0||ev(this.h)||wv(this))};function wv(c,d){var h;d?h=d.l:h=c.U++;let g=wn(c.I);Ee(g,"SID",c.K),Ee(g,"RID",h),Ee(g,"AID",c.T),lo(c,g),c.m&&c.o&&Fd(g,c.m,c.o),h=new Hn(c,c.j,h,c.B+1),c.m===null&&(h.H=c.o),d&&(c.i=d.D.concat(c.i)),d=Iv(c,h,1e3),h.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Od(c.h,h),xd(h,g,d)}function lo(c,d){c.H&&he(c.H,function(h,g){Ee(d,g,h)}),c.l&&iv({},function(h,g){Ee(d,g,h)})}function Iv(c,d,h){h=Math.min(c.i.length,h);var g=c.l?m(c.l.Na,c.l,c):null;e:{var C=c.i;let S=-1;for(;;){let M=["count="+h];S==-1?0<h?(S=C[0].g,M.push("ofs="+S)):S=0:M.push("ofs="+S);let _e=!0;for(let Ge=0;Ge<h;Ge++){let ue=C[Ge].g,Xe=C[Ge].map;if(ue-=S,0>ue)S=Math.max(0,C[Ge].g-100),_e=!1;else try{i0(Xe,M,"req"+ue+"_")}catch{g&&g(Xe)}}if(_e){g=M.join("&");break e}}}return c=c.i.splice(0,h),d.D=c,g}function Ev(c){if(!c.g&&!c.u){c.Y=1;var d=c.Fa;Gs||x_(),Ks||(Gs(),Ks=!0),md.add(d,c),c.v=0}}function Vd(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=eo(m(c.Fa,c),Dv(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,Tv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=eo(m(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ut(10),dc(this),Tv(this))};function Ud(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function Tv(c){c.g=new Hn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var d=wn(c.qa);Ee(d,"RID","rpc"),Ee(d,"SID",c.K),Ee(d,"AID",c.T),Ee(d,"CI",c.F?"0":"1"),!c.F&&c.ja&&Ee(d,"TO",c.ja),Ee(d,"TYPE","xmlhttp"),lo(c,d),c.m&&c.o&&Fd(d,c.m,c.o),c.L&&(c.g.I=c.L);var h=c.g;c=c.ia,h.L=1,h.v=cc(wn(d)),h.m=null,h.P=!0,Y_(h,c)}t.Za=function(){this.C!=null&&(this.C=null,dc(this),Vd(this),ut(19))};function fc(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function Cv(c,d){var h=null;if(c.g==d){fc(c),Ud(c),c.g=null;var g=2}else if(kd(c.h,d))h=d.D,nv(c.h,d),g=1;else return;if(c.G!=0){if(d.o)if(g==1){h=d.m?d.m.length:0,d=Date.now()-d.F;var C=c.B;g=nc(),ct(g,new W_(g,h)),hc(c)}else Ev(c);else if(C=d.s,C==3||C==0&&0<d.X||!(g==1&&c0(c,d)||g==2&&Vd(c)))switch(h&&0<h.length&&(d=c.h,d.i=d.i.concat(h)),C){case 1:Dr(c,5);break;case 4:Dr(c,10);break;case 3:Dr(c,6);break;default:Dr(c,2)}}}function Dv(c,d){let h=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(h*=2),h*d}function Dr(c,d){if(c.j.info("Error code "+d),d==2){var h=m(c.fb,c),g=c.Xa;let C=!g;g=new Cr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||oc(g,"https"),cc(g),C?t0(g.toString(),h):n0(g.toString(),h)}else ut(2);c.G=0,c.l&&c.l.sa(d),bv(c),vv(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function bv(c){if(c.G=0,c.ka=[],c.l){let d=rv(c.h);(d.length!=0||c.i.length!=0)&&(x(c.ka,d),x(c.ka,c.i),c.h.i.length=0,R(c.i),c.i.length=0),c.l.ra()}}function Sv(c,d,h){var g=h instanceof Cr?wn(h):new Cr(h);if(g.g!="")d&&(g.g=d+"."+g.g),ac(g,g.s);else{var C=a.location;g=C.protocol,d=d?d+"."+C.hostname:C.hostname,C=+C.port;var S=new Cr(null);g&&oc(S,g),d&&(S.g=d),C&&ac(S,C),h&&(S.l=h),g=S}return h=c.D,d=c.ya,h&&d&&Ee(g,h,d),Ee(g,"VER",c.la),lo(c,g),g}function Av(c,d,h){if(d&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=c.Ca&&!c.pa?new Se(new oo({eb:h})):new Se(c.pa),d.Ha(c.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rv(){}t=Rv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function pc(){}pc.prototype.g=function(c,d){return new gt(c,d)};function gt(c,d){Je.call(this),this.g=new _v(d),this.l=c,this.h=d&&d.messageUrlParams||null,c=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(c?c["X-WebChannel-Content-Type"]=d.messageContentType:c={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(c?c["X-WebChannel-Client-Profile"]=d.va:c={"X-WebChannel-Client-Profile":d.va}),this.g.S=c,(c=d&&d.Sb)&&!K(c)&&(this.g.m=c),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!K(d)&&(this.g.D=d,c=this.h,c!==null&&d in c&&(c=this.h,d in c&&delete c[d])),this.j=new Ti(this)}A(gt,Je),gt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gt.prototype.close=function(){Ld(this.g)},gt.prototype.o=function(c){var d=this.g;if(typeof c=="string"){var h={};h.__data__=c,c=h}else this.u&&(h={},h.__data__=Dd(c),c=h);d.i.push(new zA(d.Ya++,c)),d.G==3&&hc(d)},gt.prototype.N=function(){this.g.l=null,delete this.j,Ld(this.g),delete this.g,gt.aa.N.call(this)};function Nv(c){Sd.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var d=c.__sm__;if(d){e:{for(let h in d){c=h;break e}c=void 0}(this.i=c)&&(c=this.i,d=d!==null&&c in d?d[c]:void 0),this.data=d}else this.data=c}A(Nv,Sd);function xv(){Ad.call(this),this.status=1}A(xv,Ad);function Ti(c){this.g=c}A(Ti,Rv),Ti.prototype.ua=function(){ct(this.g,"a")},Ti.prototype.ta=function(c){ct(this.g,new Nv(c))},Ti.prototype.sa=function(c){ct(this.g,new xv)},Ti.prototype.ra=function(){ct(this.g,"b")},pc.prototype.createWebChannel=pc.prototype.g,gt.prototype.send=gt.prototype.o,gt.prototype.open=gt.prototype.m,gt.prototype.close=gt.prototype.close,$g=Fn.createWebChannelTransport=function(){return new pc},Bg=Fn.getStatEventTarget=function(){return nc()},jg=Fn.Event=Er,wl=Fn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},rc.NO_ERROR=0,rc.TIMEOUT=8,rc.HTTP_ERROR=6,Ia=Fn.ErrorCode=rc,G_.COMPLETE="complete",Ug=Fn.EventType=G_,$_.EventType=Xs,Xs.OPEN="a",Xs.CLOSE="b",Xs.ERROR="c",Xs.MESSAGE="d",Je.prototype.listen=Je.prototype.K,fs=Fn.WebChannel=$_,Vg=Fn.FetchXmlHttpFactory=oo,Se.prototype.listenOnce=Se.prototype.L,Se.prototype.getLastError=Se.prototype.Ka,Se.prototype.getLastErrorCode=Se.prototype.Ba,Se.prototype.getStatus=Se.prototype.Z,Se.prototype.getResponseJson=Se.prototype.Oa,Se.prototype.getResponseText=Se.prototype.oa,Se.prototype.send=Se.prototype.ea,Se.prototype.setWithCredentials=Se.prototype.Ha,Lg=Fn.XhrIo=Se}).apply(typeof vl<"u"?vl:typeof self<"u"?self:typeof window<"u"?window:{});var _D="@firebase/firestore";var $e=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};$e.UNAUTHENTICATED=new $e(null),$e.GOOGLE_CREDENTIALS=new $e("google-credentials-uid"),$e.FIRST_PARTY=new $e("first-party-uid"),$e.MOCK_USER=new $e("mock-user");var xs="10.12.1";var ai=new cn("@firebase/firestore");function Ea(){return ai.logLevel}function L(t,...e){if(ai.logLevel<=J.DEBUG){let n=e.map(uy);ai.debug(`Firestore (${xs}): ${t}`,...n)}}function ci(t,...e){if(ai.logLevel<=J.ERROR){let n=e.map(uy);ai.error(`Firestore (${xs}): ${t}`,...n)}}function bl(t,...e){if(ai.logLevel<=J.WARN){let n=e.map(uy);ai.warn(`Firestore (${xs}): ${t}`,...n)}}function uy(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function ee(t="Unexpected state"){let e=`FIRESTORE (${xs}) INTERNAL ASSERTION FAILED: `+t;throw ci(e),new Error(e)}function qe(t,e){t||ee()}function Te(t,e){return t}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},U=class extends Et{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ln=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Sl=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Wg=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n($e.UNAUTHENTICATED))}shutdown(){}},Gg=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Kg=class{constructor(e){this.t=e,this.currentUser=$e.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new Ln;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ln,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>T(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ln)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(qe(typeof r.accessToken=="string"),new Sl(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return qe(e===null||typeof e=="string"),new $e(e)}},Qg=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=$e.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Yg=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Qg(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n($e.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Jg=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Xg=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,L("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(qe(typeof n.token=="string"),this.R=n.token,new Jg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function aV(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Al=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=aV(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function Ie(t,e){return t<e?-1:t>e?1:0}function ys(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}var it=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new U(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new U(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new U(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ie(this.nanoseconds,e.nanoseconds):Ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Ne=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new it(0,0))}static max(){return new t(new it(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Rl=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&ee(),r===void 0?r=e.length-n:r>e.length-n&&ee(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},Me=class t extends Rl{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new U(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},cV=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Tt=class t extends Rl{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return cV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new U(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new U(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new U(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new U(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var X=class t{constructor(e){this.path=e}static fromPath(e){return new t(Me.fromString(e))}static fromName(e){return new t(Me.fromString(e).popFirst(5))}static empty(){return new t(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new Me(e.slice()))}};var Zg=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};Zg.UNKNOWN_ID=-1;function uV(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ne.fromTimestamp(r===1e9?new it(n+1,0):new it(n,r));return new ui(i,X.empty(),e)}function lV(t){return new ui(t.readTime,t.key,-1)}var ui=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(Ne.min(),X.empty(),-1)}static max(){return new t(Ne.max(),X.empty(),-1)}};function dV(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:Ie(t.largestBatchId,e.largestBatchId))}var hV="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",em=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function VD(t){return T(this,null,function*(){if(t.code!==N.FAILED_PRECONDITION||t.message!==hV)throw t;L("LocalStore","Unexpectedly lost primary lease")})}var P=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let l=u;n(e[l]).next(f=>{o[l]=f,++a,a===s&&r(o)},f=>i(f))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};function fV(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Gl(t){return t.name==="IndexedDbTransactionError"}var pV=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.se&&this.se(n),n}}return t.oe=-1,t})();function ly(t){return t==null}function Aa(t){return t===0&&1/t==-1/0}function gV(t){return typeof t=="number"&&Number.isInteger(t)&&!Aa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var mV=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Q3=[...mV,"documentOverlays"],yV=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],_V=yV,Y3=[..._V,"indexConfiguration","indexState","indexEntries"];function vD(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Pa(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function UD(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ct=class t{constructor(e,n){this.comparator=e,this.root=n||yn.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,yn.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gs(this.root,e,this.comparator,!1)}getReverseIterator(){return new gs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gs(this.root,e,this.comparator,!0)}},gs=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},yn=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ee();let e=this.left.check();if(e!==this.right.check())throw ee();return e+(this.isRed()?0:1)}};yn.EMPTY=null,yn.RED=!0,yn.BLACK=!1;yn.EMPTY=new class{constructor(){this.size=0}get key(){throw ee()}get value(){throw ee()}get color(){throw ee()}get left(){throw ee()}get right(){throw ee()}copy(e,n,r,i,s){return this}insert(e,n,r){return new yn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var dt=class t{constructor(e){this.comparator=e,this.data=new Ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Nl(this.data.getIterator())}getIteratorFrom(e){return new Nl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Nl=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var mn=class t{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new t([])}unionWith(e){let n=new dt(Tt.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ys(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var tm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var gr=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new tm("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};gr.EMPTY_BYTE_STRING=new gr("");var vV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mr(t){if(qe(!!t),typeof t=="string"){let e=0,n=vV.exec(t);if(qe(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ue(t.seconds),nanos:Ue(t.nanos)}}function Ue(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function _s(t){return typeof t=="string"?gr.fromBase64String(t):gr.fromUint8Array(t)}function dy(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function jD(t){let e=t.mapValue.fields.__previous_value__;return dy(e)?jD(e):e}function xl(t){let e=mr(t.mapValue.fields.__local_write_time__.timestampValue);return new it(e.seconds,e.nanos)}var nm=class{constructor(e,n,r,i,s,o,a,u,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}},rm=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Il={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function vs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?dy(t)?4:BD(t)?9007199254740991:10:ee()}function _n(t,e){if(t===e)return!0;let n=vs(t);if(n!==vs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return xl(t).isEqual(xl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=mr(i.timestampValue),a=mr(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return _s(i.bytesValue).isEqual(_s(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ue(i.geoPointValue.latitude)===Ue(s.geoPointValue.latitude)&&Ue(i.geoPointValue.longitude)===Ue(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ue(i.integerValue)===Ue(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ue(i.doubleValue),a=Ue(s.doubleValue);return o===a?Aa(o)===Aa(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ys(t.arrayValue.values||[],e.arrayValue.values||[],_n);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(vD(o)!==vD(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!_n(o[u],a[u])))return!1;return!0}(t,e);default:return ee()}}function Ra(t,e){return(t.values||[]).find(n=>_n(n,e))!==void 0}function ws(t,e){if(t===e)return 0;let n=vs(t),r=vs(e);if(n!==r)return Ie(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ie(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ue(s.integerValue||s.doubleValue),u=Ue(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return wD(t.timestampValue,e.timestampValue);case 4:return wD(xl(t),xl(e));case 5:return Ie(t.stringValue,e.stringValue);case 6:return function(s,o){let a=_s(s),u=_s(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){let f=Ie(a[l],u[l]);if(f!==0)return f}return Ie(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=Ie(Ue(s.latitude),Ue(o.latitude));return a!==0?a:Ie(Ue(s.longitude),Ue(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let l=0;l<a.length&&l<u.length;++l){let f=ws(a[l],u[l]);if(f)return f}return Ie(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Il.mapValue&&o===Il.mapValue)return 0;if(s===Il.mapValue)return 1;if(o===Il.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),l=o.fields||{},f=Object.keys(l);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){let m=Ie(u[p],f[p]);if(m!==0)return m;let D=ws(a[u[p]],l[f[p]]);if(D!==0)return D}return Ie(u.length,f.length)}(t.mapValue,e.mapValue);default:throw ee()}}function wD(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ie(t,e);let n=mr(t),r=mr(e),i=Ie(n.seconds,r.seconds);return i!==0?i:Ie(n.nanos,r.nanos)}function Is(t){return im(t)}function im(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=mr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return _s(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=im(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${im(n.fields[o])}`;return i+"}"}(t.mapValue):ee()}function sm(t){return!!t&&"integerValue"in t}function hy(t){return!!t&&"arrayValue"in t}function Cl(t){return!!t&&"mapValue"in t}function Ca(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Pa(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ca(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ca(t.arrayValue.values[n]);return e}return Object.assign({},t)}function BD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var gn=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Cl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ca(n)}setAll(e){let n=Tt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Ca(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Cl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return _n(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Cl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Pa(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Ca(this.value))}};function $D(t){let e=[];return Pa(t.fields,(n,r)=>{let i=new Tt([n]);if(Cl(r)){let s=$D(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new mn(e)}var Es=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,Ne.min(),Ne.min(),Ne.min(),gn.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,Ne.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,Ne.min(),Ne.min(),gn.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,Ne.min(),Ne.min(),gn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ts=class{constructor(e,n){this.position=e,this.inclusive=n}};function ID(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=X.comparator(X.fromName(o.referenceValue),n.key):r=ws(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function ED(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!_n(t.position[n],e.position[n]))return!1;return!0}var Cs=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function wV(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Pl=class{},He=class t extends Pl{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new am(e,n,r):n==="array-contains"?new lm(e,r):n==="in"?new dm(e,r):n==="not-in"?new hm(e,r):n==="array-contains-any"?new fm(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new cm(e,r):new um(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ws(n,this.value)):n!==null&&vs(this.value)===vs(n)&&this.matchesComparison(ws(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},yr=class t extends Pl{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new t(e,n)}matches(e){return HD(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function HD(t){return t.op==="and"}function qD(t){return IV(t)&&HD(t)}function IV(t){for(let e of t.filters)if(e instanceof yr)return!1;return!0}function om(t){if(t instanceof He)return t.field.canonicalString()+t.op.toString()+Is(t.value);if(qD(t))return t.filters.map(e=>om(e)).join(",");{let e=t.filters.map(n=>om(n)).join(",");return`${t.op}(${e})`}}function zD(t,e){return t instanceof He?function(r,i){return i instanceof He&&r.op===i.op&&r.field.isEqual(i.field)&&_n(r.value,i.value)}(t,e):t instanceof yr?function(r,i){return i instanceof yr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&zD(o,i.filters[a]),!0):!1}(t,e):void ee()}function WD(t){return t instanceof He?function(n){return`${n.field.canonicalString()} ${n.op} ${Is(n.value)}`}(t):t instanceof yr?function(n){return n.op.toString()+" {"+n.getFilters().map(WD).join(" ,")+"}"}(t):"Filter"}var am=class extends He{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){let n=X.comparator(e.key,this.key);return this.matchesComparison(n)}},cm=class extends He{constructor(e,n){super(e,"in",n),this.keys=GD("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},um=class extends He{constructor(e,n){super(e,"not-in",n),this.keys=GD("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function GD(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}var lm=class extends He{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return hy(n)&&Ra(n.arrayValue,this.value)}},dm=class extends He{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Ra(this.value.arrayValue,n)}},hm=class extends He{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ra(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Ra(this.value.arrayValue,n)}},fm=class extends He{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!hy(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ra(this.value.arrayValue,r))}};var pm=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function TD(t,e=null,n=[],r=[],i=null,s=null,o=null){return new pm(t,e,n,r,i,s,o)}function fy(t){let e=Te(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>om(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ly(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Is(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Is(r)).join(",")),e.ue=n}return e.ue}function py(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!wV(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!zD(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ED(t.startAt,e.startAt)&&ED(t.endAt,e.endAt)}var Ds=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function EV(t,e,n,r,i,s,o,a){return new Ds(t,e,n,r,i,s,o,a)}function TV(t){return new Ds(t)}function CD(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function CV(t){return t.collectionGroup!==null}function Da(t){let e=Te(t);if(e.ce===null){e.ce=[];let n=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new dt(Tt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Cs(s,r))}),n.has(Tt.keyField().canonicalString())||e.ce.push(new Cs(Tt.keyField(),r))}return e.ce}function si(t){let e=Te(t);return e.le||(e.le=DV(e,Da(t))),e.le}function DV(t,e){if(t.limitType==="F")return TD(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Cs(i.field,s)});let n=t.endAt?new Ts(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ts(t.startAt.position,t.startAt.inclusive):null;return TD(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function gm(t,e,n){return new Ds(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function KD(t,e){return py(si(t),si(e))&&t.limitType===e.limitType}function QD(t){return`${fy(si(t))}|lt:${t.limitType}`}function Ta(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>WD(i)).join(", ")}]`),ly(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Is(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Is(i)).join(",")),`Target(${r})`}(si(t))}; limitType=${t.limitType})`}function gy(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):X.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Da(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let l=ID(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,Da(r),i)||r.endAt&&!function(o,a,u){let l=ID(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,Da(r),i))}(t,e)}function bV(t){return(e,n)=>{let r=!1;for(let i of Da(t)){let s=SV(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function SV(t,e,n){let r=t.field.isKeyField()?X.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),l=a.data.field(s);return u!==null&&l!==null?ws(u,l):ee()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ee()}}var _r=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Pa(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return UD(this.inner)}size(){return this.innerSize}};var AV=new Ct(X.comparator);function Ml(){return AV}var YD=new Ct(X.comparator);function El(...t){let e=YD;for(let n of t)e=e.insert(n.key,n);return e}function JD(t){let e=YD;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ii(){return ba()}function XD(){return ba()}function ba(){return new _r(t=>t.toString(),(t,e)=>t.isEqual(e))}var RV=new Ct(X.comparator),NV=new dt(X.comparator);function rt(...t){let e=NV;for(let n of t)e=e.add(n);return e}var xV=new dt(Ie);function PV(){return xV}function ZD(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Aa(e)?"-0":e}}function eb(t){return{integerValue:""+t}}function MV(t,e){return gV(e)?eb(e):ZD(t,e)}var bs=class{constructor(){this._=void 0}};function kV(t,e,n){return t instanceof Ss?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&dy(s)&&(s=jD(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof li?nb(t,e):t instanceof di?rb(t,e):function(i,s){let o=tb(i,s),a=DD(o)+DD(i.Pe);return sm(o)&&sm(i.Pe)?eb(a):ZD(i.serializer,a)}(t,e)}function OV(t,e,n){return t instanceof li?nb(t,e):t instanceof di?rb(t,e):n}function tb(t,e){return t instanceof As?function(r){return sm(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Ss=class extends bs{},li=class extends bs{constructor(e){super(),this.elements=e}};function nb(t,e){let n=ib(e);for(let r of t.elements)n.some(i=>_n(i,r))||n.push(r);return{arrayValue:{values:n}}}var di=class extends bs{constructor(e){super(),this.elements=e}};function rb(t,e){let n=ib(e);for(let r of t.elements)n=n.filter(i=>!_n(i,r));return{arrayValue:{values:n}}}var As=class extends bs{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function DD(t){return Ue(t.integerValue||t.doubleValue)}function ib(t){return hy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function FV(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof li&&i instanceof li||r instanceof di&&i instanceof di?ys(r.elements,i.elements,_n):r instanceof As&&i instanceof As?_n(r.Pe,i.Pe):r instanceof Ss&&i instanceof Ss}(t.transform,e.transform)}var mm=class{constructor(e,n){this.version=e,this.transformResults=n}},oi=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Dl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Rs=class{};function sb(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new kl(t.key,oi.none()):new hi(t.key,t.data,oi.none());{let n=t.data,r=gn.empty(),i=new dt(Tt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Un(t.key,r,new mn(i.toArray()),oi.none())}}function LV(t,e,n){t instanceof hi?function(i,s,o){let a=i.value.clone(),u=SD(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Un?function(i,s,o){if(!Dl(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=SD(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(ob(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Sa(t,e,n,r){return t instanceof hi?function(s,o,a,u){if(!Dl(s.precondition,o))return a;let l=s.value.clone(),f=AD(s.fieldTransforms,u,o);return l.setAll(f),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Un?function(s,o,a,u){if(!Dl(s.precondition,o))return a;let l=AD(s.fieldTransforms,u,o),f=o.data;return f.setAll(ob(s)),f.setAll(l),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,a){return Dl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function VV(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=tb(r.transform,i||null);s!=null&&(n===null&&(n=gn.empty()),n.set(r.field,s))}return n||null}function bD(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ys(r,i,(s,o)=>FV(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var hi=class extends Rs{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Un=class extends Rs{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function ob(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function SD(t,e,n){let r=new Map;qe(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,OV(o,a,n[i]))}return r}function AD(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,kV(s,o,e))}return r}var kl=class extends Rs{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ym=class extends Rs{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var _m=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&LV(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Sa(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Sa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=XD();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=sb(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),rt())}isEqual(e){return this.batchId===e.batchId&&ys(this.mutations,e.mutations,(n,r)=>bD(n,r))&&ys(this.baseMutations,e.baseMutations,(n,r)=>bD(n,r))}},vm=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){qe(e.mutations.length===r.length);let i=function(){return RV}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var wm=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var xe,oe;function UV(t){switch(t){default:return ee();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function jV(t){if(t===void 0)return ci("GRPC error has no .code"),N.UNKNOWN;switch(t){case xe.OK:return N.OK;case xe.CANCELLED:return N.CANCELLED;case xe.UNKNOWN:return N.UNKNOWN;case xe.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case xe.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case xe.INTERNAL:return N.INTERNAL;case xe.UNAVAILABLE:return N.UNAVAILABLE;case xe.UNAUTHENTICATED:return N.UNAUTHENTICATED;case xe.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case xe.NOT_FOUND:return N.NOT_FOUND;case xe.ALREADY_EXISTS:return N.ALREADY_EXISTS;case xe.PERMISSION_DENIED:return N.PERMISSION_DENIED;case xe.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case xe.ABORTED:return N.ABORTED;case xe.OUT_OF_RANGE:return N.OUT_OF_RANGE;case xe.UNIMPLEMENTED:return N.UNIMPLEMENTED;case xe.DATA_LOSS:return N.DATA_LOSS;default:return ee()}}(oe=xe||(xe={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";var X3=new Fg([4294967295,4294967295],0);var Im=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function Em(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BV(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function $V(t,e){return Em(t,e.toTimestamp())}function ms(t){return qe(!!t),Ne.fromTimestamp(function(n){let r=mr(n);return new it(r.seconds,r.nanos)}(t))}function ab(t,e){return Tm(t,e).canonicalString()}function Tm(t,e){let n=function(i){return new Me(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function HV(t){let e=Me.fromString(t);return qe(JV(e)),e}function Cm(t,e){return ab(t.databaseId,e.path)}function qV(t){let e=HV(t);return e.length===4?Me.emptyPath():WV(e)}function zV(t){return new Me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function WV(t){return qe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function RD(t,e,n){return{name:Cm(t,e),fields:n.value.mapValue.fields}}function GV(t,e){let n;if(e instanceof hi)n={update:RD(t,e.key,e.value)};else if(e instanceof kl)n={delete:Cm(t,e.key)};else if(e instanceof Un)n={update:RD(t,e.key,e.data),updateMask:YV(e.fieldMask)};else{if(!(e instanceof ym))return ee();n={verify:Cm(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Ss)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof li)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof di)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof As)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ee()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:$V(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ee()}(t,e.precondition)),n}function KV(t,e){return t&&t.length>0?(qe(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ms(i.updateTime):ms(s);return o.isEqual(Ne.min())&&(o=ms(s)),new mm(o,i.transformResults||[])}(n,e))):[]}function QV(t){let e=qV(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){qe(r===1);let f=n.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];n.where&&(s=function(p){let m=cb(p);return m instanceof yr&&qD(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(A){return new Cs(ps(A.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,ly(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(p){let m=!!p.before,D=p.values||[];return new Ts(D,m)}(n.startAt));let l=null;return n.endAt&&(l=function(p){let m=!p.before,D=p.values||[];return new Ts(D,m)}(n.endAt)),EV(e,i,o,s,a,"F",u,l)}function cb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=ps(n.unaryFilter.field);return He.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ps(n.unaryFilter.field);return He.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ps(n.unaryFilter.field);return He.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ps(n.unaryFilter.field);return He.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ee()}}(t):t.fieldFilter!==void 0?function(n){return He.create(ps(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ee()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return yr.create(n.compositeFilter.filters.map(r=>cb(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ee()}}(n.compositeFilter.op))}(t):ee()}function ps(t){return Tt.fromServerFormat(t.fieldPath)}function YV(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function JV(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Dm=class{constructor(e){this.ct=e}};function XV(t){let e=QV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?gm(e,e.limit,"L"):e}var Ol=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Ue(e.integerValue));else if("doubleValue"in e){let r=Ue(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Aa(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"&&(r=mr(r)),n.At(`${r.seconds||""}`),n.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(_s(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?BD(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):ee()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),X.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};Ol.bt=new Ol;var bm=class{constructor(){this._n=new Sm}addToCollectionParentIndex(e,n){return this._n.add(n),P.resolve()}getCollectionParents(e,n){return P.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return P.resolve()}deleteFieldIndex(e,n){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,n){return P.resolve()}getDocumentsMatchingTarget(e,n){return P.resolve(null)}getIndexType(e,n){return P.resolve(0)}getFieldIndexes(e,n){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,n){return P.resolve(ui.min())}getMinOffsetFromCollectionGroup(e,n){return P.resolve(ui.min())}updateCollectionGroup(e,n,r){return P.resolve()}updateIndexEntries(e,n){return P.resolve()}},Sm=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new dt(Me.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new dt(Me.comparator)).toArray()}};var Z3=new Uint8Array(0);var pn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(41943040,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);var Na=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var Am=class{constructor(){this.changes=new _r(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Es.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?P.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Rm=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Nm=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Sa(r.mutation,i,mn.empty(),it.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,rt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=rt()){let i=ii();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=El();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=ii();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,rt()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Ml(),o=ba(),a=function(){return ba()}();return n.forEach((u,l)=>{let f=r.get(l.key);i.has(l.key)&&(f===void 0||f.mutation instanceof Un)?s=s.insert(l.key,l):f!==void 0?(o.set(l.key,f.mutation.getFieldMask()),Sa(f.mutation,l,f.mutation.getFieldMask(),it.now())):o.set(l.key,mn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,f)=>o.set(l,f)),n.forEach((l,f)=>{var p;return a.set(l,new Rm(f,(p=o.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,n){let r=ba(),i=new Ct((o,a)=>o-a),s=rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let l=n.get(u);if(l===null)return;let f=r.get(u)||mn.empty();f=a.applyToLocalView(l,f),r.set(u,f);let p=(i.get(a.batchId)||rt()).add(u);i=i.insert(a.batchId,p)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),l=u.key,f=u.value,p=XD();f.forEach(m=>{if(!s.has(m)){let D=sb(n.get(m),r.get(m));D!==null&&p.set(m,D),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return P.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return X.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):CV(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):P.resolve(ii()),a=-1,u=s;return o.next(l=>P.forEach(l,(f,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(f)?P.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{u=u.insert(f,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,rt())).next(f=>({batchId:a,changes:JD(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let i=El();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=El();return this.indexManager.getCollectionParents(e,s).next(a=>P.forEach(a,u=>{let l=function(p,m){return new Ds(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(f=>{f.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,l)=>{let f=l.getKey();o.get(f)===null&&(o=o.insert(f,Es.newInvalidDocument(f)))});let a=El();return o.forEach((u,l)=>{let f=s.get(u);f!==void 0&&Sa(f.mutation,l,mn.empty(),it.now()),gy(n,l)&&(a=a.insert(u,l))}),a})}};var xm=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return P.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ms(i.createTime)}}(n)),P.resolve()}getNamedQuery(e,n){return P.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:XV(i.bundledQuery),readTime:ms(i.readTime)}}(n)),P.resolve()}};var Pm=class{constructor(){this.overlays=new Ct(X.comparator),this.hr=new Map}getOverlay(e,n){return P.resolve(this.overlays.get(n))}getOverlays(e,n){let r=ii();return P.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),P.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),P.resolve()}getOverlaysForCollection(e,n,r){let i=ii(),s=n.length+1,o=new X(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return P.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ct((l,f)=>l-f),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let f=s.get(l.largestBatchId);f===null&&(f=ii(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}let a=ii(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,f)=>a.set(l,f)),!(a.size()>=i)););return P.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new wm(n,r));let s=this.hr.get(n);s===void 0&&(s=rt(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var xa=class{constructor(){this.Pr=new dt(Pe.Ir),this.Tr=new dt(Pe.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new Pe(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new Pe(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new X(new Me([])),r=new Pe(n,e),i=new Pe(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new X(new Me([])),r=new Pe(n,e),i=new Pe(n,e+1),s=rt();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new Pe(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},Pe=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return X.comparator(e.key,n.key)||Ie(e.pr,n.pr)}static Er(e,n){return Ie(e.pr,n.pr)||X.comparator(e.key,n.key)}};var Mm=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new dt(Pe.Ir)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new _m(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new Pe(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return P.resolve(o)}lookupMutationBatch(e,n){return P.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new Pe(n,0),i=new Pe(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new dt(Ie);return n.forEach(i=>{let s=new Pe(i,0),o=new Pe(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),P.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;X.isDocumentKey(s)||(s=s.child(""));let o=new Pe(new X(s),0),a=new dt(Ie);return this.wr.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.pr)),!0)},o),P.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){qe(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return P.forEach(n.mutations,i=>{let s=new Pe(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new Pe(n,0),i=this.wr.firstAfterOrEqual(r);return P.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var km=class{constructor(e){this.vr=e,this.docs=function(){return new Ct(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return P.resolve(r?r.document.mutableCopy():Es.newInvalidDocument(n))}getEntries(e,n){let r=Ml();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Es.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Ml(),o=n.path,a=new X(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:l,value:{document:f}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||dV(lV(f),r)<=0||(i.has(f.key)||gy(n,f))&&(s=s.insert(f.key,f.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ee()}Fr(e,n){return P.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Om(this)}getSize(e){return P.resolve(this.size)}},Om=class extends Am{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),P.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var Fm=class{constructor(e){this.persistence=e,this.Mr=new _r(n=>fy(n),py),this.lastRemoteSnapshotVersion=Ne.min(),this.highestTargetId=0,this.Or=0,this.Nr=new xa,this.targetCount=0,this.Lr=Na.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),P.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new Na(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,P.resolve()}updateTargetData(e,n){return this.qn(n),P.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return P.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),P.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),P.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return P.resolve(r)}containsKey(e,n){return P.resolve(this.Nr.containsKey(n))}};var Lm=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new pV(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Fm(this),this.indexManager=new bm,this.remoteDocumentCache=function(i){return new km(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Dm(n),this.$r=new xm(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Pm,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new Mm(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){L("MemoryPersistence","Starting transaction:",e);let i=new Vm(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return P.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},Vm=class extends em{constructor(e){super(),this.currentSequenceNumber=e}},Um=class t{constructor(e){this.persistence=e,this.zr=new xa,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw ee()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),P.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),P.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Jr,r=>{let i=X.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,Ne.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return P.or([()=>P.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var jm=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=rt(),i=rt();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var Bm=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var $m=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return tC()?8:fV(Ve())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Bm;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Ea()<=J.DEBUG&&L("QueryEngine","SDK will not create cache indexes for query:",Ta(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),P.resolve()):(Ea()<=J.DEBUG&&L("QueryEngine","Query:",Ta(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Ea()<=J.DEBUG&&L("QueryEngine","The SDK decides to create cache indexes for query:",Ta(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,si(n))):P.resolve())}ji(e,n){if(CD(n))return P.resolve(null);let r=si(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=gm(n,null,"F"),r=si(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=rt(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.Zi(n,a);return this.Xi(n,l,o,u.readTime)?this.ji(e,gm(n,null,"F")):this.es(e,l,n,u)}))})))}Hi(e,n,r,i){return CD(n)||i.isEqual(Ne.min())?P.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?P.resolve(null):(Ea()<=J.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ta(n)),this.es(e,o,n,uV(i,-1)).next(a=>a))})}Zi(e,n){let r=new dt(bV(e));return n.forEach((i,s)=>{gy(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Ea()<=J.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",Ta(n)),this.zi.getDocumentsMatchingQuery(e,n,ui.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Hm=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Ct(Ie),this.rs=new _r(s=>fy(s),py),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Nm(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function ZV(t,e,n,r){return new Hm(t,e,n,r)}function ub(t,e){return T(this,null,function*(){let n=Te(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=rt();for(let l of i){o.push(l.batchId);for(let f of l.mutations)u=u.add(f.key)}for(let l of s){a.push(l.batchId);for(let f of l.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(l=>({us:l,removedBatchIds:o,addedBatchIds:a}))})})})}function eU(t,e){let n=Te(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,u,l,f){let p=l.batch,m=p.keys(),D=P.resolve();return m.forEach(A=>{D=D.next(()=>f.getEntry(u,A)).next(R=>{let x=l.docVersions.get(A);qe(x!==null),R.version.compareTo(x)<0&&(p.applyToRemoteDocument(R,l),R.isValidDocument()&&(R.setReadTime(l.commitVersion),f.addEntry(R)))})}),D.next(()=>a.mutationQueue.removeMutationBatch(u,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=rt();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function tU(t){let e=Te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function nU(t,e){let n=Te(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}var Fl=class{constructor(){this.activeTargetIds=PV()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var qm=class{constructor(){this.no=new Fl,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Fl,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var zm=class{io(e){}shutdown(){}};var Ll=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){L("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){L("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Tl=null;function Hg(){return Tl===null?Tl=function(){return 268435456+Math.round(2147483648*Math.random())}():Tl++,"0x"+Tl.toString(16)}var rU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Wm=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var nt="WebChannelConnection",Gm=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+n.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(n,r,i,s,o){let a=Hg(),u=this.vo(n,r.toUriEncodedString());L("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let l={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(l,s,o),this.Mo(n,u,l,i).then(f=>(L("RestConnection",`Received RPC '${n}' ${a}: `,f),f),f=>{throw bl("RestConnection",`RPC '${n}' ${a} failed with error: `,f,"url: ",u,"request:",i),f})}xo(n,r,i,s,o,a){return this.Co(n,r,i,s,o)}Fo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xs}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}vo(n,r){let i=rU[n];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,n,r,i){let s=Hg();return new Promise((o,a)=>{let u=new Lg;u.setWithCredentials(!0),u.listenOnce(Ug.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ia.NO_ERROR:let f=u.getResponseJson();L(nt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case Ia.TIMEOUT:L(nt,`RPC '${e}' ${s} timed out`),a(new U(N.DEADLINE_EXCEEDED,"Request time out"));break;case Ia.HTTP_ERROR:let p=u.getStatus();if(L(nt,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);let D=m?.error;if(D&&D.status&&D.message){let A=function(x){let V=x.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(V)>=0?V:N.UNKNOWN}(D.status);a(new U(A,D.message))}else a(new U(N.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new U(N.UNAVAILABLE,"Connection failed."));break;default:ee()}}finally{L(nt,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);L(nt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",l,r,15)})}Oo(e,n,r){let i=Hg(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=$g(),a=Bg(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new Vg({})),this.Fo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let f=s.join("");L(nt,`Creating RPC '${e}' stream ${i}: ${f}`,u);let p=o.createWebChannel(f,u),m=!1,D=!1,A=new Wm({lo:x=>{D?L(nt,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(m||(L(nt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),L(nt,`RPC '${e}' stream ${i} sending:`,x),p.send(x))},ho:()=>p.close()}),R=(x,V,K)=>{x.listen(V,B=>{try{K(B)}catch(de){setTimeout(()=>{throw de},0)}})};return R(p,fs.EventType.OPEN,()=>{D||(L(nt,`RPC '${e}' stream ${i} transport opened.`),A.mo())}),R(p,fs.EventType.CLOSE,()=>{D||(D=!0,L(nt,`RPC '${e}' stream ${i} transport closed`),A.po())}),R(p,fs.EventType.ERROR,x=>{D||(D=!0,bl(nt,`RPC '${e}' stream ${i} transport errored:`,x),A.po(new U(N.UNAVAILABLE,"The operation could not be completed")))}),R(p,fs.EventType.MESSAGE,x=>{var V;if(!D){let K=x.data[0];qe(!!K);let B=K,de=B.error||((V=B[0])===null||V===void 0?void 0:V.error);if(de){L(nt,`RPC '${e}' stream ${i} received error:`,de);let We=de.status,he=function(_){let w=xe[_];if(w!==void 0)return jV(w)}(We),I=de.message;he===void 0&&(he=N.INTERNAL,I="Unknown error status: "+We+" with message "+de.message),D=!0,A.po(new U(he,I)),p.close()}else L(nt,`RPC '${e}' stream ${i} received:`,K),A.yo(K)}}),R(a,jg.STAT_EVENT,x=>{x.stat===wl.PROXY?L(nt,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===wl.NOPROXY&&L(nt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.fo()},0),A}};function qg(){return typeof document<"u"?document:null}function Kl(t){return new Im(t,!0)}var Vl=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let n=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,n-r);i>0&&L("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var Km=class{constructor(e,n,r,i,s,o,a,u){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Vl(e,n)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return T(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return T(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,n){return T(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():n&&n.code===N.RESOURCE_EXHAUSTED?(ci(n.toString()),ci("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):n&&n.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(n)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),n=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===n&&this.u_(r,i)},r=>{e(()=>{let i=new U(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,n){let r=this.a_(this.jo);this.stream=this.l_(e,n),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>T(this,null,function*(){this.state=0,this.start()}))}c_(e){return L("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return n=>{this.oi.enqueueAndForget(()=>this.jo===e?n():(L("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var Qm=class extends Km{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,n){return this.connection.Oo("Write",e,n)}onMessage(e){if(qe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let n=KV(e.writeResults,e.commitTime),r=ms(e.commitTime);return this.listener.A_(r,n)}return qe(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=zV(this.serializer),this.i_(e)}d_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>GV(this.serializer,r))};this.i_(n)}};var Ym=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new U(N.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,n,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,Tm(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new U(N.UNKNOWN,s.toString())})}xo(e,n,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,Tm(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new U(N.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},Jm=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(ci(n),this.y_=!1):L("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var Xm=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>T(this,null,function*(){ka(this)&&(L("RemoteStore","Restarting streams for network reachability change."),yield function(u){return T(this,null,function*(){let l=Te(u);l.M_.add(4),yield Ma(l),l.N_.set("Unknown"),l.M_.delete(4),yield Ql(l)})}(this))}))}),this.N_=new Jm(r,i)}};function Ql(t){return T(this,null,function*(){if(ka(t))for(let e of t.x_)yield e(!0)})}function Ma(t){return T(this,null,function*(){for(let e of t.x_)yield e(!1)})}function ka(t){return Te(t).M_.size===0}function lb(t,e,n){return T(this,null,function*(){if(!Gl(e))throw e;t.M_.add(1),yield Ma(t),t.N_.set("Offline"),n||(n=()=>tU(t.localStore)),t.asyncQueue.enqueueRetryable(()=>T(this,null,function*(){L("RemoteStore","Retrying IndexedDB access"),yield n(),t.M_.delete(1),yield Ql(t)}))})}function db(t,e){return e().catch(n=>lb(t,n,e))}function Yl(t){return T(this,null,function*(){let e=Te(t),n=vr(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;iU(e);)try{let i=yield nU(e.localStore,r);if(i===null){e.v_.length===0&&n.n_();break}r=i.batchId,sU(e,i)}catch(i){yield lb(e,i)}hb(e)&&fb(e)})}function iU(t){return ka(t)&&t.v_.length<10}function sU(t,e){t.v_.push(e);let n=vr(t);n.Xo()&&n.E_&&n.d_(e.mutations)}function hb(t){return ka(t)&&!vr(t).Zo()&&t.v_.length>0}function fb(t){vr(t).start()}function oU(t){return T(this,null,function*(){vr(t).V_()})}function aU(t){return T(this,null,function*(){let e=vr(t);for(let n of t.v_)e.d_(n.mutations)})}function cU(t,e,n){return T(this,null,function*(){let r=t.v_.shift(),i=vm.from(r,e,n);yield db(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Yl(t)})}function uU(t,e){return T(this,null,function*(){e&&vr(t).E_&&(yield function(r,i){return T(this,null,function*(){if(function(o){return UV(o)&&o!==N.ABORTED}(i.code)){let s=r.v_.shift();vr(r).t_(),yield db(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Yl(r)}})}(t,e)),hb(t)&&fb(t)})}function ND(t,e){return T(this,null,function*(){let n=Te(t);n.asyncQueue.verifyOperationInProgress(),L("RemoteStore","RemoteStore received new credentials");let r=ka(n);n.M_.add(3),yield Ma(n),r&&n.N_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),yield Ql(n)})}function lU(t,e){return T(this,null,function*(){let n=Te(t);e?(n.M_.delete(2),yield Ql(n)):e||(n.M_.add(2),yield Ma(n),n.N_.set("Unknown"))})}function vr(t){return t.k_||(t.k_=function(n,r,i){let s=Te(n);return s.f_(),new Qm(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:()=>Promise.resolve(),To:oU.bind(null,t),Ao:uU.bind(null,t),R_:aU.bind(null,t),A_:cU.bind(null,t)}),t.x_.push(e=>T(this,null,function*(){e?(t.k_.t_(),yield Yl(t)):(yield t.k_.stop(),t.v_.length>0&&(L("RemoteStore",`Stopping write stream with ${t.v_.length} pending writes`),t.v_=[]))}))),t.k_}var Zm=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ln,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function pb(t,e){if(ci("AsyncQueue",`${e}: ${t}`),Gl(t))return new U(N.UNAVAILABLE,`${e}: ${t}`);throw t}var ey=class{constructor(){this.queries=new _r(e=>QD(e),KD),this.onlineState="Unknown",this.z_=new Set}};function dU(t){t.z_.forEach(e=>{e.next()})}var xD,PD;(PD=xD||(xD={})).J_="default",PD.Cache="cache";var ty=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new _r(a=>QD(a),KD),this.Da=new Map,this.Ca=new Set,this.va=new Ct(X.comparator),this.Fa=new Map,this.Ma=new xa,this.xa={},this.Oa=new Map,this.Na=Na.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function hU(t,e,n){return T(this,null,function*(){let r=mU(t);try{let i=yield function(o,a){let u=Te(o),l=it.now(),f=a.reduce((D,A)=>D.add(A.key),rt()),p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",D=>{let A=Ml(),R=rt();return u.os.getEntries(D,f).next(x=>{A=x,A.forEach((V,K)=>{K.isValidDocument()||(R=R.add(V))})}).next(()=>u.localDocuments.getOverlayedDocuments(D,A)).next(x=>{p=x;let V=[];for(let K of a){let B=VV(K,p.get(K.key).overlayedDocument);B!=null&&V.push(new Un(K.key,B,$D(B.value.mapValue),oi.exists(!0)))}return u.mutationQueue.addMutationBatch(D,l,V,a)}).next(x=>{m=x;let V=x.applyToLocalDocumentSet(p,R);return u.documentOverlayCache.saveOverlays(D,x.batchId,V)})}).then(()=>({batchId:m.batchId,changes:JD(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.xa[o.currentUser.toKey()];l||(l=new Ct(Ie)),l=l.insert(a,u),o.xa[o.currentUser.toKey()]=l}(r,i.batchId,n),yield Jl(r,i.changes),yield Yl(r.remoteStore)}catch(i){let s=pb(i,"Failed to persist write");n.reject(s)}})}function MD(t,e,n){let r=Te(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=Te(o);u.onlineState=a;let l=!1;u.queries.forEach((f,p)=>{for(let m of p.U_)m.j_(a)&&(l=!0)}),l&&dU(u)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function fU(t,e){return T(this,null,function*(){let n=Te(t),r=e.batch.batchId;try{let i=yield eU(n.localStore,e);mb(n,r,null),gb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Jl(n,i)}catch(i){yield VD(i)}})}function pU(t,e,n){return T(this,null,function*(){let r=Te(t);try{let i=yield function(o,a){let u=Te(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let f;return u.mutationQueue.lookupMutationBatch(l,a).next(p=>(qe(p!==null),f=p.keys(),u.mutationQueue.removeMutationBatch(l,p))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,f,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,f)).next(()=>u.localDocuments.getDocuments(l,f))})}(r.localStore,e);mb(r,e,n),gb(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Jl(r,i)}catch(i){yield VD(i)}})}function gb(t,e){(t.Oa.get(e)||[]).forEach(n=>{n.resolve()}),t.Oa.delete(e)}function mb(t,e,n){let r=Te(t),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function Jl(t,e,n){return T(this,null,function*(){let r=Te(t),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,u)=>{o.push(r.Ba(u,e,n).then(l=>{if((l||n)&&r.isPrimaryClient){let f=l&&!l.fromCache;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(l){i.push(l);let f=jm.Ki(u.targetId,l);s.push(f)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(u,l){return T(this,null,function*(){let f=Te(u);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>P.forEach(l,m=>P.forEach(m.qi,D=>f.persistence.referenceDelegate.addReference(p,m.targetId,D)).next(()=>P.forEach(m.Qi,D=>f.persistence.referenceDelegate.removeReference(p,m.targetId,D)))))}catch(p){if(!Gl(p))throw p;L("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let D=f.ns.get(m),A=D.snapshotVersion,R=D.withLastLimboFreeSnapshotVersion(A);f.ns=f.ns.insert(m,R)}}})}(r.localStore,s))})}function gU(t,e){return T(this,null,function*(){let n=Te(t);if(!n.currentUser.isEqual(e)){L("SyncEngine","User change. New user:",e.toKey());let r=yield ub(n.localStore,e);n.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(u=>{u.reject(new U(N.CANCELLED,o))})}),s.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Jl(n,r.us)}})}function mU(t){let e=Te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pU.bind(null,e),e}var Ul=class{constructor(){this.synchronizeTabs=!1}initialize(e){return T(this,null,function*(){this.serializer=Kl(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return ZV(this.persistence,new $m,e.initialUser,this.serializer)}createPersistence(e){return new Lm(Um.Hr,this.serializer)}createSharedClientState(e){return new qm}terminate(){return T(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var ny=class{initialize(e,n){return T(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>MD(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=gU.bind(null,this.syncEngine),yield lU(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new ey}()}createDatastore(e){let n=Kl(e.databaseInfo.databaseId),r=function(s){return new Gm(s)}(e.databaseInfo);return function(s,o,a,u){return new Ym(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Xm(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>MD(this.syncEngine,n,0),function(){return Ll.D()?new Ll:new zm}())}createSyncEngine(e,n){return function(i,s,o,a,u,l,f){let p=new ty(i,s,o,a,u,l);return f&&(p.La=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return T(this,null,function*(){var e;yield function(r){return T(this,null,function*(){let i=Te(r);L("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield Ma(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};var ry=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=$e.UNAUTHENTICATED,this.clientId=Al.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>T(this,null,function*(){L("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(L("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new U(N.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ln;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>T(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=pb(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function zg(t,e){return T(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),L("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>T(this,null,function*(){r.isEqual(i)||(yield ub(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function kD(t,e){return T(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield _U(t);L("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>ND(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>ND(e.remoteStore,i)),t._onlineComponents=e})}function yU(t){return t.name==="FirebaseError"?t.code===N.FAILED_PRECONDITION||t.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function _U(t){return T(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){L("FirestoreClient","Using user provided OfflineComponentProvider");try{yield zg(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!yU(n))throw n;bl("Error using user provided cache. Falling back to memory cache: "+n),yield zg(t,new Ul)}}else L("FirestoreClient","Using default OfflineComponentProvider"),yield zg(t,new Ul);return t._offlineComponents})}function vU(t){return T(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(L("FirestoreClient","Using user provided OnlineComponentProvider"),yield kD(t,t._uninitializedComponentsProvider._online)):(L("FirestoreClient","Using default OnlineComponentProvider"),yield kD(t,new ny))),t._onlineComponents})}function wU(t){return vU(t).then(e=>e.syncEngine)}function yb(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var OD=new Map;function _b(t,e,n){if(!n)throw new U(N.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function IU(t,e,n,r){if(e===!0&&r===!0)throw new U(N.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function FD(t){if(!X.isDocumentKey(t))throw new U(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function LD(t){if(X.isDocumentKey(t))throw new U(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function my(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ee()}function vb(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new U(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=my(t);throw new U(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}var jl=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new U(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new U(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yb((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new U(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ns=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jl({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new U(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new U(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jl(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Wg;switch(r.type){case"firstParty":return new Yg(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new U(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=OD.get(n);r&&(L("ComponentProvider","Removing Datastore"),OD.delete(n),r.terminate())}(this),Promise.resolve()}};function wb(t,e,n,r={}){var i;let s=(t=vb(t,Ns))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&bl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=$e.MOCK_USER;else{a=Ku(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new U(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new $e(l)}t._authCredentials=new Gg(new Sl(a,u))}}var iy=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Vn=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},pr=class t extends iy{constructor(e,n,r){super(e,n,TV(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Vn(this.firestore,null,new X(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function Ib(t,e,...n){if(t=tt(t),_b("collection","path",e),t instanceof Ns){let r=Me.fromString(e,...n);return LD(r),new pr(t,null,r)}{if(!(t instanceof Vn||t instanceof pr))throw new U(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(Me.fromString(e,...n));return LD(r),new pr(t.firestore,null,r)}}function Eb(t,e,...n){if(t=tt(t),arguments.length===1&&(e=Al.newId()),_b("doc","path",e),t instanceof Ns){let r=Me.fromString(e,...n);return FD(r),new Vn(t,null,new X(r))}{if(!(t instanceof Vn||t instanceof pr))throw new U(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(Me.fromString(e,...n));return FD(r),new Vn(t.firestore,t instanceof pr?t.converter:null,new X(r))}}var sy=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Vl(this,"async_queue_retry"),this.hu=()=>{let n=qg();n&&L("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Yo.Wo()};let e=qg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let n=qg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let n=new Ln;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return T(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Gl(e))throw e;L("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ci("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);let i=Zm.createAndSchedule(this,e,n,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&ee()}verifyOperationInProgress(){}du(){return T(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let n=this._u.indexOf(e);this._u.splice(n,1)}};var Bl=class extends Ns{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new sy}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Cb(this),this._firestoreClient.terminate()}};function Tb(t,e){let n=typeof t=="object"?t:cr(),r=typeof t=="string"?t:e||"(default)",i=Yr(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Gu("firestore");s&&wb(i,...s)}return i}function EU(t){return t._firestoreClient||Cb(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Cb(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,l,f){return new nm(a,u,l,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,yb(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new ry(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var $l=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(gr.fromBase64String(e))}catch(n){throw new U(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(gr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Hl=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new U(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ql=class{constructor(e){this._methodName=e}};var zl=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new U(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new U(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ie(this._lat,e._lat)||Ie(this._long,e._long)}};var TU=/^__.*__$/,oy=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Un(e,this.data,this.fieldMask,n,this.fieldTransforms):new hi(e,this.data,n,this.fieldTransforms)}};function Db(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ee()}}var ay=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Wl(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(Db(this.fu)&&TU.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},cy=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Kl(e)}Fu(e,n,r,i=!1){return new ay({fu:e,methodName:n,vu:r,path:Tt.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function CU(t){let e=t._freezeSettings(),n=Kl(t._databaseId);return new cy(t._databaseId,!!e.ignoreUndefinedProperties,n)}function DU(t,e,n,r,i,s={}){let o=t.Fu(s.merge||s.mergeFields?2:0,e,n,i);Rb("Data must be an object, but it was:",o,r);let a=Sb(r,o),u,l;if(s.merge)u=new mn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let p of s.mergeFields){let m=bU(e,p,n);if(!o.contains(m))throw new U(N.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);RU(f,m)||f.push(m)}u=new mn(f),l=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,l=o.fieldTransforms;return new oy(new gn(a),u,l)}function bb(t,e){if(Ab(t=tt(t)))return Rb("Unsupported field value:",e,t),Sb(t,e);if(t instanceof ql)return function(r,i){if(!Db(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=bb(a,i.bu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=tt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return MV(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=it.fromDate(r);return{timestampValue:Em(i.serializer,s)}}if(r instanceof it){let s=new it(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Em(i.serializer,s)}}if(r instanceof zl)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $l)return{bytesValue:BV(i.serializer,r._byteString)};if(r instanceof Vn){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ab(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${my(r)}`)}(t,e)}function Sb(t,e){let n={};return UD(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pa(t,(r,i)=>{let s=bb(i,e.pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Ab(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof it||t instanceof zl||t instanceof $l||t instanceof Vn||t instanceof ql)}function Rb(t,e,n){if(!Ab(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=my(n);throw r==="an object"?e.Du(t+" a custom object"):e.Du(t+" "+r)}}function bU(t,e,n){if((e=tt(e))instanceof Hl)return e._internalPath;if(typeof e=="string")return AU(t,e);throw Wl("Field path arguments must be of type string or ",t,!1,void 0,n)}var SU=new RegExp("[~\\*/\\[\\]]");function AU(t,e,n){if(e.search(SU)>=0)throw Wl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Hl(...e.split("."))._internalPath}catch{throw Wl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Wl(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new U(N.INVALID_ARGUMENT,a+t+u)}function RU(t,e){return t.some(n=>n.isEqual(e))}function NU(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function Nb(t,e){let n=vb(t.firestore,Bl),r=Eb(t),i=NU(t.converter,e);return xU(n,[DU(CU(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,oi.exists(!1))]).then(()=>r)}function xU(t,e){return function(r,i){let s=new Ln;return r.asyncQueue.enqueueAndForget(()=>T(this,null,function*(){return hU(yield wU(r),i,s)})),s.promise}(EU(t),e)}(function(e,n=!0){(function(i){xs=i})(dn),ln(new ft("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Bl(new Kg(r.getProvider("auth-internal")),new Xg(r.getProvider("app-check-internal")),function(l,f){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new U(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rm(l.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),De(_D,"4.6.3",e),De(_D,"4.6.3","esm2017")})();var fi=class{constructor(e){return e}},xb="firestore",yy=class{constructor(){return Xr(xb)}};var _y=new G("angularfire2.firestore-instances");function PU(t,e){let n=ls(xb,t,e);return n&&new fi(n)}function MU(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new fi(r)}}var kU={provide:yy,deps:[[new Le,_y]]},OU={provide:fi,useFactory:PU,deps:[[new Le,_y],Wt]};function Pb(t,...e){return De("angularfire",Pn.full,"fst"),xt([OU,kU,{provide:_y,useFactory:MU(t),multi:!0,deps:[fe,vt,lr,Mn,[new Le,ri],[new Le,ur],...e]}])}var Mb=hn(Nb,!0);var kb=hn(Ib,!0);var Ob=hn(Tb,!0);var Fb="@firebase/database",Lb="1.0.5";var m_="";function LU(t){m_=t}var by=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Be(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:cs(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var Sy=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return an(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var gS=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new by(e)}}catch{}return new Sy},gi=gS("localStorage"),Ay=gS("sessionStorage");var Os=new cn("@firebase/database"),VU=function(){let t=1;return function(){return t++}}(),mS=function(t){let e=cC(t),n=new qu;n.update(e);let r=n.digest();return zu.encodeByteArray(r)},Ga=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Ga.apply(null,r):typeof r=="object"?e+=Be(r):e+=r,e+=" "}return e},mi=null,Vb=!0,UU=function(t,e){k(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Os.logLevel=J.VERBOSE,mi=Os.log.bind(Os),e&&Ay.set("logging_enabled",!0)):typeof t=="function"?mi=t:(mi=null,Ay.remove("logging_enabled"))},st=function(...t){if(Vb===!0&&(Vb=!1,mi===null&&Ay.get("logging_enabled")===!0&&UU(!0)),mi){let e=Ga.apply(null,t);mi(e)}},Ka=function(t){return function(...e){st(t,...e)}},Ry=function(...t){let e="FIREBASE INTERNAL ERROR: "+Ga(...t);Os.error(e)},Bn=function(...t){let e=`FIREBASE FATAL ERROR: ${Ga(...t)}`;throw Os.error(e),new Error(e)},Dt=function(...t){let e="FIREBASE WARNING: "+Ga(...t);Os.warn(e)},jU=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Dt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},yS=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},BU=function(t){if(on()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ls="[MIN_NAME]",yi="[MAX_NAME]",qs=function(t,e){if(t===e)return 0;if(t===Ls||e===yi)return-1;if(e===Ls||t===yi)return 1;{let n=Ub(t),r=Ub(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},$U=function(t,e){return t===e?0:t<e?-1:1},Oa=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Be(e))},y_=function(t){if(typeof t!="object"||t===null)return Be(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Be(e[r]),n+=":",n+=y_(t[e[r]]);return n+="}",n},_S=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Ft(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var vS=function(t){k(!yS(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let l=[];for(u=n;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let f=l.join(""),p="";for(u=0;u<64;u+=8){let m=parseInt(f.substr(u,8),2).toString(16);m.length===1&&(m="0"+m),p=p+m}return p.toLowerCase()},HU=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},qU=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var zU=new RegExp("^-?(0*)\\d{1,10}$"),WU=-2147483648,GU=2147483647,Ub=function(t){if(zU.test(t)){let e=Number(t);if(e>=WU&&e<=GU)return e}return null},Qa=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Dt("Exception was thrown by user callback.",n),e},Math.floor(0))}},KU=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ja=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var Ny=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Dt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var xy=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(st("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Dt(e)}},Ba=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Zl="5",wS="v",IS="s",ES="r",TS="f",CS=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,DS="ls",bS="p",Py="ac",SS="websocket",AS="long_polling";var ed=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=gi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&gi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function QU(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function RS(t,e,n){k(typeof e=="string","typeof type must == string"),k(typeof n=="object","typeof params must == object");let r;if(e===SS)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===AS)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);QU(t)&&(n.ns=t.namespace);let i=[];return Ft(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var My=class{constructor(){this.counters_={}}incrementCounter(e,n=1){an(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return JT(this.counters_)}};var vy={},wy={};function __(t){let e=t.toString();return vy[e]||(vy[e]=new My),vy[e]}function YU(t,e){let n=t.toString();return wy[n]||(wy[n]=e()),wy[n]}var ky=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Qa(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var jb="start",JU="close",XU="pLPCommand",ZU="pRTLPCB",NS="id",xS="pw",PS="ser",ej="cb",tj="seg",nj="ts",rj="d",ij="dframe",MS=1870,kS=30,sj=MS-kS,oj=25e3,aj=3e4,Oy=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ka(e),this.stats_=__(n),this.urlFn=u=>(this.appCheckToken&&(u[Py]=this.appCheckToken),RS(n,AS,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new ky(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(aj)),BU(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Fy((...s)=>{let[o,a,u,l,f]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===jb)this.id=a,this.password=u;else if(o===JU)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[jb]="t",r[PS]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[ej]=this.scriptTagHolder.uniqueCallbackIdentifier),r[wS]=Zl,this.transportSessionId&&(r[IS]=this.transportSessionId),this.lastSessionId&&(r[DS]=this.lastSessionId),this.applicationId&&(r[bS]=this.applicationId),this.appCheckToken&&(r[Py]=this.appCheckToken),typeof location<"u"&&location.hostname&&CS.test(location.hostname)&&(r[ES]=TS);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return on()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!HU()&&!qU()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Be(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=kp(n),i=_S(r,sj);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(on())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[ij]="t",r[NS]=e,r[xS]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Be(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Fy=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,on())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=VU(),window[XU+this.uniqueCallbackIdentifier]=e,window[ZU+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){st("frame writing exception"),a.stack&&st(a.stack),st(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||st("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[NS]=this.myID,e[xS]=this.myPW,e[PS]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+kS+r.length<=MS;){let o=this.pendingSegs.shift();r=r+"&"+tj+i+"="+o.seg+"&"+nj+i+"="+o.ts+"&"+rj+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(oj)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){on()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{st("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var cj=16384,uj=45e3,td=null;typeof MozWebSocket<"u"?td=MozWebSocket:typeof WebSocket<"u"&&(td=WebSocket);var Fa=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ka(this.connId),this.stats_=__(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[wS]=Zl,!on()&&typeof location<"u"&&location.hostname&&CS.test(location.hostname)&&(a[ES]=TS),r&&(a[IS]=r),i&&(a[DS]=i),s&&(a[Py]=s),o&&(a[bS]=o),RS(n,SS,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,gi.set("previous_websocket_failure",!0);try{let i;if(on()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Zl}/${m_}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new td(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&td!==null&&!t.forceDisallow_}static previouslyFailed(){return gi.isInMemoryStorage||gi.get("previous_websocket_failure")===!0}markConnectionHealthy(){gi.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=cs(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(k(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Be(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=_S(r,cj);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(uj))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),lj=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Oy,Fa]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Fa&&Fa.isAvailable(),i=r&&!Fa.previouslyFailed();if(n.webSocketOnly&&(r||Dt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Fa];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),dj=6e4,hj=5e3,fj=10*1024,pj=100*1024,Iy="t",Bb="d",gj="s",$b="r",mj="e",Hb="o",qb="a",zb="n",Wb="p",yj="h",Ly=class{constructor(e,n,r,i,s,o,a,u,l,f){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ka("c:"+this.id+":"),this.transportManager_=new lj(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ja(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>pj?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>fj?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Iy in e){let n=e[Iy];n===qb?this.upgradeIfSecondaryHealthy_():n===$b?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Hb&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Oa("t",e),r=Oa("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Wb,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:qb,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:zb,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Oa("t",e),r=Oa("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Oa(Iy,e);if(Bb in e){let r=e[Bb];if(n===yj){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===zb){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===gj?this.onConnectionShutdown_(r):n===$b?this.onReset_(r):n===mj?Ry("Server Error: "+r):n===Hb?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ry("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Zl!==r&&Dt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),ja(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(dj))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ja(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(hj))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Wb,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(gi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var nd=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var rd=class{constructor(e){this.allowedEvents_=e,this.listeners_={},k(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){k(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var id=class t extends rd{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!aa()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return k(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var Gb=32,Kb=768,we=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ye(){return new we("")}function ae(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ir(t){return t.pieces_.length-t.pieceNum_}function Ce(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new we(t.pieces_,e)}function OS(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function _j(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function FS(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function LS(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new we(e,0)}function ze(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof we)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new we(n,0)}function te(t){return t.pieceNum_>=t.pieces_.length}function kt(t,e){let n=ae(t),r=ae(e);if(n===null)return e;if(n===r)return kt(Ce(t),Ce(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function VS(t,e){if(Ir(t)!==Ir(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Kt(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ir(t)>Ir(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Vy=class{constructor(e,n){this.errorPrefix_=n,this.parts_=FS(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=la(this.parts_[r]);US(this)}};function vj(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=la(e),US(t)}function wj(t){let e=t.parts_.pop();t.byteLength_-=la(e),t.parts_.length>0&&(t.byteLength_-=1)}function US(t){if(t.byteLength_>Kb)throw new Error(t.errorPrefix_+"has a key path longer than "+Kb+" bytes ("+t.byteLength_+").");if(t.parts_.length>Gb)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Gb+") or object contains a cycle "+pi(t))}function pi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var Uy=class t extends rd{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return k(e==="visible","Unknown event type: "+e),[this.visible_]}};var La=1e3,Ij=60*5*1e3,Qb=30*1e3,Ej=1.3,Tj=3e4,Cj="server_kill",Yb=3,v_=(()=>{class t extends nd{constructor(n,r,i,s,o,a,u,l){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=Ka("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=La,this.maxReconnectDelay_=Ij,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!on())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Uy.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&id.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Be(o)),k(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new Hr,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),k(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),k(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let l=u.d,f=u.s;t.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),f!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(f,l))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&an(n,"w")){let i=zr(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Dt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||sC(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Qb)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=iC(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),k(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Be(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):Ry("Unrecognized action received from server: "+Be(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){k(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=La,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=La,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Tj&&(this.reconnectDelay_=La),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Ej)}this.onConnectStatus_(!1)}establishConnection_(){return T(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,l=function(){u?u.close():(a=!0,i())},f=function(m){k(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(m)};this.realtime_={close:l,sendRequest:f};let p=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[m,D]=yield Promise.all([this.authTokenProvider_.getToken(p),this.appCheckTokenProvider_.getToken(p)]);a?st("getToken() completed but was canceled"):(st("getToken() completed. Creating connection."),this.authToken_=m&&m.accessToken,this.appCheckToken_=D&&D.token,u=new Ly(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,A=>{Dt(A+" ("+this.repoInfo_.toString()+")"),this.interrupt(Cj)},o))}catch(m){this.log_("Failed to get token: "+m),a||(this.repoInfo_.nodeAdmin&&Dt(m),l())}}})}interrupt(n){st("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){st("Resuming connection for reason: "+n),delete this.interruptReasons_[n],ca(this.interruptReasons_)&&(this.reconnectDelay_=La,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>y_(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new we(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){st("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Yb&&(this.reconnectDelay_=Qb,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){st("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Yb&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";on()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+m_.replace(/\./g,"-")]=1,aa()?n["framework.cordova"]=1:Qu()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=id.getInstance().currentlyOnline();return ca(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ce=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Vs=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ce(Ls,e),i=new ce(Ls,n);return this.compare(r,i)!==0}minPost(){return ce.MIN}};var Xl,sd=class extends Vs{static get __EMPTY_NODE(){return Xl}static set __EMPTY_NODE(e){Xl=e}compare(e,n){return qs(e.name,n.name)}isDefinedOn(e){throw qr("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ce.MIN}maxPost(){return new ce(yi,Xl)}makePost(e,n){return k(typeof e=="string","KeyIndex indexValue must always be a string."),new ce(e,Xl)}toString(){return".key"}},Fs=new sd;var Ms=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Gt=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Ot.EMPTY_NODE,this.right=o??Ot.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ot.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Ot.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),jy=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Gt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Ot=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Gt.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Gt.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ms(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Ms(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Ms(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Ms(this.root_,null,this.comparator_,!0,e)}};Ot.EMPTY_NODE=new jy;function Dj(t,e){return qs(t.name,e.name)}function w_(t,e){return qs(t,e)}var By;function bj(t){By=t}var jS=function(t){return typeof t=="number"?"number:"+vS(t):"string:"+t},BS=function(t){if(t.isLeafNode()){let e=t.val();k(typeof e=="string"||typeof e=="number"||typeof e=="object"&&an(e,".sv"),"Priority must be a string or number.")}else k(t===By||t.isEmpty(),"priority of unexpected type.");k(t===By||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Jb,Us=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,k(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),BS(this.priorityNode_)}static set __childrenNodeConstructor(n){Jb=n}static get __childrenNodeConstructor(){return Jb}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return te(n)?this:ae(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ae(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(k(i!==".priority"||Ir(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ce(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+jS(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=vS(this.value_):n+=this.value_,this.lazyHash_=mS(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(k(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return k(s>=0,"Unknown leaf type: "+r),k(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),$S,HS;function Sj(t){$S=t}function Aj(t){HS=t}var $y=class extends Vs{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?qs(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ce.MIN}maxPost(){return new ce(yi,new Us("[PRIORITY-POST]",HS))}makePost(e,n){let r=$S(e);return new ce(n,new Us("[PRIORITY-POST]",r))}toString(){return".priority"}},at=new $y;var Rj=Math.log(2),Hy=class{constructor(e){let n=s=>parseInt(Math.log(s)/Rj,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},od=function(t,e,n,r){t.sort(e);let i=function(u,l){let f=l-u,p,m;if(f===0)return null;if(f===1)return p=t[u],m=n?n(p):p,new Gt(m,p.node,Gt.BLACK,null,null);{let D=parseInt(f/2,10)+u,A=i(u,D),R=i(D+1,l);return p=t[D],m=n?n(p):p,new Gt(m,p.node,Gt.BLACK,A,R)}},s=function(u){let l=null,f=null,p=t.length,m=function(A,R){let x=p-A,V=p;p-=A;let K=i(x+1,V),B=t[x],de=n?n(B):B;D(new Gt(de,B.node,R,null,K))},D=function(A){l?(l.left=A,l=A):(f=A,l=A)};for(let A=0;A<u.count;++A){let R=u.nextBitIsOne(),x=Math.pow(2,u.count-(A+1));R?m(x,Gt.BLACK):(m(x,Gt.BLACK),m(x,Gt.RED))}return f},o=new Hy(t.length),a=s(o);return new Ot(r||e,a)};var Ey,Ps={},js=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return k(Ps&&at,"ChildrenNode.ts has not been loaded"),Ey=Ey||new t({".priority":Ps},{".priority":at}),Ey}get(e){let n=zr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ot?n:null}hasIndex(e){return an(this.indexSet_,e.toString())}addIndex(e,n){k(e!==Fs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ce.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=od(r,e.getCompare()):a=Ps;let u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;let f=Object.assign({},this.indexes_);return f[u]=a,new t(f,l)}addToIndexes(e,n){let r=ua(this.indexes_,(i,s)=>{let o=zr(this.indexSet_,s);if(k(o,"Missing index implementation for "+s),i===Ps)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(ce.Wrap),l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),od(a,o.getCompare())}else return Ps;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new ce(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=ua(this.indexes_,i=>{if(i===Ps)return i;{let s=n.get(e.name);return s?i.remove(new ce(e.name,s)):i}});return new t(r,this.indexSet_)}};var Va,be=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&BS(this.priorityNode_),this.children_.isEmpty()&&k(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Va||(Va=new t(new Ot(w_),null,js.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Va}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Va:r}}getChild(n){let r=ae(n);return r===null?this:this.getImmediateChild(r).getChild(Ce(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(k(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ce(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Va:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ae(n);if(i===null)return r;{k(ae(n)!==".priority"||Ir(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ce(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(at,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+jS(this.getPriority().val())+":"),this.forEachChild(at,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":mS(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ce(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ce(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ce(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ya?-1:0}withIndex(n){if(n===Fs||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Fs||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(at),s=r.getIterator(at),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Fs?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),qy=class extends be{constructor(){super(new Ot(w_),be.EMPTY_NODE,js.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return be.EMPTY_NODE}isEmpty(){return!1}},Ya=new qy;Object.defineProperties(ce,{MIN:{value:new ce(Ls,be.EMPTY_NODE)},MAX:{value:new ce(yi,Ya)}});sd.__EMPTY_NODE=be.EMPTY_NODE;Us.__childrenNodeConstructor=be;bj(Ya);Aj(Ya);var Nj=!0;function ot(t,e=null){if(t===null)return be.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),k(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Us(n,ot(e))}if(!(t instanceof Array)&&Nj){let n=[],r=!1;if(Ft(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=ot(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new ce(o,u)))}}),n.length===0)return be.EMPTY_NODE;let s=od(n,Dj,o=>o.name,w_);if(r){let o=od(n,at.getCompare());return new be(s,ot(e),new js({".priority":o},{".priority":at}))}else return new be(s,ot(e),js.Default)}else{let n=be.EMPTY_NODE;return Ft(t,(r,i)=>{if(an(t,r)&&r.substring(0,1)!=="."){let s=ot(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(ot(e))}}Sj(ot);var zy=class extends Vs{constructor(e){super(),this.indexPath_=e,k(!te(e)&&ae(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?qs(e.name,n.name):s}makePost(e,n){let r=ot(e),i=be.EMPTY_NODE.updateChild(this.indexPath_,r);return new ce(n,i)}maxPost(){let e=be.EMPTY_NODE.updateChild(this.indexPath_,Ya);return new ce(yi,e)}toString(){return FS(this.indexPath_,0).join("/")}};var Wy=class extends Vs{compare(e,n){let r=e.node.compareTo(n.node);return r===0?qs(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ce.MIN}maxPost(){return ce.MAX}makePost(e,n){let r=ot(e);return new ce(n,r)}toString(){return".value"}},xj=new Wy;function Pj(t){return{type:"value",snapshotNode:t}}function Mj(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function kj(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Xb(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Oj(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Gy=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=at}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return k(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return k(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ls}hasEnd(){return this.endSet_}getIndexEndValue(){return k(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return k(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:yi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return k(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===at}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function Zb(t){let e={};if(t.isDefault())return e;let n;if(t.index_===at?n="$priority":t.index_===xj?n="$value":t.index_===Fs?n="$key":(k(t.index_ instanceof zy,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Be(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Be(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Be(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Be(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Be(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function eS(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==at&&(e.i=t.index_.toString()),e}var Ky=class t extends nd{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Ka("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(k(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=Zb(e._queryParams);this.restRequest_(s+".json",u,(l,f)=>{let p=f;if(l===404&&(p=null,l=null),l===null&&this.onDataUpdate_(s,p,!1,r),zr(this.listens_,o)===a){let m;l?l===401?m="permission_denied":m="rest_error:"+l:m="ok",i(m,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=Zb(e._queryParams),r=e._path.toString(),i=new Hr;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Gr(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=cs(a.responseText)}catch{Dt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&Dt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var Qy=class{constructor(){this.rootNode_=be.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function ad(){return{value:null,children:new Map}}function qS(t,e,n){if(te(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ae(e);t.children.has(r)||t.children.set(r,ad());let i=t.children.get(r);e=Ce(e),qS(i,e,n)}}function Yy(t,e,n){t.value!==null?n(e,t.value):Fj(t,(r,i)=>{let s=new we(e.toString()+"/"+r);Yy(i,s,n)})}function Fj(t,e){t.children.forEach((n,r)=>{e(r,n)})}var Jy=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Ft(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var tS=10*1e3,Lj=30*1e3,Vj=5*60*1e3,Xy=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Jy(e);let r=tS+(Lj-tS)*Math.random();ja(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;Ft(e,(i,s)=>{s>0&&an(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),ja(this.reportStats_.bind(this),Math.floor(Math.random()*2*Vj))}};var jn=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(jn||{});function zS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function WS(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function GS(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Zy=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=jn.ACK_USER_WRITE,this.source=zS()}operationForChild(e){if(te(this.path)){if(this.affectedTree.value!=null)return k(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new we(e));return new t(ye(),n,this.revert)}}else return k(ae(this.path)===e,"operationForChild called for unrelated child."),new t(Ce(this.path),this.affectedTree,this.revert)}};var Bs=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=jn.OVERWRITE}operationForChild(e){return te(this.path)?new t(this.source,ye(),this.snap.getImmediateChild(e)):new t(this.source,Ce(this.path),this.snap)}};var cd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=jn.MERGE}operationForChild(e){if(te(this.path)){let n=this.children.subtree(new we(e));return n.isEmpty()?null:n.value?new Bs(this.source,ye(),n.value):new t(this.source,ye(),n)}else return k(ae(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ce(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var qa=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(te(e))return this.isFullyInitialized()&&!this.filtered_;let n=ae(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function Uj(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Oj(o.childName,o.snapshotNode))}),Ua(t,i,"child_removed",e,r,n),Ua(t,i,"child_added",e,r,n),Ua(t,i,"child_moved",s,r,n),Ua(t,i,"child_changed",e,r,n),Ua(t,i,"value",e,r,n),i}function Ua(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>Bj(t,a,u)),o.forEach(a=>{let u=jj(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,t.query_))})})}function jj(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Bj(t,e,n){if(e.childName==null||n.childName==null)throw qr("Should only compare child_ events.");let r=new ce(e.childName,e.snapshotNode),i=new ce(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function KS(t,e){return{eventCache:t,serverCache:e}}function $a(t,e,n,r){return KS(new qa(e,n,r),t.serverCache)}function QS(t,e,n,r){return KS(t.eventCache,new qa(e,n,r))}function e_(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function _i(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Ty,$j=()=>(Ty||(Ty=new Ot($U)),Ty),pt=class t{constructor(e,n=$j()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return Ft(e,(r,i)=>{n=n.set(new we(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ye(),value:this.value};if(te(e))return null;{let r=ae(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ce(e),n);return s!=null?{path:ze(new we(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(te(e))return this;{let n=ae(e),r=this.children.get(n);return r!==null?r.subtree(Ce(e)):new t(null)}}set(e,n){if(te(e))return new t(n,this.children);{let r=ae(e),s=(this.children.get(r)||new t(null)).set(Ce(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(te(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ae(e),r=this.children.get(n);if(r){let i=r.remove(Ce(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(te(e))return this.value;{let n=ae(e),r=this.children.get(n);return r?r.get(Ce(e)):null}}setTree(e,n){if(te(e))return n;{let r=ae(e),s=(this.children.get(r)||new t(null)).setTree(Ce(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(ye(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(ze(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ye(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(te(e))return null;{let s=ae(e),o=this.children.get(s);return o?o.findOnPath_(Ce(e),ze(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ye(),n)}foreachOnPath_(e,n,r){if(te(e))return this;{this.value&&r(n,this.value);let i=ae(e),s=this.children.get(i);return s?s.foreachOnPath_(Ce(e),ze(n,i),r):new t(null)}}foreach(e){this.foreach_(ye(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(ze(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Qt=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new pt(null))}};function Ha(t,e,n){if(te(e))return new Qt(new pt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=kt(i,e);return s=s.updateChild(o,n),new Qt(t.writeTree_.set(i,s))}else{let i=new pt(n),s=t.writeTree_.setTree(e,i);return new Qt(s)}}}function nS(t,e,n){let r=t;return Ft(n,(i,s)=>{r=Ha(r,ze(e,i),s)}),r}function rS(t,e){if(te(e))return Qt.empty();{let n=t.writeTree_.setTree(e,new pt(null));return new Qt(n)}}function t_(t,e){return vi(t,e)!=null}function vi(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(kt(n.path,e)):null}function iS(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(at,(r,i)=>{e.push(new ce(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ce(r,i.value))}),e}function wr(t,e){if(te(e))return t;{let n=vi(t,e);return n!=null?new Qt(new pt(n)):new Qt(t.writeTree_.subtree(e))}}function n_(t){return t.writeTree_.isEmpty()}function $s(t,e){return YS(ye(),t.writeTree_,e)}function YS(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(k(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=YS(ze(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(ze(t,".priority"),r)),n}}function JS(t,e){return nA(e,t)}function Hj(t,e,n,r,i){k(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Ha(t.visibleWrites,e,n)),t.lastWriteId=r}function qj(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function zj(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);k(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&Wj(a,r.path)?i=!1:Kt(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return Gj(t),!0;if(r.snap)t.visibleWrites=rS(t.visibleWrites,r.path);else{let a=r.children;Ft(a,u=>{t.visibleWrites=rS(t.visibleWrites,ze(r.path,u))})}return!0}else return!1}function Wj(t,e){if(t.snap)return Kt(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Kt(ze(t.path,n),e))return!0;return!1}function Gj(t){t.visibleWrites=XS(t.allWrites,Kj,ye()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Kj(t){return t.visible}function XS(t,e,n){let r=Qt.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Kt(n,o)?(a=kt(n,o),r=Ha(r,a,s.snap)):Kt(o,n)&&(a=kt(o,n),r=Ha(r,ye(),s.snap.getChild(a)));else if(s.children){if(Kt(n,o))a=kt(n,o),r=nS(r,a,s.children);else if(Kt(o,n))if(a=kt(o,n),te(a))r=nS(r,ye(),s.children);else{let u=zr(s.children,ae(a));if(u){let l=u.getChild(Ce(a));r=Ha(r,ye(),l)}}}else throw qr("WriteRecord should have .snap or .children")}}return r}function ZS(t,e,n,r,i){if(!r&&!i){let s=vi(t.visibleWrites,e);if(s!=null)return s;{let o=wr(t.visibleWrites,e);if(n_(o))return n;if(n==null&&!t_(o,ye()))return null;{let a=n||be.EMPTY_NODE;return $s(o,a)}}}else{let s=wr(t.visibleWrites,e);if(!i&&n_(s))return n;if(!i&&n==null&&!t_(s,ye()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Kt(l.path,e)||Kt(e,l.path))},a=XS(t.allWrites,o,e),u=n||be.EMPTY_NODE;return $s(a,u)}}}function Qj(t,e,n){let r=be.EMPTY_NODE,i=vi(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(at,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=wr(t.visibleWrites,e);return n.forEachChild(at,(o,a)=>{let u=$s(wr(s,new we(o)),a);r=r.updateImmediateChild(o,u)}),iS(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=wr(t.visibleWrites,e);return iS(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function Yj(t,e,n,r,i){k(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ze(e,n);if(t_(t.visibleWrites,s))return null;{let o=wr(t.visibleWrites,s);return n_(o)?i.getChild(n):$s(o,i.getChild(n))}}function Jj(t,e,n,r){let i=ze(e,n),s=vi(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=wr(t.visibleWrites,i);return $s(o,r.getNode().getImmediateChild(n))}else return null}function Xj(t,e){return vi(t.visibleWrites,e)}function Zj(t,e,n,r,i,s,o){let a,u=wr(t.visibleWrites,e),l=vi(u,ye());if(l!=null)a=l;else if(n!=null)a=$s(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let f=[],p=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),D=m.getNext();for(;D&&f.length<i;)p(D,r)!==0&&f.push(D),D=m.getNext();return f}else return[]}function e2(){return{visibleWrites:Qt.empty(),allWrites:[],lastWriteId:-1}}function r_(t,e,n,r){return ZS(t.writeTree,t.treePath,e,n,r)}function eA(t,e){return Qj(t.writeTree,t.treePath,e)}function sS(t,e,n,r){return Yj(t.writeTree,t.treePath,e,n,r)}function ud(t,e){return Xj(t.writeTree,ze(t.treePath,e))}function t2(t,e,n,r,i,s){return Zj(t.writeTree,t.treePath,e,n,r,i,s)}function I_(t,e,n){return Jj(t.writeTree,t.treePath,e,n)}function tA(t,e){return nA(ze(t.treePath,e),t.writeTree)}function nA(t,e){return{treePath:t,writeTree:e}}var i_=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;k(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),k(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Xb(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,kj(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Mj(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Xb(r,e.snapshotNode,i.oldSnap));else throw qr("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var s_=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},rA=new s_,za=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new qa(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return I_(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:_i(this.viewCache_),s=t2(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function n2(t,e){k(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),k(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function r2(t,e,n,r,i){let s=new i_,o,a;if(n.type===jn.OVERWRITE){let l=n;l.source.fromUser?o=o_(t,e,l.path,l.snap,r,i,s):(k(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!te(l.path),o=ld(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===jn.MERGE){let l=n;l.source.fromUser?o=s2(t,e,l.path,l.children,r,i,s):(k(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=a_(t,e,l.path,l.children,r,i,a,s))}else if(n.type===jn.ACK_USER_WRITE){let l=n;l.revert?o=c2(t,e,l.path,r,i,s):o=o2(t,e,l.path,l.affectedTree,r,i,s)}else if(n.type===jn.LISTEN_COMPLETE)o=a2(t,e,n.path,r,s);else throw qr("Unknown operation type: "+n.type);let u=s.getChanges();return i2(e,o,u),{viewCache:o,changes:u}}function i2(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=e_(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(Pj(e_(e)))}}function iA(t,e,n,r,i,s){let o=e.eventCache;if(ud(r,n)!=null)return e;{let a,u;if(te(n))if(k(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=_i(e),f=l instanceof be?l:be.EMPTY_NODE,p=eA(r,f);a=t.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{let l=r_(r,_i(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=ae(n);if(l===".priority"){k(Ir(n)===1,"Can't have a priority with additional path components");let f=o.getNode();u=e.serverCache.getNode();let p=sS(r,n,f,u);p!=null?a=t.filter.updatePriority(f,p):a=o.getNode()}else{let f=Ce(n),p;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();let m=sS(r,n,o.getNode(),u);m!=null?p=o.getNode().getImmediateChild(l).updateChild(f,m):p=o.getNode().getImmediateChild(l)}else p=I_(r,l,e.serverCache);p!=null?a=t.filter.updateChild(o.getNode(),l,p,f,i,s):a=o.getNode()}}return $a(e,a,o.isFullyInitialized()||te(n),t.filter.filtersNodes())}}function ld(t,e,n,r,i,s,o,a){let u=e.serverCache,l,f=o?t.filter:t.filter.getIndexedFilter();if(te(n))l=f.updateFullNode(u.getNode(),r,null);else if(f.filtersNodes()&&!u.isFiltered()){let D=u.getNode().updateChild(n,r);l=f.updateFullNode(u.getNode(),D,null)}else{let D=ae(n);if(!u.isCompleteForPath(n)&&Ir(n)>1)return e;let A=Ce(n),x=u.getNode().getImmediateChild(D).updateChild(A,r);D===".priority"?l=f.updatePriority(u.getNode(),x):l=f.updateChild(u.getNode(),D,x,A,rA,null)}let p=QS(e,l,u.isFullyInitialized()||te(n),f.filtersNodes()),m=new za(i,p,s);return iA(t,p,n,i,m,a)}function o_(t,e,n,r,i,s,o){let a=e.eventCache,u,l,f=new za(i,e,s);if(te(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=$a(e,l,!0,t.filter.filtersNodes());else{let p=ae(n);if(p===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),u=$a(e,l,a.isFullyInitialized(),a.isFiltered());else{let m=Ce(n),D=a.getNode().getImmediateChild(p),A;if(te(m))A=r;else{let R=f.getCompleteChild(p);R!=null?OS(m)===".priority"&&R.getChild(LS(m)).isEmpty()?A=R:A=R.updateChild(m,r):A=be.EMPTY_NODE}if(D.equals(A))u=e;else{let R=t.filter.updateChild(a.getNode(),p,A,m,f,o);u=$a(e,R,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function oS(t,e){return t.eventCache.isCompleteForChild(e)}function s2(t,e,n,r,i,s,o){let a=e;return r.foreach((u,l)=>{let f=ze(n,u);oS(e,ae(f))&&(a=o_(t,a,f,l,i,s,o))}),r.foreach((u,l)=>{let f=ze(n,u);oS(e,ae(f))||(a=o_(t,a,f,l,i,s,o))}),a}function aS(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function a_(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,l;te(n)?l=r:l=new pt(null).setTree(n,r);let f=e.serverCache.getNode();return l.children.inorderTraversal((p,m)=>{if(f.hasChild(p)){let D=e.serverCache.getNode().getImmediateChild(p),A=aS(t,D,m);u=ld(t,u,new we(p),A,i,s,o,a)}}),l.children.inorderTraversal((p,m)=>{let D=!e.serverCache.isCompleteForChild(p)&&m.value===null;if(!f.hasChild(p)&&!D){let A=e.serverCache.getNode().getImmediateChild(p),R=aS(t,A,m);u=ld(t,u,new we(p),R,i,s,o,a)}}),u}function o2(t,e,n,r,i,s,o){if(ud(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(te(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return ld(t,e,n,u.getNode().getChild(n),i,s,a,o);if(te(n)){let l=new pt(null);return u.getNode().forEachChild(Fs,(f,p)=>{l=l.set(new we(f),p)}),a_(t,e,n,l,i,s,a,o)}else return e}else{let l=new pt(null);return r.foreach((f,p)=>{let m=ze(n,f);u.isCompleteForPath(m)&&(l=l.set(f,u.getNode().getChild(m)))}),a_(t,e,n,l,i,s,a,o)}}function a2(t,e,n,r,i){let s=e.serverCache,o=QS(e,s.getNode(),s.isFullyInitialized()||te(n),s.isFiltered());return iA(t,o,n,r,rA,i)}function c2(t,e,n,r,i,s){let o;if(ud(r,n)!=null)return e;{let a=new za(r,e,i),u=e.eventCache.getNode(),l;if(te(n)||ae(n)===".priority"){let f;if(e.serverCache.isFullyInitialized())f=r_(r,_i(e));else{let p=e.serverCache.getNode();k(p instanceof be,"serverChildren would be complete if leaf node"),f=eA(r,p)}f=f,l=t.filter.updateFullNode(u,f,s)}else{let f=ae(n),p=I_(r,f,e.serverCache);p==null&&e.serverCache.isCompleteForChild(f)&&(p=u.getImmediateChild(f)),p!=null?l=t.filter.updateChild(u,f,p,Ce(n),a,s):e.eventCache.getNode().hasChild(f)?l=t.filter.updateChild(u,f,be.EMPTY_NODE,Ce(n),a,s):l=u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=r_(r,_i(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||ud(r,ye())!=null,$a(e,l,o,t.filter.filtersNodes())}}function u2(t,e){let n=_i(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!te(e)&&!n.getImmediateChild(ae(e)).isEmpty())?n.getChild(e):null}function cS(t,e,n,r){e.type===jn.MERGE&&e.source.queryId!==null&&(k(_i(t.viewCache_),"We should always have a full cache before handling merges"),k(e_(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=r2(t.processor_,i,e,n,r);return n2(t.processor_,s.viewCache),k(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,l2(t,s.changes,s.viewCache.eventCache.getNode(),null)}function l2(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return Uj(t.eventGenerator_,e,n,i)}var uS;function d2(t){k(!uS,"__referenceConstructor has already been defined"),uS=t}function E_(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return k(s!=null,"SyncTree gave us an op for an invalid query."),cS(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(cS(o,e,n,r));return s}}function T_(t,e){let n=null;for(let r of t.views.values())n=n||u2(r,e);return n}var lS;function h2(t){k(!lS,"__referenceConstructor has already been defined"),lS=t}var dd=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new pt(null),this.pendingWriteTree_=e2(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function f2(t,e,n,r,i){return Hj(t.pendingWriteTree_,e,n,r,i),i?fd(t,new Bs(zS(),e,n)):[]}function ks(t,e,n=!1){let r=qj(t.pendingWriteTree_,e);if(zj(t.pendingWriteTree_,e)){let s=new pt(null);return r.snap!=null?s=s.set(ye(),!0):Ft(r.children,o=>{s=s.set(new we(o),!0)}),fd(t,new Zy(r.path,s,n))}else return[]}function hd(t,e,n){return fd(t,new Bs(WS(),e,n))}function p2(t,e,n){let r=pt.fromObject(n);return fd(t,new cd(WS(),e,r))}function g2(t,e,n,r){let i=cA(t,r);if(i!=null){let s=uA(i),o=s.path,a=s.queryId,u=kt(o,e),l=new Bs(GS(a),u,n);return lA(t,o,l)}else return[]}function m2(t,e,n,r){let i=cA(t,r);if(i){let s=uA(i),o=s.path,a=s.queryId,u=kt(o,e),l=pt.fromObject(n),f=new cd(GS(a),u,l);return lA(t,o,f)}else return[]}function sA(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=kt(o,e),l=T_(a,u);if(l)return l});return ZS(i,e,s,n,!0)}function fd(t,e){return oA(e,t.syncPointTree_,null,JS(t.pendingWriteTree_,ye()))}function oA(t,e,n,r){if(te(t.path))return aA(t,e,n,r);{let i=e.get(ye());n==null&&i!=null&&(n=T_(i,ye()));let s=[],o=ae(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let l=n?n.getImmediateChild(o):null,f=tA(r,o);s=s.concat(oA(a,u,l,f))}return i&&(s=s.concat(E_(i,t,r,n))),s}}function aA(t,e,n,r){let i=e.get(ye());n==null&&i!=null&&(n=T_(i,ye()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,l=tA(r,o),f=t.operationForChild(o);f&&(s=s.concat(aA(f,a,u,l)))}),i&&(s=s.concat(E_(i,t,r,n))),s}function cA(t,e){return t.tagToQueryMap.get(e)}function uA(t){let e=t.indexOf("$");return k(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new we(t.substr(0,e))}}function lA(t,e,n){let r=t.syncPointTree_.get(e);k(r,"Missing sync point for query tag that we're tracking");let i=JS(t.pendingWriteTree_,e);return E_(r,n,i,null)}var c_=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},u_=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=ze(this.path_,e);return new t(this.syncTree_,n)}node(){return sA(this.syncTree_,this.path_)}},y2=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},dS=function(t,e,n){if(!t||typeof t!="object")return t;if(k(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return _2(t[".sv"],e,n);if(typeof t[".sv"]=="object")return v2(t[".sv"],e);k(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},_2=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:k(!1,"Unexpected server value: "+t)}},v2=function(t,e,n){t.hasOwnProperty("increment")||k(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&k(!1,"Unexpected increment value: "+r);let i=e.node();if(k(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},w2=function(t,e,n,r){return C_(e,new u_(n,t),r)},I2=function(t,e,n){return C_(t,new c_(e),n)};function C_(t,e,n){let r=t.getPriority().val(),i=dS(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=dS(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Us(a,ot(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Us(i))),o.forEachChild(at,(a,u)=>{let l=C_(u,e.getImmediateChild(a),n);l!==u&&(s=s.updateImmediateChild(a,l))}),s}}var Wa=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function D_(t,e){let n=e instanceof we?e:new we(e),r=t,i=ae(n);for(;i!==null;){let s=zr(r.node.children,i)||{children:{},childCount:0};r=new Wa(i,r,s),n=Ce(n),i=ae(n)}return r}function zs(t){return t.node.value}function dA(t,e){t.node.value=e,l_(t)}function hA(t){return t.node.childCount>0}function E2(t){return zs(t)===void 0&&!hA(t)}function pd(t,e){Ft(t.node.children,(n,r)=>{e(new Wa(n,t,r))})}function fA(t,e,n,r){n&&!r&&e(t),pd(t,i=>{fA(i,e,!0,r)}),n&&r&&e(t)}function T2(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Ja(t){return new we(t.parent===null?t.name:Ja(t.parent)+"/"+t.name)}function l_(t){t.parent!==null&&C2(t.parent,t.name,t)}function C2(t,e,n){let r=E2(n),i=an(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,l_(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,l_(t))}var D2=/[\[\].#$\/\u0000-\u001F\u007F]/,b2=/[\[\].#$\u0000-\u001F\u007F]/,Cy=10*1024*1024,pA=function(t){return typeof t=="string"&&t.length!==0&&!D2.test(t)},S2=function(t){return typeof t=="string"&&t.length!==0&&!b2.test(t)},A2=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),S2(t)};var gA=function(t,e,n){let r=n instanceof we?new Vy(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+pi(r));if(typeof e=="function")throw new Error(t+"contains a function "+pi(r)+" with contents = "+e.toString());if(yS(e))throw new Error(t+"contains "+e.toString()+" "+pi(r));if(typeof e=="string"&&e.length>Cy/3&&la(e)>Cy)throw new Error(t+"contains a string greater than "+Cy+" utf8 bytes "+pi(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Ft(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!pA(o)))throw new Error(t+" contains an invalid key ("+o+") "+pi(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);vj(r,o),gA(t,a,r),wj(r)}),i&&s)throw new Error(t+' contains ".value" child '+pi(r)+" in addition to actual children.")}};var R2=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!pA(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!A2(n))throw new Error(aC(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var d_=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function N2(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!VS(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function wi(t,e,n){N2(t,n),x2(t,r=>Kt(r,e)||Kt(e,r))}function x2(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(P2(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function P2(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();mi&&st("event: "+n.toString()),Qa(r)}}}var M2="repo_interrupt",k2=25,h_=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new d_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ad(),this.transactionQueueTree_=new Wa,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function O2(t,e,n){if(t.stats_=__(t.repoInfo_),t.forceRestClient_||KU())t.server_=new Ky(t.repoInfo_,(r,i,s,o)=>{hS(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>fS(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Be(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new v_(t.repoInfo_,e,(r,i,s,o)=>{hS(t,r,i,s,o)},r=>{fS(t,r)},r=>{L2(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=YU(t.repoInfo_,()=>new Xy(t.stats_,t.server_)),t.infoData_=new Qy,t.infoSyncTree_=new dd({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=hd(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),b_(t,"connected",!1),t.serverSyncTree_=new dd({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let l=o(a,u);wi(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function F2(t){let n=t.infoData_.getNode(new we(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function mA(t){return y2({timestamp:F2(t)})}function hS(t,e,n,r,i){t.dataUpdateCount++;let s=new we(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=ua(n,l=>ot(l));o=m2(t.serverSyncTree_,s,u,i)}else{let u=ot(n);o=g2(t.serverSyncTree_,s,u,i)}else if(r){let u=ua(n,l=>ot(l));o=p2(t.serverSyncTree_,s,u)}else{let u=ot(n);o=hd(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=A_(t,s)),wi(t.eventQueue_,a,o)}function fS(t,e){b_(t,"connected",e),e===!1&&U2(t)}function L2(t,e){Ft(e,(n,r)=>{b_(t,n,r)})}function b_(t,e,n){let r=new we("/.info/"+e),i=ot(n);t.infoData_.updateSnapshot(r,i);let s=hd(t.infoSyncTree_,r,i);wi(t.eventQueue_,r,s)}function V2(t){return t.nextWriteId_++}function U2(t){yA(t,"onDisconnectEvents");let e=mA(t),n=ad();Yy(t.onDisconnect_,ye(),(i,s)=>{let o=w2(i,s,t.serverSyncTree_,e);qS(n,i,o)});let r=[];Yy(n,ye(),(i,s)=>{r=r.concat(hd(t.serverSyncTree_,i,s));let o=H2(t,i);A_(t,o)}),t.onDisconnect_=ad(),wi(t.eventQueue_,ye(),r)}function j2(t){t.persistentConnection_&&t.persistentConnection_.interrupt(M2)}function yA(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),st(n,...e)}function _A(t,e,n){return sA(t.serverSyncTree_,e,n)||be.EMPTY_NODE}function S_(t,e=t.transactionQueueTree_){if(e||gd(t,e),zs(e)){let n=wA(t,e);k(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&B2(t,Ja(e),n)}else hA(e)&&pd(e,n=>{S_(t,n)})}function B2(t,e,n){let r=n.map(l=>l.currentWriteId),i=_A(t,e,r),s=i,o=i.hash();for(let l=0;l<n.length;l++){let f=n[l];k(f.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;let p=kt(e,f.path);s=s.updateChild(p,f.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,l=>{yA(t,"transaction put response",{path:u.toString(),status:l});let f=[];if(l==="ok"){let p=[];for(let m=0;m<n.length;m++)n[m].status=2,f=f.concat(ks(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&p.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();gd(t,D_(t.transactionQueueTree_,e)),S_(t,t.transactionQueueTree_),wi(t.eventQueue_,e,f);for(let m=0;m<p.length;m++)Qa(p[m])}else{if(l==="datastale")for(let p=0;p<n.length;p++)n[p].status===3?n[p].status=4:n[p].status=0;else{Dt("transaction at "+u.toString()+" failed: "+l);for(let p=0;p<n.length;p++)n[p].status=4,n[p].abortReason=l}A_(t,e)}},o)}function A_(t,e){let n=vA(t,e),r=Ja(n),i=wA(t,n);return $2(t,i,r),r}function $2(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],l=kt(n,u.path),f=!1,p;if(k(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)f=!0,p=u.abortReason,i=i.concat(ks(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=k2)f=!0,p="maxretry",i=i.concat(ks(t.serverSyncTree_,u.currentWriteId,!0));else{let m=_A(t,u.path,o);u.currentInputSnapshot=m;let D=e[a].update(m.val());if(D!==void 0){gA("transaction failed: Data returned ",D,u.path);let A=ot(D);typeof D=="object"&&D!=null&&an(D,".priority")||(A=A.updatePriority(m.getPriority()));let x=u.currentWriteId,V=mA(t),K=I2(A,m,V);u.currentOutputSnapshotRaw=A,u.currentOutputSnapshotResolved=K,u.currentWriteId=V2(t),o.splice(o.indexOf(x),1),i=i.concat(f2(t.serverSyncTree_,u.path,K,u.currentWriteId,u.applyLocally)),i=i.concat(ks(t.serverSyncTree_,x,!0))}else f=!0,p="nodata",i=i.concat(ks(t.serverSyncTree_,u.currentWriteId,!0))}wi(t.eventQueue_,n,i),i=[],f&&(e[a].status=2,function(m){setTimeout(m,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(p==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(p),!1,null))))}gd(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Qa(r[a]);S_(t,t.transactionQueueTree_)}function vA(t,e){let n,r=t.transactionQueueTree_;for(n=ae(e);n!==null&&zs(r)===void 0;)r=D_(r,n),e=Ce(e),n=ae(e);return r}function wA(t,e){let n=[];return IA(t,e,n),n.sort((r,i)=>r.order-i.order),n}function IA(t,e,n){let r=zs(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);pd(e,i=>{IA(t,i,n)})}function gd(t,e){let n=zs(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,dA(e,n.length>0?n:void 0)}pd(e,r=>{gd(t,r)})}function H2(t,e){let n=Ja(vA(t,e)),r=D_(t.transactionQueueTree_,e);return T2(r,i=>{Dy(t,i)}),Dy(t,r),fA(r,i=>{Dy(t,i)}),n}function Dy(t,e){let n=zs(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(k(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(k(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ks(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?dA(e,void 0):n.length=s+1,wi(t.eventQueue_,Ja(e),i);for(let o=0;o<r.length;o++)Qa(r[o])}}function q2(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function z2(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Dt(`Invalid query segment '${n}' in query '${t}'`)}return e}var pS=function(t,e){let n=W2(t),r=n.namespace;n.domain==="firebase.com"&&Bn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Bn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||jU();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new ed(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new we(n.pathString)}},W2=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let f=t.indexOf("/");f===-1&&(f=t.length);let p=t.indexOf("?");p===-1&&(p=t.length),e=t.substring(0,Math.min(f,p)),f<p&&(i=q2(t.substring(f,p)));let m=z2(t.substring(Math.min(t.length,p)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(l+1),10)):l=e.length;let D=e.slice(0,l);if(D.toLowerCase()==="localhost")n="localhost";else if(D.split(".").length<=2)n=D;else{let A=e.indexOf(".");r=e.substring(0,A).toLowerCase(),n=e.substring(A+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var f_=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return te(this._path)?null:OS(this._path)}get ref(){return new Hs(this._repo,this._path)}get _queryIdentifier(){let e=eS(this._queryParams),n=y_(e);return n==="{}"?"default":n}get _queryObject(){return eS(this._queryParams)}isEqual(e){if(e=tt(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=VS(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+_j(this._path)}};var Hs=class t extends f_{constructor(e,n){super(e,n,new Gy,!1)}get parent(){let e=LS(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};d2(Hs);h2(Hs);var G2="FIREBASE_DATABASE_EMULATOR_HOST",p_={},K2=!1;function Q2(t,e,n,r){t.repoInfo_=new ed(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function Y2(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Bn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),st("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=pS(s,i),a=o.repoInfo,u,l;typeof process<"u"&&process.env&&(l=process.env[G2]),l?(u=!0,s=`http://${l}?ns=${a.namespace}`,o=pS(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let f=i&&u?new Ba(Ba.OWNER):new xy(t.name,t.options,e);R2("Invalid Firebase Database URL",o),te(o.path)||Bn("Database URL must point to the root of a Firebase Database (not including a child path).");let p=X2(a,t,f,new Ny(t.name,n));return new g_(p,t)}function J2(t,e){let n=p_[e];(!n||n[t.key]!==t)&&Bn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),j2(t),delete n[t.key]}function X2(t,e,n,r){let i=p_[e.name];i||(i={},p_[e.name]=i);let s=i[t.toURLString()];return s&&Bn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new h_(t,K2,n,r),i[t.toURLString()]=s,s}var g_=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(O2(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Hs(this._repo,ye())),this._rootInternal}_delete(){return this._rootInternal!==null&&(J2(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Bn("Cannot call "+e+" on a deleted database.")}};function EA(t=cr(),e){let n=Yr(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){let r=Gu("database");r&&TA(n,...r)}return n}function TA(t,e,n,r={}){t=tt(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Bn("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Bn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Ba(Ba.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Ku(r.mockUserToken,t.app.options.projectId);s=new Ba(o)}Q2(i,e,n,s)}function Z2(t){LU(dn),ln(new ft("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Y2(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),De(Fb,Lb,t),De(Fb,Lb,"esm2017")}v_.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};v_.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Z2();var Xa=class{constructor(e){return e}},CA="database",R_=class{constructor(){return Xr(CA)}};var N_=new G("angularfire2.database-instances");function eB(t,e){let n=ls(CA,t,e);return n&&new Xa(n)}function tB(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Xa(r)}}var nB={provide:R_,deps:[[new Le,N_]]},rB={provide:Xa,useFactory:eB,deps:[[new Le,N_],Wt]};function DA(t,...e){return De("angularfire",Pn.full,"rtdb"),xt([rB,nB,{provide:N_,useFactory:tB(t),multi:!0,deps:[fe,vt,lr,Mn,[new Le,ri],[new Le,ur],...e]}])}var bA=hn(EA,!0);var SA={providers:[GT(KT),TC(()=>CC({projectId:"parcial-rotelagustavo",appId:"1:732777896176:web:c43b2f223e7a4d257e4a35",storageBucket:"parcial-rotelagustavo.appspot.com",apiKey:"AIzaSyDlUjJ-AADdj8611ipikn4UXf5mV0zJ6Co",authDomain:"parcial-rotelagustavo.firebaseapp.com",messagingSenderId:"732777896176"})),fD(()=>pD()),Pb(()=>Ob()),DA(()=>bA())]};var AA=(()=>{let e=class e{constructor(r){this.firestore=r,this.title="parcial"}prueba(){let r=kb(this.firestore,"logins");Mb(r,{fecha:new Date,email:"hola"})}};e.\u0275fac=function(i){return new(i||e)(xo(fi))},e.\u0275cmp=cu({type:e,selectors:[["app-root"]],standalone:!0,features:[Iu],decls:4,vars:0,consts:[[3,"click"],[1,"text-3xl","font-bold","underline"]],template:function(i,s){i&1&&(Po(0,"button",0),wu("click",function(){return s.prueba()}),Pf(1,"prueba"),Mo(),Po(2,"h1",1),Pf(3,` Hello world!
`),Mo())}});let t=e;return t})();dT(AA,SA).catch(t=>console.error(t));
